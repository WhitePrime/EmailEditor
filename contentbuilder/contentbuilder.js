for(var cb_list='',cb_edit=!0,cb_snippetList='#divSnippetList',cb_snippetPageSliding=!1,oScripts=document.getElementsByTagName('script'),i=0,sScriptPath,sSrc;i<oScripts.length;i++)sSrc=oScripts[i].src.toLowerCase(),-1!=sSrc.indexOf('contentbuilder-src.js')&&(sScriptPath=oScripts[i].src.replace(/contentbuilder-src.js/,'')),-1!=sSrc.indexOf('contentbuilder.js')&&(sScriptPath=oScripts[i].src.replace(/contentbuilder.js/,''));var sScriptPathArray=sScriptPath.split('?');sScriptPath=sScriptPathArray[0];var sc=document.createElement('script');sc.src=sScriptPath+'load-image.all.min.js',document.getElementsByTagName('head')[0].appendChild(sc),function(S){var T;S.contentbuilder=function(L,R){var O={zoom:'1',selectable:'h1,h2,h3,h4,h5,h6,p,blockquote,ul,ol,small,.edit,td,i',editMode:'default',onRender:function(){},onDrop:function(){},onImageBrowseClick:function(){},onImageSettingClick:function(){},snippetFile:'assets/default/snippets.html',modulePath:'assets/modules/',snippetPathReplace:['',''],hiquality:!1,snippetTool:'right',snippetOpen:!1,snippetPageSliding:!1,scrollHelper:!1,snippetCategories:[[0,'Default'],[-1,'All'],[1,'Title'],[2,'Title, Subtitle'],[3,'Info, Title'],[4,'Info, Title, Subtitle'],[5,'Heading, Paragraph'],[6,'Paragraph'],[7,'Paragraph, Images + Caption'],[8,'Heading, Paragraph, Images + Caption'],[33,'Buttons'],[34,'Cards'],[9,'Images + Caption'],[10,'Images + Long Caption'],[11,'Images'],[12,'Single Image'],[13,'Call to Action'],[14,'List'],[15,'Quotes'],[16,'Profile'],[17,'Map'],[20,'Video'],[18,'Social'],[21,'Services'],[22,'Contact Info'],[23,'Pricing'],[24,'Team Profile'],[25,'Products/Portfolio'],[26,'How It Works'],[27,'Partners/Clients'],[28,'As Featured On'],[29,'Achievements'],[32,'Skills'],[30,'Coming Soon'],[31,'Page Not Found'],[19,'Separator'],[100,'Custom Code']],addSnippetCategories:[],snippetCustomCode:!1,snippetCustomCodeMessage:'<b>IMPORTANT</b>: This is a code block. Custom javascript code (&lt;script&gt; block) is allowed here but may not always work or compatible with the content builder, so proceed at your own risk. We do not support problems with custom code.',imageselect:'',fileselect:'',onImageSelectClick:function(){},onFileSelectClick:function(){},iconselect:'',imageEmbed:!0,sourceEditor:!0,enableZoom:!1,buttons:['bold','italic','formatting','textsettings','color','font','formatPara','align','list','table','image','createLink','unlink','icon','tags','removeFormat','html'],colors:['#ffffc5','#e9d4a7','#ffd5d5','#ffd4df','#c5efff','#b4fdff','#c6f5c6','#fcd1fe','#ececec','#f7e97a','#d09f5e','#ff8d8d','#ff80aa','#63d3ff','#7eeaed','#94dd95','#ef97f3','#d4d4d4','#fed229','#cc7f18','#ff0e0e','#fa4273','#00b8ff','#0edce2','#35d037','#d24fd7','#888888','#ff9c26','#955705','#c31313','#f51f58','#1b83df','#0bbfc5','#1aa71b','#ae19b4','#333333'],snippetList:'#divSnippetList',toolbar:'top',toolbarDisplay:'auto',axis:'',hideDragPreview:!1,customval:'',largerImageHandler:'',absolutePath:!1,customTags:[],moduleConfig:[]};this.settings={};var N=S(L),L=L;this.undoList=[],this.redoList=[],this.init=function(){this.settings=S.extend({},O,R),(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i))&&(this.settings.enableZoom=!1);var P=detectEdge();P&&(this.settings.enableZoom=!1);var M=-1<navigator.userAgent.toLowerCase().indexOf('firefox');M&&(this.settings.hideDragPreview=!0),this.settings.enableZoom||(localStorage.removeItem('zoom'),this.settings.zoom=1,localStorage.zoom=1),null==localStorage.getItem('zoom')?localStorage.zoom=this.settings.zoom:this.settings.zoom=localStorage.zoom,N.css('zoom',this.settings.zoom),N.css('-moz-transform','scale('+this.settings.zoom+')'),N.addClass('connectSortable'),this.settings.zoom+='',-1!=this.settings.zoom.indexOf('%')&&(this.settings.zoom=this.settings.zoom.replace('%','')/100,localStorage.zoom=this.settings.zoom),'NaN'==this.settings.zoom&&(this.settings.zoom=1,localStorage.zoom=1),cb_list=''==cb_list?'#'+N.attr('id'):cb_list+',#'+N.attr('id'),cb_snippetList=this.settings.snippetList,cb_snippetPageSliding=this.settings.snippetPageSliding,N.css({'min-height':'50px'}),0==S('#divCb').length&&S('body').append('<div id="divCb"></div>');for(var U=0;U<this.settings.addSnippetCategories.length;U++)this.settings.snippetCategories.push(this.settings.addSnippetCategories[U]);if(0==S('#divSnippets').length){S('#divCb').append('<div id="divSnippets" style="display:none"></div>');var W='';if(!1==this.settings.snippetCustomCode)for(var U=0;U<this.settings.snippetCategories.length;U++)100==this.settings.snippetCategories[U][0]&&this.settings.snippetCategories.splice(U,1);for(var U=0;U<this.settings.snippetCategories.length;U++)W+='<option value="'+this.settings.snippetCategories[U][0]+'">'+this.settings.snippetCategories[U][1]+'</option>';W='<select id="selSnips" style="display:none;position:absolute;width:83%;margin:5px;padding:5px;margin:3px 0 13px 5px;font-size:12px;letter-spacing:1px;height:28px;line-height:1;color:#454545;border-radius:0px;border:none;background:#fff;box-shadow: 0 0 5px rgba(0, 0, 0,0.2);cursor:pointer;">'+W+'</select>';var _='<div id="divTool">'+W+'<div id="divToolWait" style="position:absolute;top:0;left:0;width:100%;height:100%;display:table;background:rgba(255,255,255,0.2);z-index:1;"><div style="display:table-cell;vertical-align:middle;text-align:center;background:rgb(217, 217, 217);"><div class="loading"><div class="dot"></div><div class="dot"></div><div class="dot"></div></div></div></div>';_+='<div id="divSnippetList"></div>',_+='',_+='<br><div id="divRange"><input type="range" id="inpZoom" min="80" max="100" value="100"></div>',_+='',_+='<a id="lnkToolOpen" href="#"><i class="cb-icon-left-open-big" style="font-size: 15px;"></i></a></div>',_+='<div id="divSnippetScrollUp" style="display:none;background:rgba(0,0,0,0.3);width:45px;height:45px;line-height:45px;color:#eee;position:fixed;z-index:100000;border-radius:8px;text-align:center;font-size:12px;cursor:pointer;font-family:sans-serif;">&#9650;</div><div id="divSnippetScrollDown" style="display:none;background:rgba(0,0,0,0.3);width:45px;height:45px;line-height:45px;color:#eee;position:fixed;z-index:100000;border-radius:8px;text-align:center;font-size:12px;cursor:pointer;font-family:sans-serif;">&#9660;</div>',S('#divCb').append(_),S('#inpZoom').val(100*this.settings.zoom);var Z=S('#inpZoom').val()/100;this.zoom(Z),S('#inpZoom').on('change',function(){if(!0==N.data('contentbuilder').settings.enableZoom){var ee=S('#inpZoom').val()/100;N.data('contentbuilder').zoom(ee)}}),S.get(this.settings.snippetFile,function(ee){var te='',ae='',ie=1,oe=!1;try{if(''!=N.data('contentbuilder').settings.snippetPathReplace[0]){var ne=new RegExp(N.data('contentbuilder').settings.snippetPathReplace[0],'g');ee=ee.replace(ne,N.data('contentbuilder').settings.snippetPathReplace[1]);var se=N.data('contentbuilder').settings.snippetPathReplace[0].replace(/\//g,'%2F'),le=N.data('contentbuilder').settings.snippetPathReplace[1].replace(/\//g,'%2F'),de=new RegExp(se,'g');ee=ee.replace(de,le)}}catch(Ie){}for(var ce=S('<div/>').html(ee).children('div'),ie=1;ce.length>=ie;ie++){var pe=S(ce[ie-1]),me=pe.html(),ge=S('<div/>').text(me).html();te+='<div id="snip'+ie+'">'+ge+'</div>',null!=pe.data('cat')&&(oe=!0);var ue=pe.data('thumb');ae+=oe?'<div style="display:none" title="Snippet '+ie+'" data-snip="'+ie+'" data-cat="'+pe.data('cat')+'"><img src="'+ue+'" /></div>':'<div title="Snippet '+ie+'" data-snip="'+ie+'" data-cat="'+pe.data('cat')+'"><img src="'+ue+'" /></div>'}if(S('#divSnippets').html(te),S(cb_snippetList).html(ae),oe){for(var be=[],he=S('#selSnips'),fe=S('#selSnips option'),ve=!1,Ce=S(cb_snippetList+' > div'),ye=0;Ce.length>ye;ye++)for(var pe=S(Ce[ye]),xe=pe.attr('data-cat').split(','),ke=0,we;ke<xe.length;ke++)we=pe.attr('data-cat').split(',')[ke],0==we&&(pe.fadeIn(400),ve=!0),-1==S.inArray(we,be)&&(be.push(we),0==he.find('[value=\''+we+'\']').length&&pe.css('display','none'));for(var Se=0,we;fe.length>Se;Se++)we=S(fe[Se]).attr('value'),-1==S.inArray(we,be)&&0!=we&&-1!=we&&he.find('[value=\''+we+'\']').remove();ve||(S(cb_snippetList+' > div').css('display','block'),S('#selSnips option[value=\'0\']').remove()),S('#selSnips').css('display','block'),S('#selSnips').on('change',function(){var Te=S('option:selected',this),Le=this.value,Ae=S(cb_snippetList+' > div');'-1'==Le?Ae.fadeIn(200):Ae.fadeOut(200,function(){for(var Re=S(this),Oe=Re.attr('data-cat').split(','),Ne=0;Ne<Oe.length;Ne++)Le==Oe[Ne]&&Re.fadeIn(400)})})}'#divSnippetList'==cb_snippetList&&(N.data('contentbuilder').settings.enableZoom?(S('#divSnippetList').css('margin-bottom','-50px'),S('#divSnippetList').css('border-bottom','rgba(0,0,0,0) 50px solid')):S('#divRange').css('display','none'),oe&&S('#divSnippetList').css('border-top','rgba(0,0,0,0) 45px solid')),N.data('contentbuilder').applyDraggable(),S('#divToolWait').remove()})}else this.applyDraggable();var V=1e8;S('#divSnippetScrollUp').css('display','none'),S('#divSnippetScrollUp').bind('click touchup',function(){return S('#divSnippetList').animate({scrollTop:S('#divSnippetList').scrollTop()-(S('#divSnippetList').height()-150)+'px'},300,function(){0==S('#divSnippetList').scrollTop()?S('#divSnippetScrollUp').fadeOut(300):S('#divSnippetScrollUp').fadeIn(300),S('#divSnippetList').scrollTop()==V?S('#divSnippetScrollDown').fadeOut(300):S('#divSnippetScrollDown').fadeIn(300)}),e.preventDefault(),e.stopImmediatePropagation(),!1}),S('#divSnippetScrollDown').bind('click touchup',function(){return S('#divSnippetList').animate({scrollTop:S('#divSnippetList').scrollTop()+(S('#divSnippetList').height()-150)+'px'},300,function(){0==S('#divSnippetList').scrollTop()?S('#divSnippetScrollUp').fadeOut(300):S('#divSnippetScrollUp').fadeIn(300),1e8==V&&(V=S('#divSnippetList').prop('scrollHeight')-S('#divSnippetList').height()-10),S('#divSnippetList').scrollTop()==V?S('#divSnippetScrollDown').fadeOut(300):S('#divSnippetScrollDown').fadeIn(300)}),e.preventDefault(),e.stopImmediatePropagation(),!1}),N.children('*').wrap('<div class=\'ui-draggable\'></div>'),N.children('*').append('<div class="row-tool"><div class="row-handle"><i class="cb-icon-move"></i></div><div class="row-html"><i class="cb-icon-code"></i></div><div class="row-copy"><i class="cb-icon-plus"></i></div><div class="row-remove"><i class="cb-icon-cancel"></i></div></div>'),0==S('#temp-contentbuilder').length&&S('#divCb').append('<div id="temp-contentbuilder" style="display: none"></div>');var Q=S(window),X=Q.width(),K=260;600>X&&(K=150),320>=X&&(N.css('margin-left','35px'),N.css('margin-right','35px'),N.css('width','80%'));var Y=this.settings.scrollHelper;(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i))&&(Y=!0),'right'==this.settings.snippetTool?(S('#divSnippetScrollUp').css('right','10px'),S('#divSnippetScrollDown').css('right','10px'),'0px'!=S('#divTool').css('right')&&(S('#divTool').css('width',K+'px'),S('#divTool').css('right','-'+K+'px')),S('#lnkToolOpen').unbind('click'),S('#lnkToolOpen').click(function(ee){if(S('.row-tool').stop(!0,!0).fadeOut(0),S('.ui-draggable').removeClass('ui-dragbox-outlined'),S('#rte-toolbar').css('display','none'),S('.rte-pop').css('display','none'),cb_snippetPageSliding||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)){if(0==parseInt(S('#divTool').css('right')))S('#divTool').animate({right:'-='+K+'px'},200),S('body').animate({marginRight:'-='+K+'px'},250),S('#rte-toolbar').animate({paddingRight:'-='+K+'px'},250),S('#lnkToolOpen i').attr('class','cb-icon-left-open-big'),S('#divSnippetScrollUp').fadeOut(300),S('#divSnippetScrollDown').fadeOut(300);else if(S('#divTool').animate({right:'+='+K+'px'},200),S('body').animate({marginRight:'+='+K+'px'},250),S('#rte-toolbar').animate({paddingRight:'+='+K+'px'},250),S('#lnkToolOpen i').attr('class','cb-icon-right-open-big'),Y){var te=S('#divSnippetList').height()/2-60;S('#divSnippetScrollUp').css('top',te),S('#divSnippetScrollDown').css('top',te+60),0==S('#divSnippetList').scrollTop()?S('#divSnippetScrollUp').fadeOut(300):S('#divSnippetScrollUp').fadeIn(300),S('#divSnippetScrollDown').fadeIn(300)}S('#rte-toolbar').css('display','none')}else if(0==parseInt(S('#divTool').css('right')))S('#divTool').animate({right:'-='+K+'px'},200),S('#lnkToolOpen i').attr('class','cb-icon-left-open-big'),S('#divSnippetScrollUp').css('display','none'),S('#divSnippetScrollDown').css('display','none');else if(S('#divTool').animate({right:'+='+K+'px'},200),S('#lnkToolOpen i').attr('class','cb-icon-right-open-big'),Y){var te=S('#divSnippetList').height()/2-60;S('#divSnippetScrollUp').css('top',te),S('#divSnippetScrollDown').css('top',te+60),0==S('#divSnippetList').scrollTop()?S('#divSnippetScrollUp').fadeOut(300):S('#divSnippetScrollUp').fadeIn(300),S('#divSnippetScrollDown').fadeIn(300)}ee.preventDefault()}),S('.row-tool').css('right','auto'),600>X?S('.row-tool').css('left','-30px'):S('.row-tool').css('left','-37px'),this.settings.snippetOpen&&1!=S('#divTool').attr('data-snip-open')&&(S('#divTool').attr('data-snip-open',1),S('#divTool').animate({right:'+='+K+'px'},900),S('#lnkToolOpen i').attr('class','cb-icon-right-open-big'))):(S('#lnkToolOpen i').attr('class','cb-icon-right-open-big'),S('#divSnippetScrollUp').css('left','10px'),S('#divSnippetScrollDown').css('left','10px'),S('#divTool').css('width',K+'px'),S('#divTool').css('left','-'+K+'px'),S('#lnkToolOpen').addClass('leftside'),S('#lnkToolOpen').unbind('click'),S('#lnkToolOpen').click(function(ee){if(S('.row-tool').stop(!0,!0).fadeOut(0),S('.ui-draggable').removeClass('ui-dragbox-outlined'),S('#rte-toolbar').css('display','none'),S('.rte-pop').css('display','none'),cb_snippetPageSliding||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)){if(0==parseInt(S('#divTool').css('left')))S('#divTool').animate({left:'-='+(K+0)+'px'},200),S('body').animate({marginLeft:'-='+K+'px'},250),S('#rte-toolbar').animate({paddingLeft:'-='+K+'px'},250),S('#lnkToolOpen i').attr('class','cb-icon-right-open-big'),S('#divSnippetScrollUp').fadeOut(300),S('#divSnippetScrollDown').fadeOut(300);else if(S('#divTool').animate({left:'+='+(K+0)+'px'},200),S('body').animate({marginLeft:'+='+K+'px'},250),S('#rte-toolbar').animate({paddingLeft:'+='+K+'px'},250),S('#lnkToolOpen i').attr('class','cb-icon-left-open-big'),Y){var te=S('#divSnippetList').height()/2-60;S('#divSnippetScrollUp').css('top',te),S('#divSnippetScrollDown').css('top',te+60),0==S('#divSnippetList').scrollTop()?S('#divSnippetScrollUp').fadeOut(300):S('#divSnippetScrollUp').fadeIn(300),S('#divSnippetScrollDown').fadeIn(300)}S('#rte-toolbar').css('display','none'),S('.rte-pop').css('display','none')}else if(0==parseInt(S('#divTool').css('left')))S('#divTool').animate({left:'-='+(K+0)+'px'},200),S('#lnkToolOpen i').attr('class','cb-icon-right-open-big'),S('#divSnippetScrollUp').css('display','none'),S('#divSnippetScrollDown').css('display','none');else if(S('#divTool').animate({left:'+='+(K+0)+'px'},200),S('#lnkToolOpen i').attr('class','cb-icon-left-open-big'),Y){var te=S('#divSnippetList').height()/2-60;S('#divSnippetScrollUp').css('top',te),S('#divSnippetScrollDown').css('top',te+60),0==S('#divSnippetList').scrollTop()?S('#divSnippetScrollUp').fadeOut(300):S('#divSnippetScrollUp').fadeIn(300),S('#divSnippetScrollDown').fadeIn(300)}ee.preventDefault()}),S('.row-tool').css('left','auto'),600>X?S('.row-tool').css('right','-30px'):S('.row-tool').css('right','-37px'),this.settings.snippetOpen&&1!=S('#divTool').attr('data-snip-open')&&(S('#divTool').attr('data-snip-open',1),S('#divTool').animate({left:'+='+K+'px'},900),S('#lnkToolOpen i').attr('class','cb-icon-left-open-big'))),this.applyBehavior(),this.blockChanged(),this.settings.onRender(),N.sortable({helper:function(ee,te){var ae=S(te).clone();return ae.css('position','absolute'),ae.addClass('cloned-handler'),1!=N.data('contentbuilder').settings.zoom||''!=N.data('contentbuilder').settings.axis||ae.parent().is('body')||ae.appendTo(S('body')),ae.get(0)},sort:function(ee,te){N.data('contentbuilder').settings.hideDragPreview&&te.helper.css({display:'none'})},items:'.ui-draggable',connectWith:'.connectSortable',distance:5,tolerance:'pointer',handle:'.row-handle',delay:200,cursor:'move',placeholder:'block-placeholder',start:function(ee,te){S(te.placeholder).hide(),S(te.placeholder).slideUp(80),cb_edit=!1},change:function(ee,te){S(te.placeholder).hide().slideDown(80)},beforeStop:function(ee,te){S(te.placeholder).hide()},deactivate:function(ee,te){if(S('.cloned-handler').remove(),!!N.data('contentbuilder')){cb_edit=!0;var ae=!1;if(0==te.item.find('.row-tool').length&&(ae=!0),te.item.parent().attr('id')==N.attr('id'))te.item.find('[data-html]').each(function(){var ie=decodeURIComponent(S(this).attr('data-html'));S(this).html(ie)}),te.item.replaceWith(te.item.html()),N.children('*').each(function(){S(this).hasClass('ui-draggable')||S(this).wrap('<div class=\'ui-draggable\'></div>')}),N.children('.ui-draggable').each(function(){0==S(this).find('.row-tool').length&&S(this).append('<div class="row-tool"><div class="row-handle"><i class="cb-icon-move"></i></div><div class="row-html"><i class="cb-icon-code"></i></div><div class="row-copy"><i class="cb-icon-plus"></i></div><div class="row-remove"><i class="cb-icon-cancel"></i></div></div>')}),N.children('.ui-draggable').each(function(){1==S(this).children('*').length&&S(this).remove(),2==S(this).children('*').length&&'img'==S(this).children(0).prop('tagName').toLowerCase()&&-1!=S(this).children(0).attr('src').indexOf('thumbnails/')&&S(this).remove()}),N.data('contentbuilder').settings.onDrop(ee,te);else return;N.data('contentbuilder').applyBehavior(),N.data('contentbuilder').blockChanged(),N.data('contentbuilder').settings.onRender(),saveForUndo()}}}),-1!=cb_list.indexOf(',')&&S(cb_list).sortable('option','axis',!1),''!=this.settings.axis&&S(cb_list).sortable('option','axis',this.settings.axis),S.ui.isOverAxis2=function(ee,te,ae){return ee>=te&&ee<te+ae},S.ui.isOver=function(ee,te,ae,ie,oe,ne){return S.ui.isOverAxis2(ee,ae,oe)&&S.ui.isOverAxis(te,ie,ne)},N.droppable({drop:function(ee,te){if(S(te.draggable).data('snip')){var ae=S(te.draggable).data('snip'),ie=S('#snip'+ae).text();return ie=ie.replace(/{id}/g,makeid()),S(te.draggable).data('snip',null),te.draggable.html(ie)}},tolerance:'pointer',greedy:!0,hoverClass:'drop-zone',activeClass:'drop-zone',deactivate:function(){S(cb_list).each(function(){var ae=S(this);ae.children('.ui-draggable').each(function(){0==S(this).find('.row-tool').length&&S(this).append('<div class="row-tool"><div class="row-handle"><i class="cb-icon-move"></i></div><div class="row-html"><i class="cb-icon-code"></i></div><div class="row-copy"><i class="cb-icon-plus"></i></div><div class="row-remove"><i class="cb-icon-cancel"></i></div></div>')}),ae.data('contentbuilder').applyBehavior()})}}),S(document).bind('mousedown',function(ee){var te;if(0<S(ee.target).parents('.ui-draggable').length&&S(ee.target).parents('.ui-draggable').parent().data('contentbuilder')&&(te=S(ee.target).parents('.ui-draggable').parent()),'ovl'==S(ee.target).attr('class')&&S(ee.target).css('z-index','-1'),0<S(ee.target).parents('.ui-draggable').length&&0<S(ee.target).parents(cb_list).length){var ae=-1<navigator.userAgent.toLowerCase().indexOf('firefox');return 0<S(ee.target).parents('[data-html]').length&&(S(ee.target).parents('.ui-draggable').addClass('code'),S(ee.target).parents('.ui-draggable').find('.row-tool .row-html').addClass('row-module'),S(ee.target).parents('.ui-draggable').find('.row-tool .cb-icon-code').removeClass('cb-icon-code').addClass('cb-icon-cog')),0<S(ee.target).parents('[data-mode=\'readonly\']').length&&(S(ee.target).parents('.ui-draggable').addClass('code'),S(ee.target).parents('.ui-draggable').find('.row-tool .row-html').css('display','none')),0<S(ee.target).parents('[data-mode=\'readonly-protected\']').length&&(S(ee.target).parents('.ui-draggable').addClass('code'),S(ee.target).parents('.ui-draggable').find('.row-tool .row-html').css('display','none'),S(ee.target).parents('.ui-draggable').find('.row-tool .row-remove').css('display','none'),S(ee.target).parents('.ui-draggable').find('.row-tool .row-copy').css('display','none')),S('.ui-draggable').removeClass('ui-dragbox-outlined'),S(ee.target).parents('.ui-draggable').addClass('ui-dragbox-outlined'),ae&&S(ee.target).parents('.ui-draggable').addClass('firefox'),S('.row-tool').stop(!0,!0).fadeOut(0),te&&(0<S(ee.target).parents('.ui-draggable').find('[data-html-edit=\'off\']').length||!te.data('contentbuilder').settings.sourceEditor)&&S(ee.target).parents('.ui-draggable').find('.row-tool .row-html').css({display:'none'}),void S(ee.target).parents('.ui-draggable').find('.row-tool').stop(!0,!0).css({display:'none'}).fadeIn(300)}if(!('rte-toolbar'==S(ee.target).parent().attr('id')||'rte-toolbar'==S(ee.target).parent().parent().attr('id')||S(ee.target).parent().hasClass('rte-pop')||S(ee.target).parent().parent().hasClass('rte-pop')||S(ee.target).parent().hasClass('md-modal'))&&!(S(ee.target).is('[contenteditable]')||'absolute'==S(ee.target).css('position')||'fixed'==S(ee.target).css('position')||S(ee.target).hasClass('md-modal'))){var ie=!1;S(ee.target).parents().each(function(){if(S(this).is('[contenteditable]')||'absolute'==S(this).css('position')||'fixed'==S(this).css('position')||S(this).hasClass('md-modal'))return void(ie=!0)}),ie||(S('.row-tool').stop(!0,!0).fadeOut(0),S('.ui-draggable').removeClass('ui-dragbox-outlined'),S('#rte-toolbar').css('display','none'),S('.rte-pop').css('display','none'))}})},this.applyDraggable=function(){var M=!1;'1.11.0'==S.ui.version&&(M=!0),M?S(cb_snippetList+' > div').draggable({cursor:'move',helper:function(){return S('<div class=\'dynamic\'></div>')[0]},delay:200,connectToSortable:cb_list,stop:function(){S(cb_list).each(function(){var _=S(this);_.children('div').each(function(){1==S(this).children('img').length&&S(this).remove()})})}}):S(cb_snippetList+' > div').draggable({cursor:'move',helper:'clone',drag:function(U,W){S(W.helper).css('overflow','hidden'),S(W.helper).css('padding-top','60px'),S(W.helper).css('box-sizing','border-box'),S(W.helper).css('width','150px'),S(W.helper).css('height','60px'),S(W.helper).css('border','rgba(225,225,225,0.9) 5px solid'),S(W.helper).css('background','rgba(225,225,225,0)'),1!=N.data('contentbuilder').settings.zoom&&(S(W.helper).css('position','absolute'),!W.helper.parent().is('body')&&W.helper.appendTo(S('body')))},connectToSortable:cb_list,stop:function(){S(cb_list).each(function(){var _=S(this);_.children('div').each(function(){1==S(this).children('img').length&&S(this).remove()})})}})},this.html=function(){this.settings.absolutePath&&N.find('img').each(function(){var U=S(this).get(0).src;-1==U.indexOf('/[')&&S(this).attr('src',U)});this.settings.selectable;S('#temp-contentbuilder').html(N.html()),S('#temp-contentbuilder').find('.row-tool').remove(),S('#temp-contentbuilder').find('.ovl').remove(),S('#temp-contentbuilder').find('[contenteditable]').removeAttr('contenteditable'),S('*[class=""]').removeAttr('class'),S('#temp-contentbuilder').find('.ui-draggable').replaceWith(function(){return S(this).html()}),S('#temp-contentbuilder').find('[data-html]').each(function(){void 0!=S(this).attr('data-html')&&S(this).html(decodeURIComponent(S(this).attr('data-html')))});var M=S('#temp-contentbuilder').html().trim();return M=M.replace(/<font/g,'<span').replace(/<\/font/g,'</span'),M},this.zoom=function(P){this.settings.zoom=P,S(cb_list).css('zoom',P),S(cb_list).css('-moz-transform','scale('+P+')'),localStorage.zoom=P,S('.row-tool').stop(!0,!0).fadeOut(0),S('.ui-draggable').removeClass('ui-dragbox-outlined'),S('#rte-toolbar').css('display','none'),S('.rte-pop').css('display','none')},this.clearControls=function(){S('.row-tool').stop(!0,!0).fadeOut(0),S('.ui-draggable').removeClass('ui-dragbox-outlined');var P=this.settings.selectable;N.find(P).blur()},this.viewHtml=function(){S('#md-html').css('width','60%'),S('#md-html').simplemodal({isModal:!0}),S('#md-html').data('simplemodal').show(),S('#infoSource').css('display','none'),S('#txtHtml').val(this.html()),S('#btnHtmlOk').unbind('click'),S('#btnHtmlOk').bind('click',function(){N.html(S('#txtHtml').val()),S('#md-html').data('simplemodal').hide(),N.children('*').wrap('<div class=\'ui-draggable\'></div>'),N.children('*').append('<div class="row-tool"><div class="row-handle"><i class="cb-icon-move"></i></div><div class="row-html"><i class="cb-icon-code"></i></div><div class="row-copy"><i class="cb-icon-plus"></i></div><div class="row-remove"><i class="cb-icon-cancel"></i></div></div>'),N.data('contentbuilder').applyBehavior(),N.data('contentbuilder').blockChanged(),N.data('contentbuilder').settings.onRender(),saveForUndo()}),S('#btnHtmlCancel').unbind('click'),S('#btnHtmlCancel').bind('click',function(){S('#md-html').data('simplemodal').hide()})},this.loadHTML=function(P){N.html(P),N.children('*').wrap('<div class=\'ui-draggable\'></div>'),N.children('*').append('<div class="row-tool"><div class="row-handle"><i class="cb-icon-move"></i></div><div class="row-html"><i class="cb-icon-code"></i></div><div class="row-copy"><i class="cb-icon-plus"></i></div><div class="row-remove"><i class="cb-icon-cancel"></i></div></div>'),N.data('contentbuilder').applyBehavior(),N.data('contentbuilder').blockChanged(),N.data('contentbuilder').settings.onRender()},this.applyBehavior=function(){N.find('a').click(function(){return!1}),this.settings.absolutePath&&N.find('img').each(function(){var le=S(this).get(0).src;-1==le.indexOf('/[')&&S(this).attr('src',le)});var P=this.settings.selectable,M=this.settings.hiquality,U=this.settings.imageEmbed,W=this.settings.buttons,_=this.settings.colors,Z=this.settings.editMode,V=this.settings.toolbar,Q=this.settings.toolbarDisplay,X=this.settings.onImageSelectClick,K=this.settings.onFileSelectClick,Y=this.settings.onImageBrowseClick,ee=this.settings.onImageSettingClick,te=this.settings.customTags,ae=this.settings.imageselect,ie=this.settings.fileselect,oe=this.settings.iconselect,ne=this.settings.customval,se=this.settings.largerImageHandler;N.contenteditor({fileselect:ie,imageselect:ae,iconselect:oe,editable:P,buttons:W,colors:_,editMode:Z,toolbar:V,toolbarDisplay:Q,onFileSelectClick:K,onImageSelectClick:X,customTags:te}),N.data('contenteditor').render(),N.find('img').each(function(){0<S(this).parents('[data-html]').length||0<S(this).parents('[data-mode=\'readonly\']').length||0<S(this).parents('[data-mode=\'readonly-protected\']').length||(S(this).imageembed({hiquality:M,imageselect:ae,fileselect:ie,imageEmbed:U,onImageBrowseClick:Y,onImageSettingClick:ee,onImageSelectClick:X,onFileSelectClick:K,largerImageHandler:se,customval:ne}),0!=S(this).parents('figure').length&&'absolute'==S(this).parents('figure').find('figcaption').css('position')&&S(this).parents('figure').imageembed({hiquality:M,imageselect:ae,fileselect:ie,imageEmbed:U,onImageBrowseClick:Y,onImageSettingClick:ee,onImageSelectClick:X,onFileSelectClick:K,largerImageHandler:se,customval:ne}))}),N.find('.embed-responsive').each(function(){0<S(this).parents('[data-html]').length||0<S(this).parents('[data-mode=\'readonly\']').length||0<S(this).parents('[data-mode=\'readonly-protected\']').length||0==S(this).find('.ovl').length&&S(this).append('<div class="ovl" style="position:absolute;background:#fff;opacity:0.2;cursor:pointer;top:0;left:0px;width:100%;height:100%;z-index:-1"></div>')}),N.find('.embed-responsive').hover(function(){0<S(this).parents('[data-html]').length||0<S(this).parents('[data-mode=\'readonly\']').length||0<S(this).parents('[data-mode=\'readonly-protected\']').length||'none'==S(this).parents('.ui-draggable').css('outline-style')&&S(this).find('.ovl').css('z-index','1')},function(){S(this).find('.ovl').css('z-index','-1')}),N.find(P).unbind('focus'),N.find(P).focus(function(){var le=N.data('contentbuilder').settings.zoom,de=N.data('contentbuilder').settings.selectable,ce=-1<navigator.userAgent.toLowerCase().indexOf('firefox');S('.ui-draggable').removeClass('code'),0<S(this).parents('[data-html]').length&&S(this).parents('.ui-draggable').addClass('code'),0<S(this).parents('[data-mode=\'readonly\']').length&&S(this).parents('.ui-draggable').addClass('code'),0<S(this).parents('[data-mode=\'readonly-protected\']').length&&S(this).parents('.ui-draggable').addClass('code'),S('.ui-draggable').removeClass('ui-dragbox-outlined'),S(this).parents('.ui-draggable').addClass('ui-dragbox-outlined'),ce&&S(this).parents('.ui-draggable').addClass('firefox'),S('.row-tool').stop(!0,!0).fadeOut(0),(0<S(this).parents('.ui-draggable').find('[data-html-edit=\'off\']').length||!N.data('contentbuilder').settings.sourceEditor)&&S(this).parents('.ui-draggable').find('.row-tool .row-html').css({display:'none'}),S(this).parents('.ui-draggable').find('.row-tool').stop(!0,!0).css({display:'none'}).fadeIn(300)}),N.children('div').find('.row-remove').unbind(),N.children('div').find('.row-remove').click(function(){S('#md-delrowconfirm').css('max-width','550px'),S('#md-delrowconfirm').simplemodal(),S('#md-delrowconfirm').data('simplemodal').show(),T=S(this).parents('.ui-draggable'),S('#btnDelRowOk').unbind('click'),S('#btnDelRowOk').bind('click',function(){S('#md-delrowconfirm').data('simplemodal').hide(),T.fadeOut(400,function(){S('#divToolImg').stop(!0,!0).fadeOut(0),S('#divToolImgSettings').stop(!0,!0).fadeOut(0),S('#divRteLink').stop(!0,!0).fadeOut(0),S('#divFrameLink').stop(!0,!0).fadeOut(0),T.remove(),N.data('contentbuilder').blockChanged(),N.data('contentbuilder').settings.onRender(),saveForUndo()})}),S('#btnDelRowCancel').unbind('click'),S('#btnDelRowCancel').bind('click',function(){S('#md-delrowconfirm').data('simplemodal').hide()})}),N.children('div').find('.row-copy').unbind(),N.children('div').find('.row-copy').click(function(){T=S(this).parents('.ui-draggable'),S('#temp-contentbuilder').html(T.html()),S('#temp-contentbuilder').find('[contenteditable]').removeAttr('contenteditable'),S('#temp-contentbuilder *[class=""]').removeAttr('class'),S('#temp-contentbuilder *[style=""]').removeAttr('style'),S('#temp-contentbuilder .ovl').remove(),S('#temp-contentbuilder .row-tool').remove();var le=S('#temp-contentbuilder').html().trim();T.after(le),N.children('*').each(function(){S(this).hasClass('ui-draggable')||S(this).wrap('<div class=\'ui-draggable\'></div>')}),N.children('.ui-draggable').each(function(){0==S(this).find('.row-tool').length&&S(this).append('<div class="row-tool"><div class="row-handle"><i class="cb-icon-move"></i></div><div class="row-html"><i class="cb-icon-code"></i></div><div class="row-copy"><i class="cb-icon-plus"></i></div><div class="row-remove"><i class="cb-icon-cancel"></i></div></div>')}),N.children('.ui-draggable').each(function(){1==S(this).children('*').length&&S(this).remove()}),N.data('contentbuilder').applyBehavior(),N.data('contentbuilder').blockChanged(),N.data('contentbuilder').settings.onRender(),saveForUndo()}),N.children('div').find('.row-html').unbind(),N.children('div').find('.row-html').click(function(){if(T=S(this).parents('.ui-draggable'),0<T.find('[data-html]').length){var le=T.find('[data-html]');S('body').find('[data-html]').removeAttr('data-module-active'),le.attr('data-module-active','1');var de=le.attr('data-module');'code'==le.attr('data-mode')&&(de='code'),'code'==de?(S('#infoSource').css('display','block'),S('#infoSource').html(N.data('contentbuilder').settings.snippetCustomCodeMessage),S('#md-editcontentmodule').find('.md-modal-handle').css('display','none')):(S('#infoSource').css('display','none'),S('#md-editcontentmodule').find('.md-modal-handle').css('display','block')),S('#ifrContentModulePanel').attr('src',N.data('contentbuilder').settings.modulePath+de+'.html');var ce=le.attr('data-module-desc');ce?S('#md-editcontentmodule').find('.md-title').html(ce):S('#md-editcontentmodule').find('.md-title').html('Module Settings');var pe=le.attr('data-dialog-width');pe&&''!=pe||(pe='65%'),S('#md-editcontentmodule').css('width',pe),S('#md-editcontentmodule').simplemodal({isModal:!0}),S('#md-editcontentmodule').data('simplemodal').show(),S('#btnContentModuleOk').unbind('click'),S('#btnContentModuleOk').bind('click',function(){le.attr('data-html',encodeURIComponent(S('#hidContentModuleCode').val())),le.attr('data-settings',encodeURIComponent(S('#hidContentModuleSettings').val())),le.html(S('#hidContentModuleCode').val()),S('#md-editcontentmodule').data('simplemodal').hide(),saveForUndo()}),S('#btnContentModuleCancel').unbind('click'),S('#btnContentModuleCancel').bind('click',function(){S('#md-editcontentmodule').data('simplemodal').hide()})}else{$activeCol=S(this).parents('.ui-draggable').children('*').not('.row-tool'),S('#md-html').css('width','60%'),S('#md-html').simplemodal({isModal:!0}),S('#md-html').data('simplemodal').show(),S('#infoSource').css('display','none'),S('#temp-contentbuilder').html($activeCol.html()),S('#temp-contentbuilder').find('[contenteditable]').removeAttr('contenteditable'),S('#temp-contentbuilder *[class=""]').removeAttr('class'),S('#temp-contentbuilder *[style=""]').removeAttr('style'),S('#temp-contentbuilder .ovl').remove();var me=S('#temp-contentbuilder').html().trim();me=me.replace(/<font/g,'<span').replace(/<\/font/g,'</span'),S('#txtHtml').val(me),S('#btnHtmlOk').unbind('click'),S('#btnHtmlOk').bind('click',function(){$activeCol.html(S('#txtHtml').val()),S('#md-html').data('simplemodal').hide(),N.data('contentbuilder').applyBehavior(),N.data('contentbuilder').blockChanged(),N.data('contentbuilder').settings.onRender(),saveForUndo()}),S('#btnHtmlCancel').unbind('click'),S('#btnHtmlCancel').bind('click',function(){S('#md-html').data('simplemodal').hide()})}})},this.blockChanged=function(){0==N.children().length?N.addClass('empty'):N.removeClass('empty')},this.destroy=function(){if(N.data('contentbuilder')){var P=N.data('contentbuilder').html();N.html(P),N.sortable('destroy');for(var M=cb_list.split(','),U=[],W=0;W<M.length;W++)M[W]!='#'+N.attr('id')&&U.push(M[W]);cb_list=U.join(',');for(var W=0;W<instances.length;W++)S(instances[W]).attr('id')==N.attr('id')&&instances.splice(W,1);N.removeClass('connectSortable'),N.css({'min-height':''}),''==cb_list&&(S('#divCb').remove(),S(document).unbind('mousedown')),N.removeData('contentbuilder'),N.removeData('contenteditor'),N.unbind(),refreshAllObjects()}},this.init()},S.fn.contentbuilder=function(L){return this.each(function(){if(void 0==S(this).data('contentbuilder')){var R=new S.contentbuilder(this,L);S(this).data('contentbuilder',R)}saveForUndo()})}}(jQuery);function refreshAllObjects(){try{for(var S=cb_list.split(','),L=0;L<S.length;L++)jQuery(S[L]).data('contentbuilder').applyBehavior()}catch(R){}}var ce_toolbarDisplay='auto',ce_outline=!1,instances=[],savedSelPublic;(function(S){var L,R,O,N;S.fn.count=function(){},S.contenteditor=function(P,M){var U={editable:'h1,h2,h3,h4,h5,h6,p,ul,ol,small,.edit,td',editMode:'default',hasChanged:!1,onRender:function(){},outline:!1,fileselect:'',imageselect:'',iconselect:'',onFileSelectClick:function(){},onImageSelectClick:function(){},toolbar:'top',toolbarDisplay:'auto',buttons:['bold','italic','formatting','textsettings','color','font','formatPara','align','list','table','image','createLink','unlink','icon','tags','removeFormat','html'],colors:['#ffffc5','#e9d4a7','#ffd5d5','#ffd4df','#c5efff','#b4fdff','#c6f5c6','#fcd1fe','#ececec','#f7e97a','#d09f5e','#ff8d8d','#ff80aa','#63d3ff','#7eeaed','#94dd95','#ef97f3','#d4d4d4','#fed229','#cc7f18','#ff0e0e','#fa4273','#00b8ff','#0edce2','#35d037','#d24fd7','#888888','#ff9c26','#955705','#c31313','#f51f58','#1b83df','#0bbfc5','#1aa71b','#ae19b4','#333333'],customTags:[]};this.settings={};var W=S(P),P=P;this.init=function(){this.settings=S.extend({},U,M);var _=!1;''!=this.settings.fileselect&&(_=!0);var Z=(this.settings.onFileSelectClick+'').replace(/\s/g,'');'function(){}'!=Z&&(_=!0);var V=!1;''!=this.settings.imageselect&&(V=!0);var Z=(this.settings.onImageSelectClick+'').replace(/\s/g,'');'function(){}'!=Z&&(V=!0),0==S('#divCb').length&&S('body').append('<div id="divCb"></div>'),ce_toolbarDisplay=this.settings.toolbarDisplay,ce_outline=this.settings.outline;var Q='';'left'==this.settings.toolbar&&(Q=' class="rte-side"'),'right'==this.settings.toolbar&&(Q=' class="rte-side right"');var X='';''!=this.settings.iconselect&&(X='<button data-rte-cmd="icon" title="Icon"> <i class="cb-icon-smile"></i> </button>');var K='';0<this.settings.customTags.length&&(K='<button data-rte-cmd="tags" title="Tags"> <i class="cb-icon-ticket"></i> </button>');for(var Y='<div id="rte-toolbar"'+Q+'><div class="rte-draggable"><i class="cb-icon-dot"></i></div>',ee=0,te;ee<this.settings.buttons.length;ee++)te=this.settings.buttons[ee],'bold'==te&&(Y+='<button href="#" data-rte-cmd="bold" title="Bold"> <i class="cb-icon-bold"></i> </button>'),'italic'==te&&(Y+='<button data-rte-cmd="italic" title="Italic"> <i class="cb-icon-italic"></i> </button>'),'underline'==te&&(Y+='<button data-rte-cmd="underline" title="Underline"> <i class="cb-icon-underline"></i> </button>'),'strikethrough'==te&&(Y+='<button data-rte-cmd="strikethrough" title="Strikethrough"> <i class="cb-icon-strike"></i> </button>'),'formatting'==te&&(Y+='<button data-rte-cmd="formatting" title="Formatting"> <i class="cb-icon-font"></i> </button>'),'textsettings'==te&&(Y+='<button data-rte-cmd="textsettings" title="Text Settings"> <i class="cb-icon-sliders" style="font-size:16px;line-height: 16px;"></i> </button>'),'color'==te&&(Y+='<button data-rte-cmd="color" title="Color"> <i class="cb-icon-color"></i> </button>'),'fontsize'==te&&(Y+='<button data-rte-cmd="fontsize" title="Font Size"> <i class="cb-icon-fontsize"></i> </button>'),'removeFormat'==te&&(Y+='<button data-rte-cmd="removeFormat" title="Clean"> <i class="cb-icon-eraser"></i> </button>'),'formatPara'==te&&(Y+='<button data-rte-cmd="formatPara" title="Paragraph"> <i class="cb-icon-header"></i> </button>'),'font'==te&&(Y+='<button data-rte-cmd="font" title="Font"> <i class="cb-icon-font-family" style="font-size:11px"></i> </button>'),'align'==te&&(Y+='<button data-rte-cmd="align" title="Alignment"> <i class="cb-icon-align-justify"></i> </button>'),'list'==te&&(Y+='<button data-rte-cmd="list" title="List"> <i class="cb-icon-list-bullet"></i> </button>'),'image'==te&&(Y+='<button href="#" data-rte-cmd="image" title="Image"> <i class="cb-icon-picture"></i> </button>'),'createLink'==te&&(Y+='<button data-rte-cmd="createLink" title="Link"> <i class="cb-icon-link"></i> </button>'),'unlink'==te&&(Y+='<button data-rte-cmd="unlink" title="Remove Link"> <i class="cb-icon-unlink"></i> </button>'),'table'==te&&(Y+='<button href="#" data-rte-cmd="table" title="table"> <i class="cb-icon-table" style="font-size:14px;line-height:14px;"></i> </button>'),'icon'==te&&(Y+=X),'tags'==te&&(Y+=K),'html'==te&&(Y+='<button data-rte-cmd="html" title="HTML"> <i class="cb-icon-code"></i> </button>');for(var ae='<table id="tableInsert" class="table-insert" style="border-collapse:collapse;border-radius:5px;overflow:hidden;">',ie=1;5>=ie;ie++){ae+='<tr>';for(var ee=1;5>=ee;ee++)ae+='<td data-row="'+ie+'" data-col="'+ee+'">'+ie+'x'+ee+'</td>';ae+='</tr>'}ae+='</table>',Y+='</div><div id="divRteLink"><i class="cb-icon-link"></i> Edit Link</div><div id="divFrameLink"><i class="cb-icon-link"></i> Edit Link</div><div id="divRteTable"><button id="btnEditTable" title="Edit"><i class="cb-icon-pencil"></i></button><button id="btnDeleteTable" title="Delete"><i class="cb-icon-cancel"></i></button></div><div class="md-modal md-draggable" id="md-createlink"><div class="md-content"><div class="md-body"><div class="md-modal-handle"><i class="cb-icon-dot"></i><i class="cb-icon-cancel md-modal-close"></i></div><div class="md-label">Link:</div>'+(_?'<input type="text" id="txtLink" class="inptxt" style="float:left;width:60%;" value="http://"></input><i class="cb-icon-link md-btnbrowse" id="btnLinkBrowse" style="width:10%;"></i>':'<input type="text" id="txtLink" class="inptxt" value="http://" style="float:left;width:70%"></input>')+'<br style="clear:both"><div class="md-label">Text:</div><input type="text" id="txtLinkText" class="inptxt" style="float:right;width:70%"></input><br style="clear:both"><div class="md-label">Title:</div><input type="text" id="txtLinkTitle" class="inptxt" style="float:right;width:70%"></input><br style="clear:both"><div style="display:none;" class="md-label">Target:</div><label style="float:left;display:none;" for="chkNewWindow" class="inpchk"><input type="checkbox" id="chkNewWindow"></input> New Window</label><br style="clear:both;display:none;"><div id="divBorderStyle" style="display:none;"><div class="md-label">Border Type</div><label style="float:left;" for="chkCrop" class="inpchk"><select style="margin: -10px 0 0;" id="selectBorderStyle"><option selected="selected" value="1">Normal</option><option value="2">Radius</option><option value="3">Rounded</option></select></label><br style="clear:both" /></div><div id="divButtonAlign" style="display:none;"><div class="md-label">Button Align</div><label style="float:left;" for="chkCrop" class="inpchk"><select style="margin: -10px 0 0;" id="selectButtonAlign"><option selected="selected" value="1">Left</option><option value="2">Right</option><option value="3">Center</option><option value="4">Full Size</option></select></label><br style="clear:both" /></div></div><div class="md-footer"><button id="btnLinkOk"> Ok </button></div></div></div><div class="md-modal md-draggable" id="md-insertimage"><div class="md-content"><div class="md-body"><div class="md-modal-handle"><i class="cb-icon-dot"></i><i class="cb-icon-cancel md-modal-close"></i></div><div class="md-browse"><div class="md-drop-area"><input id="fileInsertImage" type="file" accept="image/*" /><div class="drag-text"><p><i class="cb-icon-camera"></i> Drag and drop an image or click to browse.</p></div></div><div class="md-preview-area"><div><img id="imgInsertImagePreview" src="#" alt="your image" /><i class="ion-ios-close-empty"></i></div></div></div><div class="md-label">Or Specify Image Source:</div>'+(V?'<input type="text" id="txtImgUrl_rte" class="inptxt" style="float:left;width:60%"></input><i class="cb-icon-link md-btnbrowse" id="btnImageBrowse_rte" style="width:10%;"></i>':'<input type="text" id="txtImgUrl_rte" class="inptxt" style="float:left;width:70%"></input>')+'<br style="clear:both"></div><div class="md-footer"><button id="btnImgOk_rte"> Ok </button></div></div></div><div class="md-modal" id="md-createsrc"><div class="md-content"><div class="md-body"><input type="text" id="txtSrc" class="inptxt" value="http://"></input></div><div class="md-footer"><button id="btnSrcOk"> Ok </button></div></div></div><div class="md-modal" id="md-createiframe"><div class="md-content"><div class="md-body"><textarea id="txtIframe" class="inptxt" style="height:350px;"></textarea></div><div class="md-footer"><button id="btnIframeOk"> Ok </button></div></div></div><div class="rte-pop" id="pop-table">'+ae+'</div><div class="rte-pop" id="pop-align"><button class="md-pickalign" data-align="left" title="Left"> <i class="cb-icon-align-left"></i> </button><button class="md-pickalign" data-align="center" title="Center"> <i class="cb-icon-align-center"></i> </button><button class="md-pickalign" data-align="right" title="Right"> <i class="cb-icon-align-right"></i> </button><button class="md-pickalign" data-align="justify" title="Full"> <i class="cb-icon-align-justify"></i> </button></div><div class="md-modal md-draggable" id="md-edittable"><div class="md-content"><div class="md-body"><div class="md-modal-handle"><i class="cb-icon-dot"></i><i class="cb-icon-cancel md-modal-close"></i></div><div class="md-tabs"><span id="tabTableDesign" class="active">Design</span><span id="tabTableLayout">Layout</span></div><div id="divTableDesign" style="overflow-y:auto;overflow-x:hidden;box-sizing:border-box;padding:10px 10px 10px"><div>Background:<br><input type="text" id="inpCellBgColor" value=""/></div><div>Text Color:<br><input type="text" id="inpCellTextColor" value=""/></div><div>Border Thickness:<br><select id="selCellBorderWidth" style="width:120px;"><option value="0">No Border</option><option value="1">1</option><option value="2">2</option><option value="3">3</option></select></div><div>Border Color:<br><input type="text" id="inpCellBorderColor" value=""/></div><div>Apply To:<br><select id="selTableApplyTo" style="width:120px;"><option value="table">Table</option><option value="currentrow">Current Row</option><option value="currentcol">Current Column</option><option value="evenrows">Even Rows</option><option value="oddrows">Odd Rows</option><option value="currentcell">Current Cell</option></select></div></div><div id="divTableLayout" style="overflow-y:auto;overflow-x:hidden;display:none;box-sizing:border-box;padding:10px 10px 10px"><div>Insert Row:<br><button data-rte-cmd="rowabove" title="Insert Row (Above)" style="width:100px;margin-right:5px"> Above </button><button data-rte-cmd="rowbelow" title="Insert Row (Below)" style="width:100px;"> Below </button></div><div>Insert Column:<br><button data-rte-cmd="columnleft" title="Insert Column (Left)" style="width:100px;margin-right:5px"> Left </button><button data-rte-cmd="columnright" title="Insert Column (Right)" style="width:100px;"> Right </button></div><div>Delete:<br><button data-rte-cmd="delrow" title="Delete Row" style="width:100px;margin-right:5px"> Row </button><button data-rte-cmd="delcolumn" title="Delete Column" style="width:100px;"> Column </button></div><div style="margin-bottom:15px;">Merge:<br><button data-rte-cmd="mergecell" title="Merge Cell" style="width:205px"> Merge Cell </button></div></div></div></div></div><div class="md-modal" id="md-deltableconfirm"><div class="md-content"><div class="md-body"><div style="padding:20px 20px 25px;text-align:center;"><p>Are you sure you want to delete this table?</p><button id="btnDelTableCancel"> CANCEL </button><button id="btnDelTableOk" style="margin-left:12px"> OK </button></div></div></div></div><div class="rte-pop" id="pop-list"><button class="md-picklist half" data-list="indent" title="Indent" style="margin-right:0px"> <i class="cb-icon-indent-right"></i> </button><button class="md-picklist half" data-list="outdent" title="Outdent"> <i class="cb-icon-indent-left"></i> </button><button class="md-picklist" data-list="insertUnorderedList" title="Bulleted List"> <i class="cb-icon-list-bullet"></i> </button><button class="md-picklist" data-list="insertOrderedList" title="Numbered List"> <i class="cb-icon-list-numbered"></i> </button></div><div class="rte-pop" id="pop-formatting"><div><button data-rte-cmd="underline" title="Underline"> <i class="cb-icon-underline"></i> </button><button data-rte-cmd="strikethrough" title="Strikethrough"> <i class="cb-icon-strike"></i> </button><button data-rte-cmd="superscript" title="Superscript"> <i class="cb-icon-superscript"></i> </button><button data-rte-cmd="subscript" title="Subscript"> <i class="cb-icon-subscript"></i> </button><button data-rte-cmd="uppercase" title="Uppercase"> <i class="cb-icon-uppercase"></i> </button></div></div><div class="rte-pop arrow-left" id="pop-textsettings"><div>Font Size: <span id="outFontSize"></span><br><input type="range" id="inpFontSize" min="8" max="250" step="1" value="16"></div><div>Letter Spacing: <span id="outLetterSpacing"></span><br><input type="range" id="inpLetterSpacing" min="0" max="100" value="0"></div><div>Line Height: <span id="outLineHeight"></span><br><input type="range" id="inpLineHeight" min="8" max="250" step="1" value="16"></div><div style="margin-top:13px"><span id="btnResetTextSettings"><i class="cb-icon-eraser"></i> Reset</span></div></div><div class="rte-pop" id="pop-fontfamily"><div><iframe id="ifrFonts" src="'+sScriptPath+'blank.html"></iframe><button class="md-pickfontfamily" data-font-family="" data-provider="" style="display:none"></button></div></div><div class="rte-pop" id="pop-headings"><div><iframe id="ifrHeadings" src="'+sScriptPath+'blank.html"></iframe><button class="md-pickheading" data-font-family="" data-provider="" style="display:none"></button></div></div><div class="rte-pop" id="pop-colors"><div style="margin:8px;"><input type="text" id="inpTextColor"/><button id="btnTextColorClear" style="margin-left:9px;margin-bottom: 2px;padding:0 12px;width:42px;height:37px;border-radius:4px;"> <i class="cb-icon-eraser"></i> </button><div style="overflow-x:auto;overflow-y:hidden;width:245px;height:170px"><div class="cust_colors">[COLORS]</div></div><div style="width:100%;margin-top:6px;"><select id="selColorApplyTo" style="width:120px;"><option value="1">Text Color</option><option value="2">Background</option><option value="3">Block Background</option><option value="4">Email Background</option><option value="5">Email Border Color</option></select></div><br style="clear:both" /></div></div><div class="md-modal md-draggable" id="md-fontsize" style="border-radius:12px"><div class="md-content" style="border-radius:12px"><div class="md-body"><div class="md-modal-handle"><i class="cb-icon-dot"></i><i class="cb-icon-cancel md-modal-close"></i></div><iframe id="ifrFontSize" style="width:100%;height:319px;border: none;display: block;" src="'+sScriptPath+'blank.html"></iframe><button class="md-pickfontsize" data-font-size="" style="display:none"></button></div></div></div><div class="md-modal" id="md-html"><div class="md-content"><div class="md-body"><textarea id="txtHtml" class="inptxt" style="height:450px;"></textarea></div><div class="md-footer"><button id="btnHtmlCancel" class="secondary"> Cancel </button><button id="btnHtmlOk" class="primary"> Ok </button></div></div></div><div class="md-modal md-draggable" id="md-editcontentmodule" style="display:none"><div class="md-content"><div class="md-modal-handle"><i class="cb-icon-dot"></i><i class="cb-icon-cancel md-modal-close"></i></div><div class="md-body"><div id="infoSource">IMPORTANT</b>: This is a custom section. Custom javascript code (&lt;script&gt; block) is allowed here but may not always work or compatible with the content builder, so proceed at your own risk. We do not support problems with custom code.</div><iframe id="ifrContentModulePanel" style="width:100%;height:500px;display:block;border:none;" src="'+sScriptPath+'blank.html"></iframe><input id="hidContentModuleCode" type="hidden" /><input id="hidContentModuleSettings" type="hidden" /></div><div class="md-footer"><button id="btnContentModuleCancel" class="secondary"> Cancel </button><button id="btnContentModuleOk" class="primary"> Ok </button></div></div></div><div class="md-modal" id="md-fileselect"><div class="md-content"><div class="md-body">'+(_?'<iframe id="ifrFileBrowse" style="width:100%;height:400px;border: none;display: block;" src="'+sScriptPath+'blank.html"></iframe>':'')+'</div></div></div><input type="hidden" id="active-input" /><div class="md-modal" id="md-delrowconfirm"><div class="md-content"><div class="md-body"><div style="padding:20px 20px 25px;text-align:center;"><p>Are you sure you want to delete this block?</p><button id="btnDelRowCancel"> CANCEL </button><button id="btnDelRowOk" style="margin-left:12px"> OK </button></div></div></div></div><div class="md-modal md-draggable" id="md-icon-select"><div class="md-content"><div class="md-body md-settings"><div class="md-modal-handle"><i class="cb-icon-dot"></i><i class="cb-icon-cancel md-modal-close"></i></div><iframe id="ifrIconSelect" style="width:100%;height:500px;hidden;border:none;float:left;" src="'+sScriptPath+'blank.html"></iframe></div></div></div><div class="md-modal md-draggable" id="md-tags-select"><div class="md-content"><div class="md-body md-settings"><div class="md-modal-handle"><i class="cb-icon-dot"></i><i class="cb-icon-cancel md-modal-close"></i></div><div id="divCustomTags" style="width:100%;"></div></div></div></div><div id="temp-contenteditor"></div>';var oe='';arrC=['#000000','#3300ff','#9900ff','#ff0099','#cc0099','#990099','#990033','#cc0033','#ff0033','|','#444444','#3366ff','#9966ff','#ff6699','#cc6699','#996699','#996633','#cc6633','#ff6633','|','#888888','#3399ff','#9999ff','#ff9999','#cc9999','#999999','#999933','#cc9933','#ff9933','|','#cccccc','#33ccff','#99ccff','#ffcc99','#cccc99','#99cc99','#99cc33','#cccc33','#ffcc33','|','#ffffff','#33ffff','#99ffff','#ffff99','#ccff99','#99ff99','#99ff33','#ccff33','#ffff33'],oe+='<div style="clear:both;height:30px;">';for(var ie=0;ie<arrC.length;ie++)if('|'!=arrC[ie]){var ne='';'#ffffff'==arrC[ie]&&98==ie&&(ne=''),oe+='<button class="md-pick" style="background:'+arrC[ie]+ne+';"></button>'}else oe+='</div><div style="clear:both;height:30px;">';oe+='</div>',Y=Y.replace('[COLORS]',oe),0==S('#rte-toolbar').length&&(S('#divCb').append(Y),this.prepareRteCommand('superscript'),this.prepareRteCommand('subscript'),this.prepareRteCommand('undo'),this.prepareRteCommand('redo'),S('#rte-toolbar').draggable({cursor:'move',handle:'.rte-draggable',start:function(){S('.rte-pop').css('display','none')}}),'left'==this.settings.toolbar||('right'==this.settings.toolbar?S('.rte-pop').addClass('arrow-right'):S('.rte-pop').addClass('arrow-top'))),S('#inpFontSize').rangeslider({onSlide:function(le,de){if(savedSelPublic){restoreSelection(savedSelPublic);var ce,pe;if(window.getSelection?(pe=window.getSelection().getRangeAt(0).commonAncestorContainer,ce=3==pe.nodeType?pe.parentNode:pe):document.selection&&(pe=document.selection.createRange(),ce=document.selection.createRange().parentElement()),'true'!=S(ce).attr('contenteditable')&&0==S(ce).parents('[contenteditable]').length)return;var me=de+'px',ge=getSelected();if(''!=S.trim(ge)&&S(ce).text()!=ge){document.execCommand('fontSize',!1,'7');for(var ue=document.getElementsByTagName('font'),be=0,he=ue.length;be<he;++be)'7'==ue[be].size&&(ue[be].removeAttribute('size'),ue[be].style.fontSize=me);savedSelPublic=saveSelection()}else S(ce).text()==ge?S(ce).html()?S(ce).css('font-size',me):S(ce).parent().css('font-size',me):S(ce).css('font-size',me);S('#outFontSize').html(me),W.data('contenteditor').settings.hasChanged=!0}},polyfill:!1,onSlideEnd:function(){saveForUndo()}}),S('#inpLetterSpacing').rangeslider({onSlide:function(le,de){if(savedSelPublic){restoreSelection(savedSelPublic);var ce,pe;window.getSelection?(pe=window.getSelection().getRangeAt(0).commonAncestorContainer,ce=3==pe.nodeType?pe.parentNode:pe):document.selection&&(pe=document.selection.createRange(),ce=document.selection.createRange().parentElement()),S(ce).css('letter-spacing',de+'px'),S('#outLetterSpacing').html(de+'px')}},polyfill:!1,onSlideEnd:function(){saveForUndo()}}),S('#inpLineHeight').rangeslider({onSlide:function(le,de){if(savedSelPublic){restoreSelection(savedSelPublic);var ce,pe;window.getSelection?(pe=window.getSelection().getRangeAt(0).commonAncestorContainer,ce=3==pe.nodeType?pe.parentNode:pe):document.selection&&(pe=document.selection.createRange(),ce=document.selection.createRange().parentElement()),S(ce).css('line-height',de+'px'),S('#outLineHeight').html(de+'px')}},polyfill:!1,onSlideEnd:function(){saveForUndo()}});var se=!1;W.bind('keyup',function(){W.data('contenteditor').realtime()}),W.bind('mouseup',function(){W.data('contenteditor').realtime()}),S(document).on('paste','#'+W.attr('id'),function(){pasteContent(R)}),W.bind('keydown',function(le){if(46==le.which||8==le.which){var de;try{if(window.getSelection?de=window.getSelection().getRangeAt(0).commonAncestorContainer.parentNode:document.selection&&(de=document.selection.createRange().parentElement()),'p'==de.nodeName.toLowerCase()){var ce='';if(window.getSelection?ce=window.getSelection().toString():document.getSelection?ce=document.getSelection().toString():document.selection&&(ce=document.selection.createRange().text),ce==de.innerText)return S(de).html('<br>'),!1}}catch(ue){}}if(17==le.which)return void(se=!0);if((86==le.which&&!0==se||86==le.which&&le.metaKey)&&pasteContent(R),le.ctrlKey&&(65==le.keyCode||97==le.keyCode)){le.preventDefault();var pe=detectIE(),de;try{window.getSelection?de=window.getSelection().getRangeAt(0).commonAncestorContainer.parentNode:document.selection&&(de=document.selection.createRange().parentElement())}catch(ue){return}if(pe){var me=document.body.createTextRange();me.moveToElementText(de),me.select()}else{var me=document.createRange();me.selectNodeContents(de);var ge=window.getSelection();ge.removeAllRanges(),ge.addRange(me)}}}).keyup(function(le){17==le.which&&(se=!1)}),S(document).on('mousedown',function(le){var de;0<S(le.target).parents('.ui-draggable').length&&S(le.target).parents('.ui-draggable').parent().data('contentbuilder')&&(de=S(le.target).parents('.ui-draggable').parent());var ce=!1;if('none'!=S('#rte-toolbar').css('display')){var pe=S(le.target).prop('tagName').toLowerCase();if(S(le.target).parents().each(function(){if(S(this).is('[contenteditable]')||S(this).hasClass('md-modal')||S(this).hasClass('cp-color-picker')||'divCb'==S(this).attr('id'))return void(ce=!0)}),S(le.target).is('[contenteditable]'))return void(ce=!0);if(!ce){if(R=null,'auto'==ce_toolbarDisplay)try{var pe;window.getSelection?pe=window.getSelection().getRangeAt(0).commonAncestorContainer.parentNode:document.selection&&(pe=document.selection.createRange().parentElement());var me=!1;S(pe).parents().each(function(){S(this).data('contentbuilder')&&(me=!0)}),me||S('#rte-toolbar').css('display','none'),W.data('contenteditor').closePop()}catch(ue){}if(ce_outline)for(var ge=0;ge<instances.length;ge++)S(instances[ge]).css('outline',''),S(instances[ge]).find('*').css('outline','');S('.row-tool').stop(!0,!0).fadeOut(0),S('.ui-draggable').removeClass('ui-dragbox-outlined'),S('#rte-toolbar').css('display','none'),W.data('contenteditor').closePop(),S('#divRteTable').stop(!0,!0).fadeOut(0),S('#md-edittable').data('simplemodal')&&S('#md-edittable').data('simplemodal').hide(),S('#md-createlink').data('simplemodal')&&S('#md-createlink').data('simplemodal').hide(),L&&'http://'==L.attr('href')&&L.replaceWith(L.html()),S('#md-insertimage').data('simplemodal')&&S('#md-insertimage').data('simplemodal').hide(),S('#md-img').data('simplemodal')&&S('#md-img').data('simplemodal').hide(),S('#md-createsrc').data('simplemodal')&&S('#md-createsrc').data('simplemodal').hide(),S('#md-createiframe').data('simplemodal')&&S('#md-createiframe').data('simplemodal').hide(),S('#md-icon-select').data('simplemodal')&&S('#md-icon-select').data('simplemodal').hide(),S('#md-tags-select').data('simplemodal')&&S('#md-tags-select').data('simplemodal').hide()}}})},this.contentRender=function(){this.settings=S.extend({},U,M);var _=this.settings.iconselect;''!=_&&W.find('.ui-draggable > div:first-child i').each(function(){0<S(this).parents('[data-html]').length||0<S(this).parents('[data-mode=\'readonly\']').length||0<S(this).parents('[data-mode=\'readonly-protected\']').length||''==S(this).html()&&(S(this).unbind('click'),S(this).click(function(){$activeIcon=S(this),-1!=S('#ifrIconSelect').attr('src').indexOf('blank.html')&&S('#ifrIconSelect').attr('src',_),S('#md-icon-select').css('max-width','775px'),S('#md-icon-select').simplemodal({noOverlay:!0}),S('#md-icon-select').data('simplemodal').show(),W.data('contenteditor').closePop()}))})},this.realtime=function(){var _=detectIE(),Z,V;try{var Z;window.getSelection?(V=window.getSelection().getRangeAt(0).commonAncestorContainer,Z=V.parentNode):document.selection&&(V=document.selection.createRange(),Z=V.parentElement())}catch(se){return}if(!(0<S(Z).parents('[data-html]').length)&&!(0<S(Z).parents('[data-mode=\'readonly\']').length)&&!(0<S(Z).parents('[data-mode=\'readonly-protected\']').length)){'a'==Z.nodeName.toLowerCase()?(_,'block'!=S('#md-createlink').css('display')&&S('#divRteLink').addClass('forceshow')):S('#divRteLink').removeClass('forceshow'),V&&S(V).is('[contenteditable]')&&S('#rte-toolbar').stop(!0,!0).fadeIn(200),S(Z).is('[contenteditable]')&&S('#rte-toolbar').stop(!0,!0).fadeIn(200),0<S(Z).parents('[contenteditable]').length&&S('#rte-toolbar').stop(!0,!0).fadeIn(200),W.data('contenteditor').closePop();var Q=W.data('contenteditor').settings.editable;if(''==Q||(W.find(Q).unbind('mousedown'),W.find(Q).bind('mousedown',function(){if(R=S(this),S('#rte-toolbar').stop(!0,!0).fadeIn(200),ce_outline){for(var le=0;le<instances.length;le++)S(instances[le]).css('outline',''),S(instances[le]).find('*').css('outline','');S(this).css('outline','rgba(0, 0, 0, 0.43) dashed 1px')}}),W.find('.edit').find(Q).removeAttr('contenteditable')),0<S(Z).parents('table').length){var X=S(Z).parents('table').first(),K=X.offset().top-30,Y=X.offset().left+X.width()-parseInt(S('#divRteTable').css('width'));S('#divRteTable').css('top',K+'px'),S('#divRteTable').css('left',Y+'px'),'none'==S('#divRteTable').css('display')&&S('#divRteTable').stop(!0,!0).css({display:'none'}).fadeIn(20)}else S('#divRteTable').stop(!0,!0).fadeOut(0);if(savedSelPublic=saveSelection(),$activeIcon=null,!S(V).prop('tagName'))0<S(V).parents('td,th').length?N=S(V).parents('td,th').first():(N=null,S('#md-edittable').data('simplemodal')&&S('#md-edittable').data('simplemodal').hide());else if(0<S(Z).parents('[contenteditable]').length){var ee=S(V).prop('tagName').toLowerCase();'td'==ee||'th'==ee?N=S(V):0<S(V).parents('td,th').length?N=S(V).parents('td,th').first():(N=null,S('#md-edittable').data('simplemodal')&&S('#md-edittable').data('simplemodal').hide())}S('#md-createlink').data('simplemodal')&&S('#md-createlink').data('simplemodal').hide(),L&&'http://'==L.attr('href')&&L.replaceWith(L.html()),S('#md-img').data('simplemodal')&&S('#md-img').data('simplemodal').hide(),S('#md-createsrc').data('simplemodal')&&S('#md-createsrc').data('simplemodal').hide(),S('#md-createiframe').data('simplemodal')&&S('#md-createiframe').data('simplemodal').hide();var te;if(0<S(Z).parents('.ui-draggable').length&&S(Z).parents('.ui-draggable').parent().data('contentbuilder')&&(te=S(Z).parents('.ui-draggable').parent()),te){var ae=te.data('contentbuilder').settings.snippetPageSliding,ie=S(window),oe=ie.width(),ne=260;600>oe&&(ne=150),'right'==te.data('contentbuilder').settings.snippetTool?ae||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)?0==parseInt(S('#divTool').css('right'))&&(S('#divTool').animate({right:'-='+ne+'px'},200),S('body').animate({marginRight:'-='+ne+'px'},250),S('#rte-toolbar').animate({paddingRight:'-='+ne+'px'},250),S('#lnkToolOpen i').attr('class','cb-icon-left-open-big'),S('#divSnippetScrollUp').fadeOut(300),S('#divSnippetScrollDown').fadeOut(300)):0==parseInt(S('#divTool').css('right'))&&(S('#divTool').animate({right:'-='+ne+'px'},200),S('#lnkToolOpen i').attr('class','cb-icon-left-open-big'),S('#divSnippetScrollUp').css('display','none'),S('#divSnippetScrollDown').css('display','none')):ae||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)?0==parseInt(S('#divTool').css('left'))&&(S('#divTool').animate({left:'-='+(ne+0)+'px'},200),S('body').animate({marginLeft:'-='+ne+'px'},250),S('#rte-toolbar').animate({paddingLeft:'-='+ne+'px'},250),S('#lnkToolOpen i').attr('class','cb-icon-right-open-big'),S('#divSnippetScrollUp').fadeOut(300),S('#divSnippetScrollDown').fadeOut(300)):0==parseInt(S('#divTool').css('left'))&&(S('#divTool').animate({left:'-='+(ne+0)+'px'},200),S('#lnkToolOpen i').attr('class','cb-icon-right-open-big'),S('#divSnippetScrollUp').css('display','none'),S('#divSnippetScrollDown').css('display','none'))}W.data('contenteditor').getState()}},this.getState=function(){document.queryCommandState('bold')?S('[data-rte-cmd=bold]').addClass('on'):S('[data-rte-cmd=bold]').removeClass('on'),document.queryCommandState('italic')?S('[data-rte-cmd=italic]').addClass('on'):S('[data-rte-cmd=italic]').removeClass('on'),document.queryCommandState('underline')?S('[data-rte-cmd=underline]').addClass('on'):S('[data-rte-cmd=underline]').removeClass('on'),document.queryCommandState('strikethrough')?S('[data-rte-cmd=strikethrough]').addClass('on'):S('[data-rte-cmd=strikethrough]').removeClass('on'),document.queryCommandState('superscript')?S('[data-rte-cmd=superscript]').addClass('on'):S('[data-rte-cmd=superscript]').removeClass('on'),document.queryCommandState('subscript')?S('[data-rte-cmd=subscript]').addClass('on'):S('[data-rte-cmd=subscript]').removeClass('on'),document.queryCommandState('JustifyFull')?S('[data-align=justify]').addClass('on'):S('[data-align=justify]').removeClass('on'),document.queryCommandState('JustifyLeft')?S('[data-align=left]').addClass('on'):S('[data-align=left]').removeClass('on'),document.queryCommandState('JustifyRight')?S('[data-align=right]').addClass('on'):S('[data-align=right]').removeClass('on'),document.queryCommandState('JustifyCenter')?S('[data-align=center]').addClass('on'):S('[data-align=center]').removeClass('on');var _=document.queryCommandValue('FontName'),Z=_.split(',')[0];Z=Z.replace('"','').replace('"',''),Z=S.trim(Z).toLowerCase(),-1==S('#ifrFonts').attr('src').indexOf('fonts.html')&&S('#ifrFonts').attr('src',sScriptPath+'fonts.html?1'),S('#ifrFonts').contents().find('[data-font-family]').removeClass('on'),S('#ifrFonts').contents().find('[data-font-family]').each(function(){var K=S(this).attr('data-font-family');K=K.split(',')[0],K=S.trim(K).toLowerCase(),K==Z&&''!=K&&S(this).addClass('on')});var V=document.queryCommandValue('FormatBlock');V=V.toLowerCase(),'normal'==V&&(V='p'),'heading 1'==V&&(V='h1'),'heading 2'==V&&(V='h2'),'heading 3'==V&&(V='h3'),'heading 4'==V&&(V='h4'),'heading 5'==V&&(V='h5'),'heading 6'==V&&(V='h6'),'formatted'==V&&(V='pre'),-1==S('#ifrHeadings').attr('src').indexOf('headings.html')&&S('#ifrHeadings').attr('src',sScriptPath+'headings.html?1'),S('#ifrHeadings').contents().find('[data-heading]').removeClass('on'),S('#ifrHeadings').contents().find('[data-heading]').each(function(){var K=S(this).attr('data-heading');K==V&&''!=V&&S(this).addClass('on')});var Q,X;window.getSelection?(X=window.getSelection().getRangeAt(0).commonAncestorContainer,Q=3==X.nodeType?X.parentNode:X):document.selection&&(X=document.selection.createRange(),Q=document.selection.createRange().parentElement()),'uppercase'==S(Q).css('text-transform')?S('[data-rte-cmd=uppercase]').addClass('on'):S('[data-rte-cmd=uppercase]').removeClass('on')},this.closePop=function(){'block'==S('#pop-colors').css('display')&&saveForUndo(),S('.rte-pop').css('display','none'),S('[data-rte-cmd="formatting"]').removeClass('on'),S('[data-rte-cmd="textsettings"]').removeClass('on'),S('[data-rte-cmd="color"]').removeClass('on'),S('[data-rte-cmd="font"]').removeClass('on'),S('[data-rte-cmd="formatPara"]').removeClass('on'),S('[data-rte-cmd="align"]').removeClass('on'),S('[data-rte-cmd="list"]').removeClass('on'),S('[data-rte-cmd="table"]').removeClass('on')},this.render=function(){var _;_=null==localStorage.getItem('zoom')?W.css('zoom'):localStorage.zoom,_==void 0&&(_=1),localStorage.zoom=_;var Z=W.data('contenteditor').settings.editable;''==Z?(W.attr('contenteditable','true'),W.unbind('mousedown'),W.bind('mousedown',function(){if(R=S(this),S('#rte-toolbar').stop(!0,!0).fadeIn(200),ce_outline){for(var K=0;K<instances.length;K++)S(instances[K]).css('outline',''),S(instances[K]).find('*').css('outline','');S(this).css('outline','rgba(0, 0, 0, 0.43) dashed 1px')}})):(W.find(Z).each(function(){var X=W.data('contenteditor').settings.editMode;if('default'==X)0<S(this).parents('[data-html]').length&&S(this).hasClass('edit')&&S(this).attr('contenteditable','true');else{if(0<S(this).parents('[data-html]').length)return;if(0<S(this).parents('[data-mode=\'readonly\']').length)return;if(0<S(this).parents('[data-mode=\'readonly-protected\']').length)return;var K=S(this).attr('contenteditable');typeof K!=typeof void 0&&!1!==K||S(this).attr('contenteditable','true')}}),W.find(Z).unbind('mousedown'),W.find(Z).bind('mousedown',function(){if(R=S(this),ce_outline){for(var K=0;K<instances.length;K++)S(instances[K]).css('outline',''),S(instances[K]).find('*').css('outline','');S(this).css('outline','rgba(0, 0, 0, 0.43) dashed 1px')}}),W.find('.edit').find(Z).removeAttr('contenteditable'));var V=W.data('contenteditor').settings.editMode;'default'==V?(W.find('h1,h2,h3,h4,h5,h6').unbind('keydown'),W.find('h1,h2,h3,h4,h5,h6').bind('keydown',function(X){if(13==X.keyCode){var K=detectIE();if(K&&10>=K){var Y=document.selection.createRange();if(Y.parentElement)return Y.pasteHTML('<br>'),X.cancelBubble=!0,X.returnValue=!1,Y.select(),Y.moveEnd('character',1),Y.moveStart('character',1),Y.collapse(!1),!1}else{var Y=window.getSelection(),ee=Y.getRangeAt(0);ee.extractContents(),ee.collapse(!0);var te=ee.createContextualFragment('<br>'),ae=te.lastChild;ee.insertNode(te),ee.setStartAfter(ae),ee.setEndAfter(ae),1==ee.endContainer.nodeType&&ee.endOffset==ee.endContainer.childNodes.length-1&&(ee.insertNode(ee.createContextualFragment('<br />')),ee.setStartAfter(ae),ee.setEndAfter(ae));var ie=ee.commonAncestorContainer;if(ie&&ie.parentNode)try{ie.parentNode.normalize()}catch(oe){}return Y.removeAllRanges(),Y.addRange(ee),!1}}}),W.children('div.ui-draggable').each(function(){try{var X=S(this).children().first().children().first().attr('data-html');if(typeof X!=typeof void 0&&!1!==X)return;if(0<S(this).children().first().children().first().parents('[data-html]').length)return;if(0<S(this).children().first().children().first().parents('[data-mode=\'readonly\']').length)return;if(0<S(this).children().first().children().first().parents('[data-mode=\'readonly-protected\']').length)return}catch(te){}var K=!1;try{'table'==S(this).children().first().children().first().prop('tagName').toLowerCase()&&(K=!0)}catch(te){}K?S(this).find('td,th').each(function(){1==S(this).children().length?'table'==S(this).children().first().prop('tagName').toLowerCase()||S(this).attr('contenteditable',!0):S(this).attr('contenteditable',!0)}):S(this).children().first().children().each(function(){S(this).attr('contenteditable',!0)});var Y=detectIE(),ee=detectEdge();if(Y&&11>=Y||ee)try{'table'==S(this).children().first().children().first().prop('tagName').toLowerCase()&&S(this).children().first().attr('contenteditable',!0)}catch(te){}}),W.find('div').unbind('keyup'),W.find('div').bind('keyup',function(X){var K,Y;if(window.getSelection?(Y=window.getSelection().getRangeAt(0).commonAncestorContainer,K=window.getSelection().getRangeAt(0).commonAncestorContainer.parentNode):document.selection&&(Y=document.selection.createRange(),K=document.selection.createRange().parentElement()),13==X.keyCode&&!X.shiftKey){var ee=detectIE();if(0<ee);else{var te=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),ae=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor),ie=window.opera,oe=-1<navigator.userAgent.toLowerCase().indexOf('firefox');(te||ie)&&('p'==S(K).prop('tagName').toLowerCase()||'div'==S(K).prop('tagName').toLowerCase())&&document.execCommand('formatBlock',!1,'<p>'),oe&&!S(Y).html()&&document.execCommand('formatBlock',!1,'<p>')}}}),W.find('div').unbind('keydown'),W.find('div').bind('keydown',function(X){var K,Y;if(window.getSelection?(Y=window.getSelection().getRangeAt(0).commonAncestorContainer,K=window.getSelection().getRangeAt(0).commonAncestorContainer.parentNode):document.selection&&(Y=document.selection.createRange(),K=document.selection.createRange().parentElement()),(8==X.keyCode||46==X.keyCode)&&S(Y).html()){var ee=S(Y).prop('tagName').toLowerCase();if(('h1'==ee||'h1'==ee||'h2'==ee||'h3'==ee||'h4'==ee||'h5'==ee||'h6'==ee||'p'==ee)&&''==S(Y).text()){document.execCommand('removeFormat',!1,null),S(Y).remove();var te=window.getSelection(),ae=te.getRangeAt(0);ae.extractContents(),ae.collapse(!0),te.removeAllRanges(),te.addRange(ae),X.preventDefault(),X.stopImmediatePropagation()}}})):(W.find('p').unbind('keydown'),W.find('p').bind('keydown',function(X){if(13==X.keyCode&&0==W.find('li').length){var K=navigator.userAgent.toLowerCase(),Y=!!(0<=K.indexOf('msie'));if(Y){var ee=document.selection.createRange();if(ee.parentElement)return ee.pasteHTML('<br>'),X.cancelBubble=!0,X.returnValue=!1,ee.select(),ee.moveEnd('character',1),ee.moveStart('character',1),ee.collapse(!1),!1}else{var ee=window.getSelection(),te=ee.getRangeAt(0);te.extractContents(),te.collapse(!0);var ae=te.createContextualFragment('<br>'),ie=ae.lastChild;te.insertNode(ae),te.setStartAfter(ie),te.setEndAfter(ie),1==te.endContainer.nodeType&&te.endOffset==te.endContainer.childNodes.length-1&&(te.insertNode(te.createContextualFragment('<br />')),te.setStartAfter(ie),te.setEndAfter(ie));var oe=te.commonAncestorContainer;if(oe&&oe.parentNode)try{oe.parentNode.normalize()}catch(ne){}return ee.removeAllRanges(),ee.addRange(te),!1}}})),S('[data-rte-cmd="removeElement"]').unbind('click'),S('[data-rte-cmd="removeElement"]').click(function(X){R.remove(),W.data('contenteditor').settings.hasChanged=!0,W.data('contenteditor').render(),saveForUndo(),X.preventDefault()}),S('[data-rte-cmd="fontsize"]').unbind('click'),S('[data-rte-cmd="fontsize"]').click(function(X){var K=saveSelection();S('#md-fontsize').css('max-width','190px'),S('#md-fontsize').simplemodal(),S('#md-fontsize').data('simplemodal').show(K),W.data('contenteditor').closePop(),X.preventDefault(),-1==S('#ifrFontSize').attr('src').indexOf('fontsize.html')&&S('#ifrFontSize').attr('src',sScriptPath+'fontsize.html');var Y=getSelected();S('.md-pickfontsize').unbind('click'),S('.md-pickfontsize').click(function(){restoreSelection(K);var ee,te;if(window.getSelection?(te=window.getSelection().getRangeAt(0).commonAncestorContainer,ee=3==te.nodeType?te.parentNode:te):document.selection&&(te=document.selection.createRange(),ee=document.selection.createRange().parentElement()),0==S(ee).parents('[contenteditable]').length)return void S('#md-fontsize').data('simplemodal').hide();var ae=S(this).attr('data-font-size');if(''!=S.trim(Y)&&S(ee).text()!=Y){document.execCommand('fontSize',!1,'7');for(var ie=document.getElementsByTagName('font'),oe=0,ne=ie.length;oe<ne;++oe)'7'==ie[oe].size&&(ie[oe].removeAttribute('size'),ie[oe].style.fontSize=ae)}else S(ee).text()==Y?S(ee).html()?S(ee).css('font-size',ae):S(ee).parent().css('font-size',ae):S(ee).css('font-size',ae);S(this).blur(),W.data('contenteditor').settings.hasChanged=!0,X.preventDefault(),saveForUndo()})}),S('[data-rte-cmd="removeFormat"]').unbind('click'),S('[data-rte-cmd="removeFormat"]').click(function(X){document.execCommand('removeFormat',!1,null),document.execCommand('removeFormat',!1,null),S(this).blur(),W.data('contenteditor').settings.hasChanged=!0,X.preventDefault(),saveForUndo()}),S('[data-rte-cmd="unlink"]').unbind('click'),S('[data-rte-cmd="unlink"]').click(function(X){document.execCommand('unlink',!1,null),S('#divRteLink').removeClass('forceshow'),S(this).blur(),W.data('contenteditor').settings.hasChanged=!0,X.preventDefault(),saveForUndo()});var Q;S('[data-rte-cmd="html"]').unbind('click'),S('[data-rte-cmd="html"]').click(function(X){var K;window.getSelection?K=window.getSelection().getRangeAt(0).commonAncestorContainer.parentNode:document.selection&&(K=document.selection.createRange().parentElement());var Y=!1;S(K).parents().each(function(){S(this).data('contentbuilder')&&(S(this).data('contentbuilder').viewHtml(),Y=!0,Q=K)}),!Y&&Q&&(K=Q,S(K).parents().each(function(){S(this).data('contentbuilder')&&S(this).data('contentbuilder').viewHtml()})),X.preventDefault()}),S('[data-rte-cmd="formatPara"]').unbind('click'),S('[data-rte-cmd="formatPara"]').click(function(X){savedSelPublic=saveSelection();var K=S(this).offset().top-S(window).scrollTop(),Y=S(this).offset().left;S('#rte-toolbar').hasClass('rte-side')?(S('#pop-headings').addClass('rte-side'),S('#rte-toolbar').hasClass('right')?Y=Y-57-132:Y+=57):K+=51,S('#pop-headings').css('position','fixed'),S('#pop-headings').css('top',K+'px'),S('#pop-headings').css('left',Y+'px'),W.data('contenteditor').closePop(),S('#pop-headings').css('display','block'),S(this).addClass('on'),-1==S('#ifrHeadings').attr('src').indexOf('headings.html')&&S('#ifrHeadings').attr('src',sScriptPath+'headings.html?1');var ee=detectIE();ee&&restoreSelection(savedSelPublic),W.data('contenteditor').getState();try{var te=S('#ifrHeadings').contents(),ae=te.find('#divHeadings'),ie=te.find('.on');ae.animate({scrollTop:ae.scrollTop()+ie.position().top-7},1e3)}catch(oe){}S('.md-pickheading').unbind('click'),S('.md-pickheading').click(function(){restoreSelection(savedSelPublic);var oe=S(this).attr('data-heading');W.attr('contenteditable',!0),document.execCommand('formatBlock',!1,'<'+oe+'>'),W.removeAttr('contenteditable'),W.data('contenteditor').render(),W.data('contenteditor').getState(),W.data('contenteditor').settings.hasChanged=!0,X.preventDefault(),savedSelPublic=saveSelection(),saveForUndo()})}),S('[data-rte-cmd="font"]').unbind('click'),S('[data-rte-cmd="font"]').click(function(X){savedSelPublic=saveSelection();var K=S(this).offset().top-S(window).scrollTop(),Y=S(this).offset().left;S('#rte-toolbar').hasClass('rte-side')?(S('#pop-fontfamily').addClass('rte-side'),S('#rte-toolbar').hasClass('right')?Y=Y-57-132:Y+=57):K+=51,S('#pop-fontfamily').css('position','fixed'),S('#pop-fontfamily').css('top',K+'px'),S('#pop-fontfamily').css('left',Y+'px'),W.data('contenteditor').closePop(),S('#pop-fontfamily').css('display','block'),S(this).addClass('on'),-1==S('#ifrFonts').attr('src').indexOf('fonts.html')&&S('#ifrFonts').attr('src',sScriptPath+'fonts.html?1');var ee=getSelected();W.data('contenteditor').getState();try{var te=S('#ifrFonts').contents(),ae=te.find('#divFontList'),ie=te.find('.on');ae.animate({scrollTop:ae.scrollTop()+ie.position().top-7},1e3)}catch(oe){}S('.md-pickfontfamily').unbind('click'),S('.md-pickfontfamily').click(function(){restoreSelection(savedSelPublic);var oe,ne;window.getSelection?(ne=window.getSelection().getRangeAt(0).commonAncestorContainer,oe=3==ne.nodeType?ne.parentNode:ne,'H1'!=oe.nodeName&&'H2'!=oe.nodeName&&'H3'!=oe.nodeName&&'H4'!=oe.nodeName&&'H5'!=oe.nodeName&&'H6'!=oe.nodeName&&'P'!=oe.nodeName&&(oe=oe.parentNode)):document.selection&&(ne=document.selection.createRange(),oe=document.selection.createRange().parentElement(),'H1'!=oe.nodeName&&'H2'!=oe.nodeName&&'H3'!=oe.nodeName&&'H4'!=oe.nodeName&&'H5'!=oe.nodeName&&'H6'!=oe.nodeName&&'P'!=oe.nodeName&&(oe=oe.parentElement()));var se=S(this).attr('data-font-family');if(''!=S.trim(ee)&&S(oe).text()!=ee){document.execCommand('fontName',!1,se);for(var le=document.getElementsByTagName('font'),de=0,ce=le.length;de<ce;++de)le[de].face==se&&(le[de].removeAttribute('face'),le[de].style.fontFamily=se)}else S(oe).text()==ee?S(oe).html()?S(oe).css('font-family',se):S(oe).parent().css('font-family',se):S(oe).css('font-family',se);var pe=S(this).attr('data-font-style');pe=pe?':'+pe:'';var me=se.split(',')[0],ge=S(this).attr('data-provider');if('google'==ge){for(var ue=!1,be=document.getElementsByTagName('link'),de=0,he;de<be.length;de++)he=be[de].href.toLowerCase(),he=he.replace(/\+/g,' ').replace(/%20/g,' '),-1!=he.indexOf(me.toLowerCase())&&(ue=!0);ue||S(oe).parents().each(function(){S(this).data('contentbuilder')&&S(this).append('<link href="https://fonts.googleapis.com/css?family='+me+pe+'" rel="stylesheet" property="stylesheet" type="text/css">')})}S(cb_list).each(function(){var fe=S(this);fe.find('link').each(function(){var ve=S(this).attr('href').toLowerCase();if(-1!=ve.indexOf('googleapis')){ve=ve.replace(/\+/g,' ').replace(/%20/g,' ');var Ce=ve.substr(ve.indexOf('family=')+7);-1!=Ce.indexOf(':')&&(Ce=Ce.split(':')[0]),-1!=Ce.indexOf('|')&&(Ce=Ce.split('|')[0]);var ye=fe.data('contentbuilder').html().toLowerCase(),xe=ye.split(Ce).length;3>xe&&S(this).attr('data-rel','_del')}})}),W.find('[data-rel="_del"]').remove(),W.data('contenteditor').getState(),W.data('contenteditor').settings.hasChanged=!0,X.preventDefault(),saveForUndo()})}),S('[data-rte-cmd="image"]').unbind('click'),S('[data-rte-cmd="image"]').click(function(X){return savedSelPublic=saveSelection(),S('#md-insertimage').css('max-width','550px'),S('#md-insertimage').simplemodal({noOverlay:!0}),S('#md-insertimage').data('simplemodal').show(savedSel),W.data('contenteditor').closePop(),S('#fileInsertImage').clearInputs(),S('.md-preview-area').hide(),S('.md-drop-area').show(),S('.md-drop-area').removeClass('image-dropping'),S('#txtImgUrl_rte').val(''),S('#btnImgOk_rte').unbind('click'),S('#btnImgOk_rte').click(function(){if(savedSelPublic){restoreSelection(savedSelPublic);var K='';if(K='none'==S('.md-drop-area').css('display')?S('#imgInsertImagePreview').attr('src'):S('#txtImgUrl_rte').val(),''!=K){pasteHtmlAtCaret('<img src="'+K+'" />',!0),S('#md-insertimage').data('simplemodal').hide(),W.data('contenteditor').settings.hasChanged=!0;var Y,ee;window.getSelection?(ee=window.getSelection().getRangeAt(0).commonAncestorContainer,Y=3==ee.nodeType?ee.parentNode:ee):document.selection&&(ee=document.selection.createRange(),Y=document.selection.createRange().parentElement()),S(Y).parents().each(function(){S(this).data('contentbuilder')&&S(this).data('contentbuilder').applyBehavior()});var te;window.getSelection?te=window.getSelection():document.selection&&(te=document.selection),te.removeAllRanges(),S('#rte-toolbar').css('display','none')}}}),X.preventDefault(),void saveForUndo()}),S('#fileInsertImage').unbind('change'),S('#fileInsertImage').on('change',function(X){var K=X.target;if(K.files&&K.files[0]){var Y=new FileReader;Y.onload=function(ee){S('.md-drop-area').hide(),S('#imgInsertImagePreview').attr('src',ee.target.result),S('.md-preview-area').show(),S('.image-title').html(K.files[0].name)},Y.readAsDataURL(K.files[0]),S('#txtImgUrl_rte').val('')}}),S('.md-drop-area').unbind('dragover'),S('.md-drop-area').bind('dragover',function(){S('.md-drop-area').addClass('image-dropping')}),S('.md-drop-area').unbind('dragleave'),S('.md-drop-area').bind('dragleave',function(){S('.md-drop-area').removeClass('image-dropping')}),S('.md-preview-area i').unbind('click'),S('.md-preview-area i').click(function(){S('#fileInsertImage').clearInputs(),S('.md-preview-area').hide(),S('.md-drop-area').show(),S('.md-drop-area').removeClass('image-dropping')}),S('#txtImgUrl_rte').unbind('keyup'),S('#txtImgUrl_rte').bind('keyup',function(){S('#fileInsertImage').clearInputs(),S('.md-preview-area').hide(),S('.md-drop-area').show(),S('.md-drop-area').removeClass('image-dropping')}),S('#btnImageBrowse_rte').unbind('click'),S('#btnImageBrowse_rte').bind('click',function(){var K=(W.data('contenteditor').settings.onImageSelectClick+'').replace(/\s/g,'');'function(){}'==K?(S('#ifrImageBrowse').attr('src',W.data('contenteditor').settings.imageselect),S('#active-input').val('txtImgUrl_rte'),S('#md-imageselect').css('width','65%'),S('#md-imageselect').simplemodal({onFinish:function(){''!=S('#txtImgUrl_rte').val()&&(S('#fileInsertImage').clearInputs(),S('.md-preview-area').hide(),S('.md-drop-area').show(),S('.md-drop-area').removeClass('image-dropping'))}}),S('#md-imageselect').data('simplemodal').show()):W.data('contenteditor').settings.onImageSelectClick({targetInput:S('#txtImgUrl_rte').get(0),theTrigger:S('#btnImageBrowse_rte').get(0)})}),S('[data-rte-cmd="formatting"]').unbind('click'),S('[data-rte-cmd="formatting"]').click(function(X){savedSelPublic=saveSelection();var K=S(this).offset().top-S(window).scrollTop(),Y=S(this).offset().left;S('#rte-toolbar').hasClass('rte-side')?(S('#pop-formatting').addClass('rte-side'),S('#rte-toolbar').hasClass('right')?Y-=58:Y+=57):K+=51,S('#pop-formatting').css('position','fixed'),S('#pop-formatting').css('top',K+'px'),S('#pop-formatting').css('left',Y+'px'),W.data('contenteditor').closePop(),S('#pop-formatting').css('display','block'),S(this).addClass('on'),W.data('contenteditor').getState();var ee,te;window.getSelection?(te=window.getSelection().getRangeAt(0).commonAncestorContainer,ee=3==te.nodeType?te.parentNode:te):document.selection&&(te=document.selection.createRange(),ee=document.selection.createRange().parentElement()),X.preventDefault(),saveForUndo()}),S('[data-rte-cmd="textsettings"]').unbind('click'),S('[data-rte-cmd="textsettings"]').click(function(X){savedSelPublic=saveSelection();var K=S(this).offset().top-S(window).scrollTop(),Y=S(this).offset().left;S('#rte-toolbar').hasClass('rte-side')?(S('#pop-textsettings').addClass('rte-side'),S('#rte-toolbar').hasClass('right')?Y=Y-57-132:Y+=57):K+=51,S('#pop-textsettings').css('position','fixed'),S('#pop-textsettings').css('top',K+'px'),S('#pop-textsettings').css('left',Y+'px'),W.data('contenteditor').closePop(),S('#pop-textsettings').css('display','block'),S(this).addClass('on');var ee,te;window.getSelection?(te=window.getSelection().getRangeAt(0).commonAncestorContainer,ee=3==te.nodeType?te.parentNode:te):document.selection&&(te=document.selection.createRange(),ee=document.selection.createRange().parentElement());var ae=parseInt(S(ee).css('font-size'));S('#inpFontSize').val(ae).change(),S('#outFontSize').html(ae+'px');var ie=parseInt(S(ee).css('letter-spacing'));S('#inpLetterSpacing').val(ie).change(),S('#outLetterSpacing').html(ie+'px');var oe=parseInt(S(ee).css('line-height'));S('#inpLineHeight').val(oe).change(),S('#outLineHeight').html(oe+'px'),X.preventDefault()}),S('#btnResetTextSettings').unbind('click'),S('#btnResetTextSettings').click(function(X){if(savedSelPublic){restoreSelection(savedSelPublic);var K,Y;window.getSelection?(Y=window.getSelection().getRangeAt(0).commonAncestorContainer,K=3==Y.nodeType?Y.parentNode:Y):document.selection&&(Y=document.selection.createRange(),K=document.selection.createRange().parentElement()),S(K).css('font-size',''),S(K).css('letter-spacing',''),S(K).css('line-height','');var K,Y;window.getSelection?(Y=window.getSelection().getRangeAt(0).commonAncestorContainer,K=3==Y.nodeType?Y.parentNode:Y):document.selection&&(Y=document.selection.createRange(),K=document.selection.createRange().parentElement());var ee=parseInt(S(K).css('font-size'));S('#inpFontSize').val(ee).change(),S('#outFontSize').html(ee+'px');var te=parseInt(S(K).css('letter-spacing'));S('#inpLetterSpacing').val(te).change(),S('#outLetterSpacing').html(te+'px');var ae=parseInt(S(K).css('line-height'));S('#inpLineHeight').val(ae).change(),S('#outLineHeight').html(ae+'px'),savedSelPublic=saveSelection(),W.data('contenteditor').getState(),W.data('contenteditor').settings.hasChanged=!0,saveForUndo()}X.preventDefault()}),S('[data-rte-cmd="color"]').unbind('click'),S('[data-rte-cmd="color"]').click(function(){savedSelPublic=saveSelection();var K=S(this).offset().top-S(window).scrollTop(),Y=S(this).offset().left;S('#rte-toolbar').hasClass('rte-side')?(S('#pop-colors').addClass('rte-side'),S('#rte-toolbar').hasClass('right')?Y=Y-57-215:Y+=57):K+=51,S('#pop-colors').css('position','fixed'),S('#pop-colors').css('top',K+'px'),S('#pop-colors').css('left',Y+'px'),W.data('contenteditor').closePop(),S('#pop-colors').css('display','block'),S(this).addClass('on');var ee,te;window.getSelection?(te=window.getSelection().getRangeAt(0).commonAncestorContainer,ee=3==te.nodeType?te.parentNode:te):document.selection&&(te=document.selection.createRange(),ee=document.selection.createRange().parentElement()),S('#selColorApplyTo').unbind('change'),S('#selColorApplyTo').on('change',function(){var oe=S('#selColorApplyTo').val();if(1==oe){var ne=S(ee).css('color');S('#inpTextColor').val(ne),S('#inpTextColor').css('background-color',ne),S('#inpTextColor').contrastingText()}if(2==oe){if(S(ee).closest('table.button').length)var ne=S(ee).parent().css('background-color');else var ne=S(ee).css('background-color');S('#inpTextColor').val(ne),S('#inpTextColor').css('background-color',ne),S('#inpTextColor').contrastingText()}if(3==oe){var ne=S(ee).parents('.ui-draggable').children().first().children().first().css('background-color');S('#inpTextColor').val(ne),S('#inpTextColor').css('background-color',ne),S('#inpTextColor').contrastingText()}if(4==oe){var ne=S('#main').css('background-color');S('#inpTextColor').val(ne),S('#inpTextColor').css('background-color',ne),S('#inpTextColor').contrastingText()}if(5==oe){var ne=S('#contentarea').css('border-color');S('#inpTextColor').val(ne),S('#inpTextColor').css('background-color',ne),S('#inpTextColor').contrastingText()}}),S('#selColorApplyTo').change();var ae=!1;try{'table'==W.children('div.ui-draggable').first().children().first().children().first().prop('tagName').toLowerCase()&&(ae=!0)}catch(oe){}var ie=getSelected();S('.md-pick').unbind('click'),S('.md-pick').click(function(){var oe=S(this).css('background-color');S('#inpTextColor').val(oe),S('#inpTextColor').css('background-color',oe),S('#inpTextColor').contrastingText(),restoreSelection(savedSelPublic),W.data('contenteditor').applyColor(oe,ie),savedSelPublic=saveSelection()}),S('#inpTextColor').colorPicker({dark:'#222',light:'#DDD',renderCallback:function(oe,ne){if(!0===ne);else if(!1===ne);else{var se=S('#inpTextColor').val();restoreSelection(savedSelPublic),W.data('contenteditor').applyColor(se,ie),savedSelPublic=saveSelection()}}}),S('#inpTextColor').unbind('blur'),S('#inpTextColor').on('blur',function(){var oe=S('#inpTextColor').val();restoreSelection(savedSelPublic),W.data('contenteditor').applyColor(oe,ie),savedSelPublic=saveSelection()}),S('#btnTextColorClear').unbind('click'),S('#btnTextColorClear').click(function(){restoreSelection(savedSelPublic);var oe,ne;window.getSelection?(ne=window.getSelection().getRangeAt(0).commonAncestorContainer,oe=3==ne.nodeType?ne.parentNode:ne):document.selection&&(ne=document.selection.createRange(),oe=document.selection.createRange().parentElement());var se=S('#selColorApplyTo').val();if(''!=S.trim(ie)&&S(oe).text()!=ie){1==se&&document.execCommand('ForeColor',!1,''),2==se&&document.execCommand('BackColor',!1,'');for(var le=document.getElementsByTagName('font'),de=0,ce=le.length,pe;de<ce;++de)pe=le[de].color,le[de].removeAttribute('color'),le[de].style.color=pe}else S(oe).text()==ie?(1==se&&(S(oe).html()?S(oe).css('color',''):S(oe).parent().css('color','')),2==se&&(S(oe).html()?S(oe).css('background-color',''):S(oe).parent().css('background-color',''))):(1==se&&S(oe).css('color',''),2==se&&(S(oe).css('background-color',''),S(oe).closest('table.button').length&&S(oe).closest('td').css('background-color','rgb(33, 153, 232)')));3==se&&S(oe).parents('.ui-draggable').children('div').children('table').first().css('background-color',''),4==se&&S('#main,html').css('background-color','#f3f3f3'),5==se&&S('#contentarea').css('border-color','').css('border-width','').css('border-style',''),S('#selColorApplyTo').change()})}),S('[data-rte-cmd="bold"]').unbind('click'),S('[data-rte-cmd="bold"]').click(function(X){var K=saveSelection(),Y=getSelected(),ee,te;window.getSelection?(te=window.getSelection().getRangeAt(0).commonAncestorContainer,ee=3==te.nodeType?te.parentNode:te):document.selection&&(te=document.selection.createRange(),ee=document.selection.createRange().parentElement());var ae;if(ae=isNaN(S(ee).css('font-weight'))?'bold'==S(ee).css('font-weight')?'normal':'bold':500>=S(ee).css('font-weight')?'bold':'normal',''!=S.trim(Y)){try{document.execCommand('bold',!1,null)}catch(oe){W.attr('contenteditable',!0),document.execCommand('bold',!1,null),W.removeAttr('contenteditable'),W.data('contenteditor').render()}K=saveSelection()}else{var ie=S(ee).prop('tagName').toLowerCase();if('b'==ie){selectElementContents(ee);try{document.execCommand('bold',!1,null)}catch(oe){W.attr('contenteditable',!0),document.execCommand('bold',!1,null),W.removeAttr('contenteditable'),W.data('contenteditor').render()}}else S(ee).css('font-weight',ae)}''==S.trim(Y)&&restoreSelection(K),W.data('contenteditor').getState(),W.data('contenteditor').settings.hasChanged=!0,X.preventDefault(),saveForUndo()}),S('[data-rte-cmd="italic"]').unbind('click'),S('[data-rte-cmd="italic"]').click(function(X){var K=saveSelection(),Y=getSelected(),ee,te;window.getSelection?(te=window.getSelection().getRangeAt(0).commonAncestorContainer,ee=3==te.nodeType?te.parentNode:te):document.selection&&(te=document.selection.createRange(),ee=document.selection.createRange().parentElement());var ae;if(ae='italic'==S(ee).css('font-style')?'normal':'italic',''!=S.trim(Y)){try{document.execCommand('italic',!1,null)}catch(oe){W.attr('contenteditable',!0),document.execCommand('italic',!1,null),W.removeAttr('contenteditable'),W.data('contenteditor').render()}K=saveSelection()}else{var ie=S(ee).prop('tagName').toLowerCase();if('i'==ie||'em'==ie){selectElementContents(ee);try{document.execCommand('italic',!1,null)}catch(oe){W.attr('contenteditable',!0),document.execCommand('italic',!1,null),W.removeAttr('contenteditable'),W.data('contenteditor').render()}}else S(ee).css('font-style',ae)}''==S.trim(Y)&&restoreSelection(K),W.data('contenteditor').getState(),W.data('contenteditor').settings.hasChanged=!0,X.preventDefault(),saveForUndo()}),S('[data-rte-cmd="underline"]').unbind('click'),S('[data-rte-cmd="underline"]').click(function(X){var K=saveSelection(),Y=getSelected(),ee,te;window.getSelection?(te=window.getSelection().getRangeAt(0).commonAncestorContainer,ee=3==te.nodeType?te.parentNode:te):document.selection&&(te=document.selection.createRange(),ee=document.selection.createRange().parentElement());var ae;if(ae=-1==S(ee).css('text-decoration').indexOf('underline')?'underline':'',''!=S.trim(Y)){try{document.execCommand('underline',!1,null)}catch(oe){W.attr('contenteditable',!0),document.execCommand('underline',!1,null),W.removeAttr('contenteditable'),W.data('contenteditor').render()}K=saveSelection()}else{var ie=S(ee).prop('tagName').toLowerCase();if('u'==ie){selectElementContents(ee);try{document.execCommand('underline',!1,null)}catch(oe){W.attr('contenteditable',!0),document.execCommand('underline',!1,null),W.removeAttr('contenteditable'),W.data('contenteditor').render()}}else S(ee).css('text-decoration',ae)}''==S.trim(Y)&&restoreSelection(K),W.data('contenteditor').getState(),W.data('contenteditor').settings.hasChanged=!0,X.preventDefault(),saveForUndo()}),S('[data-rte-cmd="strikethrough"]').unbind('click'),S('[data-rte-cmd="strikethrough"]').click(function(X){var K=saveSelection(),Y=getSelected(),ee,te;window.getSelection?(te=window.getSelection().getRangeAt(0).commonAncestorContainer,ee=3==te.nodeType?te.parentNode:te):document.selection&&(te=document.selection.createRange(),ee=document.selection.createRange().parentElement());var ae;if(ae=-1==S(ee).css('text-decoration').indexOf('line-through')?'line-through':'',''!=S.trim(Y)){try{document.execCommand('strikethrough',!1,null)}catch(oe){W.attr('contenteditable',!0),document.execCommand('strikethrough',!1,null),W.removeAttr('contenteditable'),W.data('contenteditor').render()}K=saveSelection()}else{var ie=S(ee).prop('tagName').toLowerCase();if('strike'==ie){selectElementContents(ee);try{document.execCommand('strikethrough',!1,null)}catch(oe){W.attr('contenteditable',!0),document.execCommand('strikethrough',!1,null),W.removeAttr('contenteditable'),W.data('contenteditor').render()}}else S(ee).css('text-decoration',ae)}''==S.trim(Y)&&restoreSelection(K),W.data('contenteditor').getState(),W.data('contenteditor').settings.hasChanged=!0,X.preventDefault(),saveForUndo()}),S('[data-rte-cmd="uppercase"]').unbind('click'),S('[data-rte-cmd="uppercase"]').click(function(X){var K=saveSelection(),Y=getSelected(),ee,te;window.getSelection?(te=window.getSelection().getRangeAt(0).commonAncestorContainer,ee=3==te.nodeType?te.parentNode:te):document.selection&&(te=document.selection.createRange(),ee=document.selection.createRange().parentElement());var ae;ae='uppercase'==S(ee).css('text-transform')?'':'uppercase',S(ee).css('text-transform',ae),''==S.trim(Y)&&restoreSelection(K),W.data('contenteditor').getState(),W.data('contenteditor').settings.hasChanged=!0,X.preventDefault(),saveForUndo()}),S('[data-rte-cmd="table"]').unbind('click'),S('[data-rte-cmd="table"]').click(function(X){var K=saveSelection(),Y=S(this).offset().top-S(window).scrollTop(),ee=S(this).offset().left;S('#rte-toolbar').hasClass('rte-side')?(S('#pop-table').addClass('rte-side'),S('#rte-toolbar').hasClass('right')?ee=ee-57-163:ee+=57):Y+=51,S('#pop-table').css('position','fixed'),S('#pop-table').css('top',Y+'px'),S('#pop-table').css('left',ee+'px'),W.data('contenteditor').closePop(),S('#pop-table').css('display','block'),S(this).addClass('on'),X.preventDefault(),S('#tableInsert td').unbind('mouseover'),S('#tableInsert td').on('mouseover',function(){var ae=S(this).attr('data-row'),ie=S(this).attr('data-col'),oe=0;S('#tableInsert tr').each(function(){var ne=0,se=S(this);se.children('td').each(function(){var le=S(this);oe<ae&&ne<ie?le.addClass('highlight'):le.removeClass('highlight'),ne++}),oe++})}),S('#tableInsert').unbind('mouseout'),S('#tableInsert').on('mouseout',function(){S('#tableInsert tr').each(function(){var ae=S(this);ae.children('td').each(function(){var ie=S(this);ie.removeClass('highlight')})})}),S('#tableInsert td').unbind('click'),S('#tableInsert td').click(function(te){restoreSelection(K);for(var ae=S(this).attr('data-row'),ie=S(this).attr('data-col'),oe='<table class="default" style="border-collapse:collapse;width:100%;">',ne=1;ne<=ae;ne++){oe+='<tr>';for(var se=1;se<=ie;se++)oe+='<td valign="top"><br></td>';oe+='</tr>'}oe+='</table>',pasteHtmlAtCaret(oe),W.data('contenteditor').closePop(),W.data('contenteditor').render(),W.data('contenteditor').settings.hasChanged=!0,te.preventDefault(),saveForUndo()})}),S('#btnDeleteTable').unbind('click'),S('#btnDeleteTable').click(function(){S('#md-edittable').data('simplemodal')&&S('#md-edittable').data('simplemodal').hide(),S('#md-deltableconfirm').css('max-width','550px'),S('#md-deltableconfirm').simplemodal(),S('#md-deltableconfirm').data('simplemodal').show(),S('#btnDelTableOk').unbind('click'),S('#btnDelTableOk').bind('click',function(){S('#md-deltableconfirm').data('simplemodal').hide();var Y=N.parents('table').first();Y.fadeOut(400,function(){S('#divRteTable').stop(!0,!0).fadeOut(0),Y.remove(),W.data('contenteditor').render(),W.data('contenteditor').settings.hasChanged=!0,saveForUndo()})}),S('#btnDelTableCancel').unbind('click'),S('#btnDelTableCancel').bind('click',function(){S('#md-deltableconfirm').data('simplemodal').hide()})}),S('#btnEditTable').unbind('click'),S('#btnEditTable').click(function(){var K=saveSelection();W.data('contenteditor').closePop(),S('#md-edittable').css('width','267px'),S('#md-edittable').simplemodal({noOverlay:!0}),S('#md-edittable').data('simplemodal').show(),S('#tabTableDesign').unbind('click'),S('#tabTableDesign').bind('click',function(){S('#tabTableDesign').addClass('active'),S('#tabTableLayout').removeClass('active'),S('#divTableLayout').fadeOut(300,function(){S('#divTableDesign').fadeIn(0)})}),S('#tabTableLayout').unbind('click'),S('#tabTableLayout').bind('click',function(){S('#tabTableDesign').removeClass('active'),S('#tabTableLayout').addClass('active'),S('#divTableDesign').fadeOut(0,function(){S('#divTableLayout').fadeIn(300)})}),S('#inpCellBgColor').colorPicker({dark:'#222',light:'#DDD',renderCallback:function(Y,ee){if(!0===ee);else if(!1===ee);else{if(!N)return;var te=S('#inpCellBgColor').val();restoreSelection(K);var ae=S('#selTableApplyTo').val(),ie=N.parents('table').first()[0],oe=N.parents('tr').first()[0],ne=N[0];'currentcell'==ae&&N.css('background-color',te);for(var se=0,le;se<ie.rows.length;se++){le=ie.rows[se];for(var de=0,ce;de<le.cells.length;de++)ce=le.cells[de],'table'==ae&&S(ce).css('background-color',te),'evenrows'==ae&&isEven(se+1)&&S(ce).css('background-color',te),'oddrows'!=ae||isEven(se+1)||S(ce).css('background-color',te),'currentrow'==ae&&le==N.parents('tr').first()[0]&&S(ce).css('background-color',te),'currentcol'==ae&&de==getCellIndex(ie,oe,ne)&&S(ce).css('background-color',te)}W.data('contenteditor').settings.hasChanged=!0}}}),S('#inpCellBgColor').unbind('blur'),S('#inpCellBgColor').on('blur',function(){if(N){restoreSelection(K);var Y=S('#inpCellBgColor').val(),ee=S('#selTableApplyTo').val(),te=N.parents('table').first()[0],ae=N.parents('tr').first()[0],ie=N[0];'currentcell'==ee&&N.css('background-color',Y);for(var oe=0,ne;oe<te.rows.length;oe++){ne=te.rows[oe];for(var se=0,le;se<ne.cells.length;se++)le=ne.cells[se],'table'==ee&&S(le).css('background-color',Y),'evenrows'==ee&&isEven(oe+1)&&S(le).css('background-color',Y),'oddrows'!=ee||isEven(oe+1)||S(le).css('background-color',Y),'currentrow'==ee&&ne==N.parents('tr').first()[0]&&S(le).css('background-color',Y),'currentcol'==ee&&se==getCellIndex(te,ae,ie)&&S(le).css('background-color',Y)}W.data('contenteditor').settings.hasChanged=!0,saveForUndo()}}),S('#inpCellTextColor').colorPicker({dark:'#222',light:'#DDD',renderCallback:function(Y,ee){if(!0===ee);else if(!1===ee);else{if(!N)return;var te=S('#inpCellTextColor').val();restoreSelection(K);var ae=S('#selTableApplyTo').val(),ie=N.parents('table').first()[0],oe=N.parents('tr').first()[0],ne=N[0];'currentcell'==ae&&N.css('color',te);for(var se=0,le;se<ie.rows.length;se++){le=ie.rows[se];for(var de=0,ce;de<le.cells.length;de++)ce=le.cells[de],'table'==ae&&S(ce).css('color',te),'evenrows'==ae&&isEven(se+1)&&S(ce).css('color',te),'oddrows'!=ae||isEven(se+1)||S(ce).css('color',te),'currentrow'==ae&&le==N.parents('tr').first()[0]&&S(ce).css('color',te),'currentcol'==ae&&de==getCellIndex(ie,oe,ne)&&S(ce).css('color',te)}W.data('contenteditor').settings.hasChanged=!0}}}),S('#inpCellTextColor').unbind('blur'),S('#inpCellTextColor').on('blur',function(){if(N){restoreSelection(K);var Y=S('#inpCellTextColor').val(),ee=S('#selTableApplyTo').val(),te=N.parents('table').first()[0],ae=N.parents('tr').first()[0],ie=N[0];'currentcell'==ee&&N.css('color',Y);for(var oe=0,ne;oe<te.rows.length;oe++){ne=te.rows[oe];for(var se=0,le;se<ne.cells.length;se++)le=ne.cells[se],'table'==ee&&S(le).css('color',Y),'evenrows'==ee&&isEven(oe+1)&&S(le).css('color',Y),'oddrows'!=ee||isEven(oe+1)||S(le).css('color',Y),'currentrow'==ee&&ne==N.parents('tr').first()[0]&&S(le).css('color',Y),'currentcol'==ee&&se==getCellIndex(te,ae,ie)&&S(le).css('color',Y)}W.data('contenteditor').settings.hasChanged=!0,saveForUndo()}}),S('#inpCellBorderColor').colorPicker({dark:'#222',light:'#DDD',renderCallback:function(Y,ee){if(!0===ee);else if(!1===ee);else{if(!N)return;var te=S('#inpCellBorderColor').val(),ae=S('#selCellBorderWidth').val();'0'==ae&&(S('#selCellBorderWidth').val(1),ae=1),restoreSelection(K);var ie=S('#selTableApplyTo').val(),oe=N.parents('table').first()[0],ne=N.parents('tr').first()[0],se=N[0];'currentcell'==ie&&(N.css('border-color',te),N.css('border-width',ae+'px'),N.css('border-style','solid'));for(var le=0,de;le<oe.rows.length;le++){de=oe.rows[le];for(var ce=0,pe;ce<de.cells.length;ce++)pe=de.cells[ce],'table'==ie&&(S(pe).css('border-color',te),S(pe).css('border-width',ae+'px'),S(pe).css('border-style','solid')),'evenrows'==ie&&isEven(le+1)&&(S(pe).css('border-color',te),S(pe).css('border-width',ae+'px'),S(pe).css('border-style','solid')),'oddrows'!=ie||isEven(le+1)||(S(pe).css('border-color',te),S(pe).css('border-width',ae+'px'),S(pe).css('border-style','solid')),'currentrow'==ie&&de==N.parents('tr').first()[0]&&(S(pe).css('border-color',te),S(pe).css('border-width',ae+'px'),S(pe).css('border-style','solid')),'currentcol'==ie&&ce==getCellIndex(oe,ne,se)&&(S(pe).css('border-color',te),S(pe).css('border-width',ae+'px'),S(pe).css('border-style','solid'))}W.data('contenteditor').settings.hasChanged=!0}}}),S('#inpCellBorderColor').unbind('blur'),S('#inpCellBorderColor').on('blur',function(){if(N){restoreSelection(K);var Y=S('#inpCellBorderColor').val(),ee=S('#selCellBorderWidth').val(),te=S('#selTableApplyTo').val(),ae=N.parents('table').first()[0],ie=N.parents('tr').first()[0],oe=N[0];'currentcell'==te&&(N.css('border-color',Y),N.css('border-width',ee+'px'),N.css('border-style','solid'),''==Y&&(N.css('border-color',''),N.css('border-width',''),N.css('border-style',''),S('#selCellBorderWidth').val(0)));for(var ne=0,se;ne<ae.rows.length;ne++){se=ae.rows[ne];for(var le=0,de;le<se.cells.length;le++)de=se.cells[le],'table'==te&&(S(de).css('border-color',Y),S(de).css('border-width',ee+'px'),S(de).css('border-style','solid'),''==Y&&(S(de).css('border-color',''),S(de).css('border-width',''),S(de).css('border-style',''),S('#selCellBorderWidth').val(0))),'evenrows'==te&&isEven(ne+1)&&(S(de).css('border-color',Y),S(de).css('border-width',ee+'px'),S(de).css('border-style','solid'),''==Y&&(S(de).css('border-color',''),S(de).css('border-width',''),S(de).css('border-style',''),S('#selCellBorderWidth').val(0))),'oddrows'!=te||isEven(ne+1)||(S(de).css('border-color',Y),S(de).css('border-width',ee+'px'),S(de).css('border-style','solid'),''==Y&&(S(de).css('border-color',''),S(de).css('border-width',''),S(de).css('border-style',''),S('#selCellBorderWidth').val(0))),'currentrow'==te&&se==N.parents('tr').first()[0]&&(S(de).css('border-color',Y),S(de).css('border-width',ee+'px'),S(de).css('border-style','solid'),''==Y&&(S(de).css('border-color',''),S(de).css('border-width',''),S(de).css('border-style',''),S('#selCellBorderWidth').val(0))),'currentcol'==te&&le==getCellIndex(ae,ie,oe)&&(S(de).css('border-color',Y),S(de).css('border-width',ee+'px'),S(de).css('border-style','solid'),''==Y&&(S(de).css('border-color',''),S(de).css('border-width',''),S(de).css('border-style',''),S('#selCellBorderWidth').val(0)))}W.data('contenteditor').settings.hasChanged=!0,saveForUndo()}}),S('#selCellBorderWidth').unbind('change'),S('#selCellBorderWidth').on('change',function(){if(N){var Y=S('#selCellBorderWidth').val(),ee=S('#inpCellBorderColor').val();''==ee&&(S('#inpCellBorderColor').val('rgb(0, 0, 0)'),S('#inpCellBorderColor').css('background-color','rgb(0, 0, 0)'),S('#inpCellBorderColor').css('color','#ddd'),ee='rgb(0, 0, 0)'),restoreSelection(K);var te=S('#selTableApplyTo').val(),ae=N.parents('table').first()[0],ie=N.parents('tr').first()[0],oe=N[0];'currentcell'==te&&(N.css('border-width',Y+'px'),N.css('border-style','solid'),N.css('border-color',ee),'0'==Y&&(N.css('border-width',''),N.css('border-style',''),N.css('border-color',''),S('#inpCellBorderColor').val(''),S('#inpCellBorderColor').css('background-color','')));for(var ne=0,se;ne<ae.rows.length;ne++){se=ae.rows[ne];for(var le=0,de;le<se.cells.length;le++)de=se.cells[le],'table'==te&&(S(de).css('border-width',Y+'px'),S(de).css('border-style','solid'),S(de).css('border-color',ee),'0'==Y&&(S(de).css('border-width',''),S(de).css('border-style',''),S(de).css('border-color',''),S('#inpCellBorderColor').val(''),S('#inpCellBorderColor').css('background-color',''))),'evenrows'==te&&isEven(ne+1)&&(S(de).css('border-width',Y+'px'),S(de).css('border-style','solid'),S(de).css('border-color',ee),'0'==Y&&(S(de).css('border-width',''),S(de).css('border-style',''),S(de).css('border-color',''),S('#inpCellBorderColor').val(''),S('#inpCellBorderColor').css('background-color',''))),'oddrows'!=te||isEven(ne+1)||(S(de).css('border-width',Y+'px'),S(de).css('border-style','solid'),S(de).css('border-color',ee),'0'==Y&&(S(de).css('border-width',''),S(de).css('border-style',''),S(de).css('border-color',''),S('#inpCellBorderColor').val(''),S('#inpCellBorderColor').css('background-color',''))),'currentrow'==te&&se==N.parents('tr').first()[0]&&(S(de).css('border-width',Y+'px'),S(de).css('border-style','solid'),S(de).css('border-color',ee),'0'==Y&&(S(de).css('border-width',''),S(de).css('border-style',''),S(de).css('border-color',''),S('#inpCellBorderColor').val(''),S('#inpCellBorderColor').css('background-color',''))),'currentcol'==te&&le==getCellIndex(ae,ie,oe)&&(S(de).css('border-width',Y+'px'),S(de).css('border-style','solid'),S(de).css('border-color',ee),'0'==Y&&(S(de).css('border-width',''),S(de).css('border-style',''),S(de).css('border-color',''),S('#inpCellBorderColor').val(''),S('#inpCellBorderColor').css('background-color','')))}W.data('contenteditor').settings.hasChanged=!0,saveForUndo()}}),S('[data-rte-cmd="rowabove"]').unbind('click'),S('[data-rte-cmd="rowabove"]').click(function(){if(N){for(var ee=N.parents('table').first()[0],te=N.parents('tr').first()[0],ae=ee.insertRow(te.rowIndex),ie=0,oe;ie<te.cells.length;ie++)oe=ae.insertCell(ae.cells.length),S(oe).attr('style',N.attr('style')),S(oe).attr('valign','top'),S(oe).html('<br>');W.data('contenteditor').settings.hasChanged=!0,saveForUndo()}}),S('[data-rte-cmd="rowbelow"]').unbind('click'),S('[data-rte-cmd="rowbelow"]').click(function(){if(N){for(var ee=N.parents('table').first()[0],te=N.parents('tr').first()[0],ae=ee.insertRow(te.rowIndex+1),ie=0,oe;ie<te.cells.length;ie++)oe=ae.insertCell(ae.cells.length),S(oe).attr('style',N.attr('style')),S(oe).attr('valign','top'),S(oe).html('<br>');W.data('contenteditor').settings.hasChanged=!0,saveForUndo()}}),S('[data-rte-cmd="columnleft"]').unbind('click'),S('[data-rte-cmd="columnleft"]').click(function(){if(N){for(var ee=N.parents('table').first()[0],te=N.parents('tr').first()[0],ae=N[0],ie=ae.cellIndex,oe=0;oe<ee.rows.length;oe++){var ne=ee.rows[oe],se=ne.insertCell(ie);S(se).attr('style',N.attr('style')),S(se).attr('valign','top'),S(se).html('<br>')}W.data('contenteditor').settings.hasChanged=!0,saveForUndo()}}),S('[data-rte-cmd="columnright"]').unbind('click'),S('[data-rte-cmd="columnright"]').click(function(){if(N){for(var ee=N.parents('table').first()[0],te=N.parents('tr').first()[0],ae=N[0],ie=ae.cellIndex,oe=0;oe<ee.rows.length;oe++){var ne=ee.rows[oe],se=ne.insertCell(ie+1);S(se).attr('style',N.attr('style')),S(se).attr('valign','top'),S(se).html('<br>')}W.data('contenteditor').settings.hasChanged=!0,saveForUndo()}}),S('[data-rte-cmd="delrow"]').unbind('click'),S('[data-rte-cmd="delrow"]').click(function(){if(N){var ee=N.parents('table').first()[0],te=N.parents('tr').first()[0];ee.deleteRow(te.rowIndex),N=null,0==ee.rows.length&&(ee.parentNode.removeChild(ee),S('#divRteTable').stop(!0,!0).fadeOut(0),S('#md-edittable').data('simplemodal')&&S('#md-edittable').data('simplemodal').hide()),W.data('contenteditor').settings.hasChanged=!0,saveForUndo()}}),S('[data-rte-cmd="delcolumn"]').unbind('click'),S('[data-rte-cmd="delcolumn"]').click(function(){if(N){for(var ee=N.parents('table').first()[0],te=N.parents('tr').first()[0],ae=N[0],ie=ae.cellIndex,oe=0;oe<ee.rows.length;oe++)ee.rows[oe].deleteCell(ie);N=null,0==ee.rows[0].cells.length&&(ee.parentNode.removeChild(ee),S('#divRteTable').stop(!0,!0).fadeOut(0),S('#md-edittable').data('simplemodal')&&S('#md-edittable').data('simplemodal').hide()),W.data('contenteditor').settings.hasChanged=!0,saveForUndo()}}),S('[data-rte-cmd="mergecell"]').unbind('click'),S('[data-rte-cmd="mergecell"]').click(function(){if(N){var ee=N.parents('table').first()[0],te=N.parents('tr').first()[0],ae=N[0];++ae.colSpan,ae.cellIndex+1<ee.rows[te.rowIndex].cells.length&&ee.rows[te.rowIndex].deleteCell(ae.cellIndex+1),W.data('contenteditor').settings.hasChanged=!0,saveForUndo()}})}),S('[data-rte-cmd="align"]').unbind('click'),S('[data-rte-cmd="align"]').click(function(X){var K=saveSelection(),Y=S(this).offset().top-S(window).scrollTop(),ee=S(this).offset().left;S('#rte-toolbar').hasClass('rte-side')?(S('#pop-align').addClass('rte-side'),S('#rte-toolbar').hasClass('right')?ee-=58:ee+=57):Y+=51,S('#pop-align').css('position','fixed'),S('#pop-align').css('top',Y+'px'),S('#pop-align').css('left',ee+'px'),W.data('contenteditor').closePop(),S('#pop-align').css('display','block'),S(this).addClass('on'),X.preventDefault(),S('.md-pickalign').unbind('click'),S('.md-pickalign').click(function(){restoreSelection(K);var te=S(this).data('align');'left'==te&&document.execCommand('JustifyLeft',!1,null),'right'==te&&document.execCommand('JustifyRight',!1,null),'center'==te&&document.execCommand('JustifyCenter',!1,null),'justify'==te&&document.execCommand('JustifyFull',!1,null);var ae,ie;window.getSelection?(ie=window.getSelection().getRangeAt(0).commonAncestorContainer,ae=3==ie.nodeType?ie.parentNode:ie):document.selection&&(ie=document.selection.createRange(),ae=document.selection.createRange().parentElement()),'left'==te&&$(ae).find('img').css('margin-left','0px').css('margin-right','auto'),'right'==te&&$(ae).find('img').css('margin-left','auto').css('margin-right','0px'),'center'==te&&$(ae).find('img').css('margin-left','auto').css('margin-right','auto'),'justify'==te&&$(ae).find('img').css('margin-left','0px').css('margin-right','auto'),W.data('contenteditor').getState(),W.data('contenteditor').settings.hasChanged=!0,X.preventDefault(),saveForUndo()})}),S('[data-rte-cmd="list"]').unbind('click'),S('[data-rte-cmd="list"]').click(function(X){var K=saveSelection(),Y=S(this).offset().top-S(window).scrollTop(),ee=S(this).offset().left;S('#rte-toolbar').hasClass('rte-side')?(S('#pop-list').addClass('rte-side'),S('#rte-toolbar').hasClass('right')?ee-=58:ee+=57):Y+=51,S('#pop-list').css('position','fixed'),S('#pop-list').css('top',Y+'px'),S('#pop-list').css('left',ee+'px'),W.data('contenteditor').closePop(),S('#pop-list').css('display','block'),S(this).addClass('on'),X.preventDefault(),S('.md-picklist').unbind('click'),S('.md-picklist').click(function(){restoreSelection(K);var te=S(this).data('list');try{if('normal'==te)document.execCommand('outdent',!1,null),document.execCommand('outdent',!1,null),document.execCommand('outdent',!1,null);else{document.execCommand(te,!1,null);var ae;window.getSelection?(ae=window.getSelection().getRangeAt(0).commonAncestorContainer.parentNode,ae=ae.parentNode):document.selection&&(ae=document.selection.createRange().parentElement(),ae=ae.parentElement()),('UL'==ae.nodeName||'OL'==ae.nodeName)&&'p'==S(ae).parent().prop('tagName').toLowerCase()&&(ae.setAttribute('contenteditable',!0),S(ae).parent().replaceWith(function(){return this.innerHTML}))}}catch(ie){R.parents('div').addClass('edit');var ae;window.getSelection?(ae=window.getSelection().getRangeAt(0).commonAncestorContainer.parentNode,ae=ae.parentNode):document.selection&&(ae=document.selection.createRange().parentElement(),ae=ae.parentElement()),ae.setAttribute('contenteditable',!0),'normal'==te?(document.execCommand('outdent',!1,null),document.execCommand('outdent',!1,null),document.execCommand('outdent',!1,null)):document.execCommand(te,!1,null),ae.removeAttribute('contenteditable'),W.data('contenteditor').render()}W.data('contenteditor').getState(),W.data('contenteditor').settings.hasChanged=!0,X.preventDefault(),saveForUndo()})}),S('[data-rte-cmd="createLink"]').unbind('click'),S('[data-rte-cmd="createLink"]').click(function(X){S('#divBorderStyle').hide(),S('#divButtonAlign').hide();var K='';if('undefined'!=typeof window.getSelection){var Y=window.getSelection();if(Y.rangeCount){for(var ee=document.createElement('div'),te=0,ae=Y.rangeCount;te<ae;++te)ee.appendChild(Y.getRangeAt(te).cloneContents());K=ee.innerHTML}}else'undefined'!=typeof document.selection&&'Text'==document.selection.type&&(K=document.selection.createRange().htmlText);if(''==K){for(var ie=window.getSelection(),oe=ie.getRangeAt(0),ne=ie.anchorNode;0!==oe.startOffset;)if(oe.setStart(ne,oe.startOffset-1),0===oe.toString().search(/\s/)){oe.setStart(ne,oe.startOffset+1);break}for(;oe.endOffset<ne.length;)if(oe.setEnd(ne,oe.endOffset+1),-1!==oe.toString().search(/\s/)){oe.setEnd(ne,oe.endOffset-1);break}selectRange(oe)}var se;window.getSelection?se=window.getSelection().getRangeAt(0).commonAncestorContainer:document.selection&&(se=document.selection.createRange()),'a'==se.nodeName.toLowerCase()?L=S(se):(document.execCommand('createLink',!1,'http://dummy'),L=S('a[href=\'http://dummy\']').first(),L.attr('href','http://')),S('#md-createlink').css('max-width','550px'),S('#md-createlink').simplemodal({noOverlay:!0,onCancel:function(){'http://'==L.attr('href')&&L.replaceWith(L.html())}}),S('#md-createlink').data('simplemodal').show(),W.data('contenteditor').closePop(),S('#txtLink').val(L.attr('href')),S('#txtLinkText').val(L.html()),S('#txtLinkTitle').val(L.attr('title')),'_blank'==L.attr('target')?S('#chkNewWindow').prop('checked',!0):S('#chkNewWindow').prop('checked',!1),S('#btnLinkOk').unbind('click'),S('#btnLinkOk').bind('click',function(){L.attr('href',S('#txtLink').val()),L.closest('table.button').length&&('1'==S('#selectBorderStyle').val()?L.closest('table.button').removeClass('rounded').removeClass('radius'):'2'==S('#selectBorderStyle').val()?L.closest('table.button').removeClass('rounded').addClass('radius'):'3'==S('#selectBorderStyle').val()&&L.closest('table.button').addClass('rounded').removeClass('radius')),L.closest('table.button').length&&('1'==S('#selectButtonAlign').val()?L.closest('table.button').removeClass('float-center').removeClass('float-right').removeClass('expand').addClass('float-left').attr('align','left').css('width','auto'):'2'==S('#selectButtonAlign').val()?L.closest('table.button').removeClass('float-center').removeClass('float-left').removeClass('expand').addClass('float-right').attr('align','right').css('width','auto'):'3'==S('#selectButtonAlign').val()?L.closest('table.button').removeClass('float-right').removeClass('float-left').removeClass('expand').addClass('float-center').attr('align','center').css('width','auto'):'4'==S('#selectButtonAlign').val()&&L.closest('table.button').removeClass('float-center').removeClass('float-right').removeClass('float-left').addClass('expand').attr('align','center').css('width','100%')),('http://'==S('#txtLink').val()||''==S('#txtLink').val())&&L.replaceWith(L.html()),L.html(S('#txtLinkText').val()),L.attr('title',S('#txtLinkTitle').val()),S('#chkNewWindow').is(':checked')?L.attr('target','_blank'):L.removeAttr('target'),S('#md-createlink').data('simplemodal').hide();for(var de=0;de<instances.length;de++)S(instances[de]).data('contenteditor').settings.hasChanged=!0,S(instances[de]).data('contenteditor').render();saveForUndo()}),X.preventDefault()}),S('[data-rte-cmd="icon"]').unbind('click'),S('[data-rte-cmd="icon"]').click(function(X){$savedSel=saveSelection(),$activeIcon=null;var K=W.data('contenteditor').settings.iconselect;return-1!=S('#ifrIconSelect').attr('src').indexOf('blank.html')&&S('#ifrIconSelect').attr('src',K),S('#md-icon-select').css('max-width','775px'),S('#md-icon-select').simplemodal({noOverlay:!0}),S('#md-icon-select').data('simplemodal').show($savedSel),W.data('contenteditor').closePop(),void X.preventDefault()}),S('[data-rte-cmd="tags"]').unbind('click'),S('[data-rte-cmd="tags"]').click(function(X){S('#md-tags-select').css('max-width','260px'),S('#md-tags-select').simplemodal({noOverlay:!0}),S('#md-tags-select').data('simplemodal').show(savedSel),W.data('contenteditor').closePop();for(var K='',Y=0;Y<W.data('contenteditor').settings.customTags.length;Y++)K+='<button class="md-pick-tag" style="width:100%" data-value="'+W.data('contenteditor').settings.customTags[Y][1]+'"> '+W.data('contenteditor').settings.customTags[Y][0]+' </button>';return S('#divCustomTags').html(K),S('.md-pick-tag').unbind('click'),S('.md-pick-tag').click(function(){var ee=S(this).data('value');pasteHtmlAtCaret(ee,!0),S('#md-tags-select').data('simplemodal').hide(),saveForUndo()}),void X.preventDefault()}),W.find('.embed-responsive').unbind('hover'),W.find('.embed-responsive').hover(function(){if(!(0<S(this).parents('[data-html]').length)&&!(0<S(this).parents('[data-mode=\'readonly\']').length)&&!(0<S(this).parents('[data-mode=\'readonly-protected\']').length)){var K=localStorage.zoom;'normal'==K&&(K=1),void 0==K&&(K=1),K+='',-1!=K.indexOf('%')&&(K=K.replace('%','')/100),'NaN'==K&&(K=1),K*=1;var te=S(window).scrollTop(),ae=S(this).offset().top,ie=S(this).offset().left,oe=-1<navigator.userAgent.toLowerCase().indexOf('firefox'),ne=detectIE(),se=!0,Y,ee;if((oe||ne)&&(se=!1),se)Y=(ae-20)*K+(te-te*K),ee=ie*K;else{if(ne){var le=W.getPos().top,de=-le/1.1*K+le/1.1,ce=W.getPos().left,pe=-ce*K+ce,me=S(this).getPos();Y=(me.top-20)*K+de,ee=me.left*K+pe}oe&&(Y=ae-20,ee=ie)}S('#divFrameLink').css('top',Y+'px'),S('#divFrameLink').css('left',ee+'px'),S('#divFrameLink').stop(!0,!0).css({display:'none'}).fadeIn(20),O=S(this).find('iframe'),S('#divFrameLink').unbind('click'),S('#divFrameLink').bind('click',function(){var ue=O.attr('src'),be=/^.*\/\/www.youtube.com\/embed\//,he=/^.*\/\/player.vimeo.com\/video\//;null!=be.exec(ue)||null!=he.exec(ue)?(S('#md-createiframe').data('simplemodal')&&S('#md-createiframe').data('simplemodal').hide(),S('#md-createsrc').css('max-width','550px'),S('#md-createsrc').simplemodal({noOverlay:!0}),S('#md-createsrc').data('simplemodal').show(),W.data('contenteditor').closePop(),S('#txtSrc').val(O.attr('src')),S('#btnSrcOk').unbind('click'),S('#btnSrcOk').bind('click',function(){var ve=S('#txtSrc').val(),Ce=/^http[s]?:\/\/(((www.youtube.com\/watch\?(feature=player_detailpage&)?)v=)|(youtu.be\/))([^#\&\?]*)/,ye=/^.*(vimeo\.com\/)((channels\/[A-z]+\/)|(groups\/[A-z]+\/videos\/)|(video\/))?([0-9]+)\/?/,xe=Ce.exec(ve),ke=ye.exec(ve);if(null!=xe||null!=ke){if(null!=xe&&7<=xe.length){var we=xe[6];ve='//www.youtube.com/embed/'+we+'?rel=0'}if(null!=ke&&7<=ke.length){var Se=ke[6];ve='//player.vimeo.com/video/'+Se}}O.attr('src',ve),''==S('#txtSrc').val()&&O.attr('src',''),S('#md-createsrc').data('simplemodal').hide();for(var Ie=0;Ie<instances.length;Ie++)S(instances[Ie]).data('contenteditor').settings.hasChanged=!0,S(instances[Ie]).data('contenteditor').render()})):(S('#md-createsrc').data('simplemodal')&&S('#md-createsrc').data('simplemodal').hide(),S('#md-createiframe').css('max-width','550px'),S('#md-createiframe').simplemodal({noOverlay:!0}),S('#md-createiframe').data('simplemodal').show(),W.data('contenteditor').closePop(),S('#txtIframe').val(O[0].outerHTML),S('#btnIframeOk').unbind('click'),S('#btnIframeOk').bind('click',function(){var ve=S('#txtIframe').val();''!=ve&&O.replaceWith(ve),S('#md-createiframe').data('simplemodal').hide();for(var Ce=0;Ce<instances.length;Ce++)S(instances[Ce]).data('contenteditor').settings.hasChanged=!0,S(instances[Ce]).data('contenteditor').render()})),saveForUndo()}),S('#divFrameLink').hover(function(){S(this).stop(!0,!0).css('display','block')},function(){S(this).stop(!0,!0).fadeOut(0)})}},function(){S('#divFrameLink').stop(!0,!0).fadeOut(0)}),W.find('a').not('.not-a').unbind('hover'),W.find('a').not('.not-a').hover(function(){if('block'!=S('#md-createlink').css('display')&&!(0<S(this).parents('[data-html]').length)&&!(0<S(this).parents('[data-mode=\'readonly\']').length)&&!(0<S(this).parents('[data-mode=\'readonly-protected\']').length)&&(1!=S(this).children('img').length||1!=S(this).children().length)){var K=localStorage.zoom;'normal'==K&&(K=1),void 0==K&&(K=1),K+='',-1!=K.indexOf('%')&&(K=K.replace('%','')/100),'NaN'==K&&(K=1),K*=1;var te=S(window).scrollTop(),ae=S(this).offset().top,ie=S(this).offset().left,oe=-1<navigator.userAgent.toLowerCase().indexOf('firefox'),ne=detectIE(),se=!0,Y,ee;if((oe||ne)&&(se=!1),se)Y=(ae-27)*K+(te-te*K),ee=ie*K;else{if(ne){var le=W.getPos().top,de=-le/1.1*K+le/1.1,ce=W.getPos().left,pe=-ce*K+ce,me=S(this).getPos();Y=(me.top-25)*K+de,ee=me.left*K+pe}oe&&(Y=ae-25,ee=ie)}S('#divRteLink').css('top',Y+'px'),S('#divRteLink').css('left',ee+'px'),S('#divRteLink').stop(!0,!0).css({display:'none'}).fadeIn(20),L=S(this),S('#divRteLink').unbind('click'),S('#divRteLink').bind('click',function(){S('#md-createlink').css('max-width','550px'),S('#md-createlink').simplemodal({noOverlay:!0,onCancel:function(){'http://'==L.attr('href')&&L.replaceWith(L.html())}}),S('#md-createlink').data('simplemodal').show(),W.data('contenteditor').closePop(),S('#txtLink').val(L.attr('href')),S('#txtLinkText').val(L.html()),S('#txtLinkTitle').val(L.attr('title')),'_blank'==L.attr('target')?S('#chkNewWindow').prop('checked',!0):S('#chkNewWindow').prop('checked',!1),L.closest('table.button').length?(S('#divBorderStyle').show(),L.closest('table.button').is('.radius')?S('#selectBorderStyle').val('2'):L.closest('table.button').is('.rounded')?S('#selectBorderStyle').val('3'):S('#selectBorderStyle').val('1')):(S('#divBorderStyle').hide(),S('#selectBorderStyle').val('1')),L.closest('table.button').length?(S('#divButtonAlign').show(),L.closest('table.button').is('.float-right')?S('#selectButtonAlign').val('2'):L.closest('table.button').is('.float-center')?S('#selectButtonAlign').val('3'):L.closest('table.button').is('.expand')?S('#selectButtonAlign').val('4'):S('#selectButtonAlign').val('1')):(S('#divButtonAlign').hide(),S('#selectButtonAlign').val('1')),S('#btnLinkOk').unbind('click'),S('#btnLinkOk').bind('click',function(){L.attr('href',S('#txtLink').val()),L.closest('table.button').length&&('1'==S('#selectBorderStyle').val()?L.closest('table.button').removeClass('rounded').removeClass('radius'):'2'==S('#selectBorderStyle').val()?L.closest('table.button').removeClass('rounded').addClass('radius'):'3'==S('#selectBorderStyle').val()&&L.closest('table.button').addClass('rounded').removeClass('radius')),L.closest('table.button').length&&('1'==S('#selectButtonAlign').val()?L.closest('table.button').removeClass('float-center').removeClass('float-right').removeClass('expand').addClass('float-left').attr('align','left').css('width','auto'):'2'==S('#selectButtonAlign').val()?L.closest('table.button').removeClass('float-center').removeClass('float-left').removeClass('expand').addClass('float-right').attr('align','right').css('width','auto'):'3'==S('#selectButtonAlign').val()?L.closest('table.button').removeClass('float-right').removeClass('float-left').removeClass('expand').addClass('float-center').attr('align','center').css('width','auto'):'4'==S('#selectButtonAlign').val()&&L.closest('table.button').removeClass('float-center').removeClass('float-right').removeClass('float-left').addClass('expand').attr('align','center').css('width','100%')),('http://'==S('#txtLink').val()||''==S('#txtLink').val())&&L.replaceWith(L.html()),L.html(S('#txtLinkText').val()),L.attr('title',S('#txtLinkTitle').val()),S('#chkNewWindow').is(':checked')?L.attr('target','_blank'):L.removeAttr('target'),S('#md-createlink').data('simplemodal').hide();for(var be=0;be<instances.length;be++)S(instances[be]).data('contenteditor').settings.hasChanged=!0,S(instances[be]).data('contenteditor').render();saveForUndo()})}),S('#divRteLink').hover(function(){S(this).stop(!0,!0).css('display','block')},function(){S(this).stop(!0,!0).fadeOut(0)})}},function(){S('#divRteLink').stop(!0,!0).fadeOut(0)}),S('#btnLinkBrowse').unbind('click'),S('#btnLinkBrowse').bind('click',function(){S('#divToolImg').stop(!0,!0).fadeOut(0),S('#divToolImgSettings').stop(!0,!0).fadeOut(0),S('#divRteLink').stop(!0,!0).fadeOut(0),S('#divFrameLink').stop(!0,!0).fadeOut(0);var K=(W.data('contenteditor').settings.onFileSelectClick+'').replace(/\s/g,'');'function(){}'==K?(S('#ifrFileBrowse').attr('src',W.data('contenteditor').settings.fileselect),S('#active-input').val('txtLink'),S('#md-fileselect').css('width','65%'),S('#md-fileselect').simplemodal(),S('#md-fileselect').data('simplemodal').show(),W.data('contenteditor').closePop()):W.data('contenteditor').settings.onFileSelectClick({targetInput:S('#txtLink').get(0),theTrigger:S('#btnLinkBrowse').get(0)})}),W.data('contenteditor').settings.onRender(),W.data('contenteditor').contentRender()},this.prepareRteCommand=function(_){S('[data-rte-cmd="'+_+'"]').unbind('click'),S('[data-rte-cmd="'+_+'"]').click(function(Z){try{document.execCommand(_,!1,null)}catch(V){W.attr('contenteditable',!0),document.execCommand(_,!1,null),W.removeAttr('contenteditable'),W.data('contenteditor').render()}W.data('contenteditor').getState(),W.data('contenteditor').settings.hasChanged=!0,Z.preventDefault()})},this.applyColor=function(_,Z){var V,Q;window.getSelection?(Q=window.getSelection().getRangeAt(0).commonAncestorContainer,V=3==Q.nodeType?Q.parentNode:Q):document.selection&&(Q=document.selection.createRange(),V=document.selection.createRange().parentElement());var X=S('#selColorApplyTo').val();if(''!=S.trim(Z)&&S(V).text()!=Z){1==X&&document.execCommand('ForeColor',!1,_),2==X&&document.execCommand('BackColor',!1,_);for(var K=document.getElementsByTagName('font'),Y=0,ee=K.length,_;Y<ee;++Y)_=K[Y].color,''!=_&&(K[Y].removeAttribute('color'),K[Y].style.color=_);var te=detectIE();te&&R.find('span').each(function(){if(1==S(this).find('span').length&&S(this).text()==S(this).find('span:first').text()){var ae=S(this).find('span:first').attr('style');S(this).html(S(this).find('span:first').html());var ie=S(this).attr('style')+';'+ae;S(this).attr('style',ie)}})}else S(V).text()==Z?(1==X&&(S(V).html()?S(V).css('color',_):S(V).parent().css('color',_)),2==X&&(S(V).html()?S(V).css('background-color',_):S(V).parent().css('background-color',_))):(1==X&&S(V).css('color',_),2==X&&(S(V).closest('table.button').length?S(V).parent().css('background-color',_):S(V).css('background-color',_)));3==X&&S(V).parents('.ui-draggable').children().first().children().first().css('background-color',_),4==X&&S('html,#main').css('background-color',_),5==X&&S('#contentarea').css('border-color',_).css('border-width','3px').css('border-style','solid')},this.init()},S.fn.contenteditor=function(P){return this.each(function(){if(instances.push(this),void 0==S(this).data('contenteditor')){var M=new S.contenteditor(this,P);S(this).data('contenteditor',M)}})}})(jQuery);function pasteContent(S){var T=saveSelection();jQuery('#idContentWord').remove();var L=S.offset().top;jQuery('#divCb').append('<div style=\'position:absolute;z-index:-1000;top:'+L+'px;left:-1000px;width:1px;height:1px;overflow:auto;\' name=\'idContentWord\' id=\'idContentWord\' contenteditable=\'true\'></div>');var R=document.getElementById('idContentWord');R.focus(),setTimeout(function(){try{restoreSelection(T);jQuery(getSelectionStartNode());if(0==jQuery('#idContentWord').length)return;var N='',P=!1;(0<jQuery('#idContentWord table').length||0<jQuery('#idContentWord img').length||0<jQuery('#idContentWord p').length||0<jQuery('#idContentWord a').length)&&(P=!0),P?(N=jQuery('#idContentWord').html(),N=cleanHTML(N),jQuery('#idContentWord').html(N),1<jQuery('#idContentWord').children('p,h1,h2,h3,h4,h5,h6,ul,li').length&&jQuery('#idContentWord').contents().filter(function(){return 3==this.nodeType&&''!=jQuery.trim(this.nodeValue)}).wrap('<p></p>').end().filter('br').remove(),N='<div class="edit">'+jQuery('#idContentWord').html()+'</div>'):(jQuery('#idContentWord').find('p,h1,h2,h3,h4,h5,h6').each(function(){jQuery(this).html(jQuery(this).html()+' ')}),N=jQuery('#idContentWord').text()),jQuery('#idContentWord').remove();var M=window.getSelection(),U=M.getRangeAt(0);U.extractContents(),U.collapse(!0);var W=U.createContextualFragment(N),_=W.lastChild;U.insertNode(W),U.setStartAfter(_),U.setEndAfter(_),U.collapse(!1);var Z=U.commonAncestorContainer;if(Z&&Z.parentNode)try{Z.parentNode.normalize()}catch(V){}M.removeAllRanges(),M.addRange(U)}catch(V){jQuery('#idContentWord').remove()}},200)}var savedSel;function saveSelection(){if(window.getSelection){if(sel=window.getSelection(),sel.getRangeAt&&sel.rangeCount){for(var S=[],T=0,L=sel.rangeCount;T<L;++T)S.push(sel.getRangeAt(T));return S}}else if(document.selection&&document.selection.createRange)return document.selection.createRange();return null}function restoreSelection(S){if(S)if(window.getSelection){sel=window.getSelection(),sel.removeAllRanges();for(var T=0,L=S.length;T<L;++T)sel.addRange(S[T])}else document.selection&&S.select&&S.select()}function getSelectionStartNode(){var S,T;if(window.getSelection&&(T=getSelection(),S=T.anchorNode),!S&&document.selection){T=document.selection;var L=T.getRangeAt?T.getRangeAt(0):T.createRange();S=L.commonAncestorContainer?L.commonAncestorContainer:L.parentElement?L.parentElement():L.item(0)}return S?'#text'==S.nodeName?S.parentNode:S:void 0}var getSelectedNode=function(){var S,T;if(window.getSelection&&(T=getSelection(),S=T.anchorNode),!S&&document.selection){T=document.selection;var L=T.getRangeAt?T.getRangeAt(0):T.createRange();S=L.commonAncestorContainer?L.commonAncestorContainer:L.parentElement?L.parentElement():L.item(0)}return S?'#text'==S.nodeName?S.parentNode:S:void 0};function getSelected(){if(window.getSelection)return window.getSelection();if(document.getSelection)return document.getSelection();var S=document.selection&&document.selection.createRange();return!!S.text&&S.text}function pasteHtmlAtCaret(S,T){var L,R;if(window.getSelection){if(L=window.getSelection(),L.getRangeAt&&L.rangeCount){R=L.getRangeAt(0),R.deleteContents();var O=document.createElement('div');O.innerHTML=S;for(var N=document.createDocumentFragment(),P,M;P=O.firstChild;)M=N.appendChild(P);var U=N.firstChild;R.insertNode(N),M&&(R=R.cloneRange(),R.setStartAfter(M),T?R.setStartBefore(U):R.collapse(!0),L.removeAllRanges(),L.addRange(R))}}else if((L=document.selection)&&'Control'!=L.type){var W=L.createRange();W.collapse(!0),L.createRange().pasteHTML(S),T&&(R=L.createRange(),R.setEndPoint('StartToStart',W),R.select())}}var $savedSel,$activeIcon;function applyIconClass(S){if($activeIcon){var T='';$activeIcon.hasClass('size-12')&&(T='size-12'),$activeIcon.hasClass('size-14')&&(T='size-14'),$activeIcon.hasClass('size-16')&&(T='size-16'),$activeIcon.hasClass('size-18')&&(T='size-18'),$activeIcon.hasClass('size-21')&&(T='size-21'),$activeIcon.hasClass('size-24')&&(T='size-24'),$activeIcon.hasClass('size-32')&&(T='size-32'),$activeIcon.hasClass('size-48')&&(T='size-48'),$activeIcon.hasClass('size-64')&&(T='size-64'),$activeIcon.hasClass('size-80')&&(T='size-80'),$activeIcon.hasClass('size-96')&&(T='size-96'),$activeIcon.css('font-size',''),-1==S.indexOf('size-')&&''!=S?($activeIcon.attr('class',S),''!=T&&$activeIcon.addClass(T)):($activeIcon.removeClass('size-12'),$activeIcon.removeClass('size-14'),$activeIcon.removeClass('size-16'),$activeIcon.removeClass('size-18'),$activeIcon.removeClass('size-21'),$activeIcon.removeClass('size-24'),$activeIcon.removeClass('size-32'),$activeIcon.removeClass('size-48'),$activeIcon.removeClass('size-64'),$activeIcon.removeClass('size-80'),$activeIcon.removeClass('size-96'),$activeIcon.addClass(S))}else{restoreSelection(savedSelPublic);var L=makeid();pasteHtmlAtCaret(' <i id="'+L+'" class="'+S+'"></i> ',!0),$activeIcon=jQuery('#'+L),$activeIcon.removeAttr('id'),jQuery(cb_list).each(function(){jQuery(this).data('contenteditor').contentRender()})}}var $imgActive;(function(S){var T,L,R,O;S.imageembed=function(N,P){var M={hiquality:!1,imageselect:'',fileselect:'',imageEmbed:!0,linkDialog:!0,zoom:0,customval:0,largerImageHandler:'',onChanged:function(){},onImageBrowseClick:function(){},onImageSettingClick:function(){},onImageSelectClick:function(){},onFileSelectClick:function(){}};this.settings={};var U=S(N),N=N;this.init=function(){this.settings=S.extend({},M,P),0==S('#divCb').length&&S('body').append('<div id="divCb"></div>');var Q='',X='';-1==navigator.appName.indexOf('Microsoft')?(Q='<div style="display:none"><input type="file" name="fileImage" id="fileImage" class="my-file"></div>',X='<div id="divToolImg"><i id="lnkEditImage" class="cb-icon-camera"></i></div>'):(Q='<div id="divToolImg"><div class="fileinputs"><input type="file" name="fileImage" id="fileImage" class="my-file" /><div class="fakefile"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAC+klEQVRoQ+2au24aQRSGz+ySkEvPA9AQubNEhXgCSogEShmZGkSQpTS8AjUNSAjXlCRNStpQ8QK8AI6UOLazM5lZvGRvswsz43hYz0iWZe3uzPnOf25rQOVymcAzWsgAZ1xto3DGBQajsFE4Yx4wIZ0xQSM4RmGjcMY8YEI6Y4LKFy0H/9TCJ7b1VsiOo0PaAAv5Wf4ho/CBPjQhneYokRyezWZQKpW4WzuOA71eD5bLZdrx++vahnSz2YRutwu5XC4RZrPZQL1eP33g4XAI1Wo1FeRYlbVQ+FA1U+kfblitVtBut2Nvf3LgQqEAk8kE2G9VC2MM4/EYRqNRZMsnBy4WizCdTiGfz6vidffhqaw98Ha7hU6nA+v1OuCQfr8PLBV46ySB/bAeoL8qJ0GfHLA/D8P9OOmap/jJAXvq1mq12NB1lW404LL/GVqtD5QTPfwwZEJz+DtcXHwEDPf0z3+f+2mbw17oxvZjhIBgGz71LqFSqcQ6xK8wgT+AyZ0L/t+AMflNz3MiNYZXpXkKI2SDhfKw3V67xYwXAdGQJhT6lj77SqgbHP3ywMLMITeB8GIn84C9PJ3P5/s+vYPdGbxYLGAwGABv3k4aPkSIBYAZMg0tfBs4L6kP+yvy7OoKzt6dg3+UTJrQtABmpOHQThs8PGjbeuMrSuDmbdLLhTbAYZXTgJmTEMrBj+sbbs6yPb1KzMIewOJOWiLh7Nog85UH/7vxobO0bb12QYJrV4jCxZA56OuXb26Oq1pSwOGwTgtPz2gLvaRqv9gzOORXpAiyiywN3jdagXtlwaWACbnf9UWBxdRjbWmnLA1l3qK92kYs79UsOeCYaq3GrOAuokNGnC1SwLRWg4NpT37kpREwHUIwzb9HXs8LWKccZsKK/Nv24IBwYdkIGm5jB+8QuVEyh+WA2XDBqjVygfyvheJAaU9KA6cdoNt1A6ybIqrtMQqr9qhu+xmFdVNEtT1GYdUe1W0/o7Buiqi2xyis2qO67WcU1k0R1fb8BZv85KDCNGIQAAAAAElFTkSuQmCC" /></div></div></div>',X='');var K='<div id="divTempContent" style="display:none"></div><div class="overlay-bg" style="position:fixed;top:0;left:0;width:1;height:1;z-index:10000;background:#fff;opacity:0.8"></div><div id="divImageEdit" style="position:absolute;display:none;z-index:10000"><div id="my-mask" style="width:200px;height:200px;overflow:hidden;"><img id="my-image" src="" style="max-width:none" /></div><div id="img-control" style="margin-top:1px;position:absolute;top:-31px;left:0px;width:235px;opacity:0.8"><button id="btnImageCancel" type="button" value="Cancel" ><i class="cb-icon-back"></i></button><button id="btnZoomOut" type="button" value="-" ><i class="cb-icon-minus"></i></button><button id="btnZoomIn" type="button" value="+" ><i class="cb-icon-plus"></i></button><button id="btnImageMore" type="button" value="..." >...</button><button id="btnChangeImage" type="button" value="Ok" ><i class="cb-icon-ok"></i> Ok</button></div><div id="divImageMore" style="display:none"><label for="chkImageNoCrop"><input id="chkImageNoCrop" type="checkbox" />No Crop</label><br>'+(''==this.settings.largerImageHandler?'':'<label for="chkImageClickToEnlarge"><input id="chkImageClickToEnlarge" type="checkbox" />Click to enlarge</label><br>')+'<button id="btnImageMoreOk" type="button" value="Ok" ><i class="cb-icon-ok"></i> Ok</button></div></div><div style="display:none;"><canvas id="myCanvas"></canvas><canvas id="myTmpCanvas"></canvas><canvas id="myTmpCanvasNoCrop"></canvas></div><form id="canvasform" name="canvasform" method="post" action="" target="canvasframe" enctype="multipart/form-data">'+Q+'<input id="hidRefId" name="hidRefId" type="hidden" value="'+this.settings.customval+'" /></form><iframe id="canvasframe" name="canvasframe" style="width:1px;height:1px;border:none;visibility:hidden;position:absolute"></iframe>',Y=!1;''!=this.settings.imageselect&&(Y=!0);var ee=(this.settings.onImageSelectClick+'').replace(/\s/g,'');'function(){}'!=ee&&(Y=!0);var te=!1;''!=this.settings.fileselect&&(te=!0);var ee=(this.settings.onFileSelectClick+'').replace(/\s/g,'');'function(){}'!=ee&&(te=!0);var ae=this.settings.imageEmbed,ie=X+'<div id="divToolImgSettings"><i id="lnkImageSettings" class="cb-icon-link"></i></div><div id="divToolImgLoader"><i id="lnkImageLoader" class="cb-icon-spin animate-spin"></i></div><div class="md-modal md-draggable" id="md-img"><div class="md-content"><div class="md-body"><div class="md-modal-handle"><i class="cb-icon-dot"></i><i class="cb-icon-cancel md-modal-close"></i></div><div class="md-tabs"><span id="tabImgLnk" class="active">IMAGE</span><span id="tabImgPl">CHANGE DIMENSION</span></div><div id="divImgPl" style="overflow-y:auto;overflow-x:hidden;display:none;box-sizing:border-box;padding:10px 10px 10px">';ie+='<div style="padding:12px 0 0;width:100%;text-align:center;">',ie+='DIMENSION (WxH): &nbsp; <select id="selImgW">';for(var oe=50,ne=0,se;231>ne;ne++)se='',90==ne&&(se=' selected="selected"'),ie+='<option value="'+oe+'"'+se+'>'+oe+'px</option>',oe+=5;ie+='</select> &nbsp; ',ie+='<select id="selImgH">';for(var le=50,ne=0,se;111>ne;ne++)se='',40==ne&&(se=' selected="selected"'),ie+='<option value="'+le+'"'+se+'>'+le+'px</option>',le+=5;ie+='</select> &nbsp; ',ie+='<select id="selImgStyle">',ie+='<option value="square">Square</option>',ie+='<option value="circle">Circle</option>',ie+='</select><br>',ie+='<button id="btnInsertPlh" style="margin-left:12px;margin-top:12px;"> REPLACE </button><br>',ie+='<p>(Re-embedding/uploading image needed)</p>',ie+='</div></div><div id="divImgLnk"><div class="md-label">Source:</div>'+(Y?'<input type="text" id="txtImgUrl" class="inptxt" style="float:left;width:60%"></input><i class="cb-icon-link md-btnbrowse" id="btnImageBrowse" style="width:10%;"></i>':'<input type="text" id="txtImgUrl" class="inptxt" style="float:left;width:70%"></input>')+'<br style="clear:both"><div class="md-label">Title:</div><input type="text" id="txtAltText" class="inptxt" style="float:right;width:70%"></input><br style="clear:both"><div class="md-label">Link:</div>'+(te?'<input type="text" id="txtLinkUrl" class="inptxt" style="float:left;width:60%"></input><i class="cb-icon-link md-btnbrowse" id="btnFileBrowse" style="width:10%;"></i>':'<input type="text" id="txtLinkUrl" class="inptxt" style="float:left;width:70%"></input>')+'<br style="clear:both"><div style="display:none;" class="md-label">Target:</div><label style="display:none;float:left;" for="chkNewWindow2" class="inpchk"><input type="checkbox" id="chkNewWindow2"></input> New Window</label><br style="clear:both;display:none;"><div id="divEmbedOriginal"><div class="md-label">&nbsp;</div><label style="float:left;" for="chkCrop" class="inpchk"><input type="checkbox" id="chkCrop"></input> Crop</label><br style="clear:both" /></div></div></div><div id="divImgLnkOk" class="md-footer"><button id="btnImgOk"> Ok </button></div></div></div><div class="md-modal" id="md-imageselect"><div class="md-content"><div class="md-body">'+(Y?'<iframe id="ifrImageBrowse" style="width:100%;height:400px;border: none;display: block;" src="'+sScriptPath+'blank.html"></iframe>':'')+'</div></div></div>',0==S('#md-fileselect').length&&(ie+='<div class="md-modal" id="md-fileselect"><div class="md-content"><div class="md-body">'+(te?'<iframe id="ifrFileBrowse" style="width:100%;height:400px;border: none;display: block;" src="'+sScriptPath+'blank.html"></iframe>':'')+'</div></div></div>'),0==S('#active-input').length&&(ie+='<input type="hidden" id="active-input" />'),0==S('#divToolImg').length&&(S('#divCb').append(K),S('#divCb').append(ie)),T=document.getElementById('myTmpCanvas'),L=document.getElementById('myTmpCanvasNoCrop'),U.hover(function(){var ce;null==localStorage.getItem('zoom')?(ce=U.parents('[style*="zoom"]').css('zoom'),'normal'==ce&&(ce=1),ce==void 0&&(ce=1)):ce=localStorage.zoom;var pe=-1<navigator.userAgent.toLowerCase().indexOf('firefox');ce+='',-1!=ce.indexOf('%')&&(ce=ce.replace('%','')/100),'NaN'==ce&&(ce=1),localStorage.zoom=ce,ce*=1,''==cb_list&&(ce=1),1==U.data('imageembed').settings.zoom&&(ce=1);var me,ge,ue,be=S(window).scrollTop(),he=S(this).offset().top,fe=S(this).offset().left,pe=-1<navigator.userAgent.toLowerCase().indexOf('firefox'),ve=detectIE(),Ce=detectEdge(),ye=!0;(pe||ve||Ce)&&(ye=!1);var xe=S(this).data('imageembed').settings.imageEmbed?-35:9;if(ye)me=(he+parseInt(S(this).css('height'))/2-15)*ce+(be-be*ce),ue=(fe+parseInt(S(this).css('width'))/2-15)*ce,ge=me+xe;else{if(Ce,ve){var ke=0,we=0;U.parents().each(function(){S(this).data('contentbuilder')&&(ke=S(this).getPos().top,we=S(this).getPos().left)});var Se=-ke*ce+ke,Ie=-we*ce+we,Te=S(this).getPos();me=(Te.top-15+parseInt(S(this).css('height'))/2)*ce+Se,ue=(Te.left-15+parseInt(S(this).css('width'))/2)*ce+Ie,ge=me+xe}if(pe){var Le=parseInt(S(this).css('width')),Ae=parseInt(S(this).css('height'));me=he-15+Ae*ce/2,ue=fe-15+Le*ce/2,ge=me+xe}}var Re=!1;$imgActive=S(this),1==$imgActive.attr('data-fixed')&&(Re=!0),cb_edit&&!Re&&(S('#divToolImg').css('top',me+'px'),S('#divToolImg').css('left',ue+'px'),S(this).data('imageembed').settings.imageEmbed&&S('#divToolImg').stop(!0,!0).css({display:'none'}).fadeIn(20),S(this).data('imageembed').settings.linkDialog?(S('#divToolImgSettings').css('top',ge+'px'),S('#divToolImgSettings').css('left',ue+'px'),S('#divToolImgSettings').stop(!0,!0).css({display:'none'}).fadeIn(20)):S('#divToolImgSettings').css('top','-10000px')),(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i))&&S('#lnkImageSettings').on('touchstart mouseenter focus',function(Oe){'touchstart'==Oe.type&&(Oe.stopImmediatePropagation(),Oe.preventDefault()),S('#lnkImageSettings').click(),Oe.preventDefault(),Oe.stopImmediatePropagation()}),S('#divToolImg').unbind('click'),S('#divToolImg').bind('click',function(Oe){S('#divToolImg').data('image',$imgActive);var Ne=(U.data('imageembed').settings.onImageBrowseClick+'').replace(/\s/g,'');'function(){}'==Ne?S('input.my-file[type=file]').click():U.data('imageembed').settings.onImageBrowseClick(),Oe.preventDefault(),Oe.stopImmediatePropagation()}),S('#divToolImg').unbind('hover'),S('#divToolImg').hover(function(){ae&&S('#divToolImg').stop(!0,!0).css('display','block'),S('#divToolImgSettings').stop(!0,!0).css('display','block')},function(){S('#divToolImg').stop(!0,!0).fadeOut(0),S('#divToolImgSettings').stop(!0,!0).fadeOut(0)}),U.find('figcaption').unbind('hover'),U.find('figcaption').hover(function(){ae&&S('#divToolImg').stop(!0,!0).css('display','block'),S('#divToolImgSettings').stop(!0,!0).css('display','block')},function(){S('#divToolImg').stop(!0,!0).fadeOut(0),S('#divToolImgSettings').stop(!0,!0).fadeOut(0)}),S('#divToolImgSettings').unbind('hover'),S('#divToolImgSettings').hover(function(){ae&&S('#divToolImg').stop(!0,!0).css('display','block'),S('#divToolImgSettings').stop(!0,!0).css('display','block')},function(){S('#divToolImg').stop(!0,!0).fadeOut(0),S('#divToolImgSettings').stop(!0,!0).fadeOut(0)}),S('#lnkImageSettings').unbind('click'),S('#lnkImageSettings').bind('click',function(Oe){S('#divToolImg').data('image',$imgActive),S('#divToolImg').stop(!0,!0).fadeOut(0),S('#divToolImgSettings').stop(!0,!0).fadeOut(0);var Ne=(U.data('imageembed').settings.onImageSettingClick+'').replace(/\s/g,'');if('function(){}'!=Ne)return void U.data('imageembed').settings.onImageSettingClick();S('#md-img').css('max-width','550px'),S('#md-img').simplemodal({noOverlay:!0}),S('#md-img').data('simplemodal').show();var Be;U.parents().each(function(){S(this).data('contenteditor')&&(Be=S(this).data('contenteditor'),Be.closePop())});var Ee=U;'figure'==U.prop('tagName').toLowerCase()&&(Ee=U.find('img:first')),-1==Ee.attr('src').indexOf('base64')?S('#txtImgUrl').val(Ee.attr('src')):S('#txtImgUrl').val('[Image Data]'),S('#txtAltText').val(Ee.attr('alt')),S('#txtLinkUrl').val(''),S('#chkNewWindow2').prop('checked',!1),Ee.parents('a:first')!=void 0&&(S('#txtLinkUrl').val(Ee.parents('a:first').attr('href')),'_blank'==Ee.parents('a:first').attr('target')?S('#chkNewWindow2').prop('checked',!0):S('#chkNewWindow2').prop('checked',!1)),U.data('imageembed').settings.imageEmbed?(S('#divEmbedOriginal').css('display','none'),S('#btnImgOk').unbind('keyup'),S('#txtImgUrl').unbind('fileselected'),S('#txtImgUrl').bind('fileselected',function(){Ee.attr('src')==S('#txtImgUrl').val()?S('#divEmbedOriginal').css('display','none'):S('#divEmbedOriginal').css('display','block')})):S('#divEmbedOriginal').css('display','none'),S('#chkCrop').removeAttr('checked'),S('#btnImgOk').unbind('click'),S('#btnImgOk').bind('click',function(){var We;U.parents().each(function(){S(this).data('contentbuilder')&&(We=S(this).data('contentbuilder'))});var je=!1;if(S('#chkCrop').is(':checked')||(je=!0),!1==je&&-1!=S('#txtImgUrl').val().indexOf('http')&&(je=!0),Ee.attr('src')!=S('#txtImgUrl').val()&&(je?(-1!=Ee.attr('src').indexOf(sScriptPath+'image.png')&&-1==S('#txtImgUrl').val().indexOf(sScriptPath+'image.png')&&(Ee.css('width',''),Ee.css('height','')),-1==S('#txtImgUrl').val().indexOf('[Image Data]')&&Ee.attr('src',S('#txtImgUrl').val())):_(S('#txtImgUrl').val())),Ee.attr('alt',S('#txtAltText').val()),'http://'==S('#txtLinkUrl').val()||''==S('#txtLinkUrl').val())Ee.parents('a:first').replaceWith(Ee.parents('a:first').html());else{var _e=S('#txtLinkUrl').val();0==Ee.parents('a:first').length?Ee.wrap('<a href="'+_e+'"></a>'):Ee.parents('a:first').attr('href',_e),Ee.parents('a:first').attr('title',S('#txtAltText').val()),S('#chkNewWindow2').is(':checked')?Ee.parents('a:first').attr('target','_blank'):Ee.parents('a:first').removeAttr('target'),-1!=_e.toLowerCase().indexOf('.jpg')||-1!=_e.toLowerCase().indexOf('.jpeg')||-1!=_e.toLowerCase().indexOf('.png')||-1!=_e.toLowerCase().indexOf('.gif')?Ee.parents('a:first').addClass('is-lightbox'):Ee.parents('a:first').removeClass('is-lightbox')}We&&We.applyBehavior(),S('#md-img').data('simplemodal').hide()});var ze=Ee[0].naturalWidth,De=Ee[0].naturalHeight;if(-1!=Ee.attr('src').indexOf(sScriptPath+'image.png'))for(var Pe=0,Me;Pe<Ee.attr('style').split(';').length;Pe++)Me=Ee.attr('style').split(';')[Pe],'width'==S.trim(Me.split(':')[0])&&(ze=parseInt(S.trim(Me.split(':')[1]))),'height'==S.trim(Me.split(':')[0])&&(De=parseInt(S.trim(Me.split(':')[1])));for(var Fe=50,Pe=0;231>Pe;Pe++)Fe>=ze&&(Pe=231,S('#selImgW').val(Fe)),Fe+=5;for(var He=50,Pe=0;111>Pe;Pe++)He>=De&&(Pe=111,S('#selImgH').val(He)),He+=5;500==parseInt(Ee.css('border-radius'))?(S('#selImgStyle').val('circle'),S('#selImgH').css('display','none')):(S('#selImgStyle').val('square'),S('#selImgH').css('display','inline')),S('#selImgStyle').unbind('change'),S('#selImgStyle').bind('change',function(){'circle'==S('#selImgStyle').val()?(S('#selImgH').css('display','none'),S('#selImgH').val(S('#selImgW').val())):(S('#selImgH').css('display','inline'),S('#selImgH').val(S('#selImgW').val()))}),S('#selImgW').unbind('change'),S('#selImgW').bind('change',function(){'circle'==S('#selImgStyle').val()&&S('#selImgH').val(S('#selImgW').val())}),S('#btnInsertPlh').unbind('click'),S('#btnInsertPlh').bind('click',function(){var We;U.parents().each(function(){S(this).data('contentbuilder')&&(We=S(this).data('contentbuilder'))}),Ee.attr('src',sScriptPath+'image.png'),Ee.attr('alt',S('#txtAltText').val()),'circle'==S('#selImgStyle').val()?(Ee.css('border-radius','500px'),S('#selImgH').val(S('#selImgW').val())):(Ee.css('border-radius',''),Ee.removeClass('circle')),Ee.css('width',S('#selImgW').val()+'px'),Ee.css('height',S('#selImgH').val()+'px'),We&&We.applyBehavior(),S('#md-img').data('simplemodal').hide()}),Oe.preventDefault(),Oe.stopImmediatePropagation()}),S('#btnImageBrowse').unbind('click'),S('#btnImageBrowse').bind('click',function(){S('#divToolImg').stop(!0,!0).fadeOut(0),S('#divToolImgSettings').stop(!0,!0).fadeOut(0),S('#divRteLink').stop(!0,!0).fadeOut(0),S('#divFrameLink').stop(!0,!0).fadeOut(0);var Ne=(U.data('imageembed').settings.onImageSelectClick+'').replace(/\s/g,'');'function(){}'==Ne?(S('#ifrImageBrowse').attr('src',U.data('imageembed').settings.imageselect),S('#active-input').val('txtImgUrl')):U.data('imageembed').settings.onImageSelectClick({targetInput:S('#txtImgUrl').get(0),theTrigger:S('#btnImageBrowse').get(0)})}),S('#btnFileBrowse').unbind('click'),S('#btnFileBrowse').bind('click',function(){S('#divToolImg').stop(!0,!0).fadeOut(0),S('#divToolImgSettings').stop(!0,!0).fadeOut(0),S('#divRteLink').stop(!0,!0).fadeOut(0),S('#divFrameLink').stop(!0,!0).fadeOut(0);var Ne=(U.data('imageembed').settings.onFileSelectClick+'').replace(/\s/g,'');'function(){}'==Ne?(S('#ifrFileBrowse').attr('src',U.data('imageembed').settings.fileselect),S('#active-input').val('txtLinkUrl')):U.data('imageembed').settings.onFileSelectClick({targetInput:S('#txtLinkUrl').get(0),theTrigger:S('#btnFileBrowse').get(0)})}),S('.my-file[type=file]').unbind('change'),S('.my-file[type=file]').bind('change',function(Oe){W(Oe),S('#my-image').attr('src','')}),S('#tabImgLnk').unbind('click'),S('#tabImgLnk').bind('click',function(){S('#tabImgLnk').addClass('active'),S('#tabImgPl').removeClass('active'),S('#divImgPl').fadeOut(300,function(){S('#divImgLnk').fadeIn(0),S('#divImgLnkOk').fadeIn(0)})}),S('#tabImgPl').unbind('click'),S('#tabImgPl').bind('click',function(){S('#tabImgLnk').removeClass('active'),S('#tabImgPl').addClass('active'),S('#divImgLnk').fadeOut(0),S('#divImgLnkOk').fadeOut(0,function(){S('#divImgPl').fadeIn(300)})})},function(){S('#divToolImg').stop(!0,!0).fadeOut(0),S('#divToolImgSettings').stop(!0,!0).fadeOut(0)})};var W=function(Q){if('undefined'==typeof FileReader)return!0;var X=Q.target.files[0];if(X){var K=X.name.substr(X.name.lastIndexOf('.')+1).toLowerCase();return'jpg'!=K&&'jpeg'!=K&&'png'!=K&&'gif'!=K&&'bmp'!=K?void alert('Please select an image'):void(S('#divToolImg').stop(!0,!0).fadeOut(0),S('#divToolImgSettings').stop(!0,!0).fadeOut(0),S('#divToolImgLoader').css('top',S('#divToolImg').css('top')),S('#divToolImgLoader').css('left',S('#divToolImg').css('left')),S('#divToolImgLoader').css('display','block'),S('.overlay-bg').css('background','none'),S('.overlay-bg').css('width','100%'),S('.overlay-bg').css('height','100%'),_(X))}},_=function(Q){var X,K;Q.name?(X=Q.name,K=Q.name.substr(Q.name.lastIndexOf('.')+1).toLowerCase()):(X=Q.substr(Q.lastIndexOf('/')+1),K=Q.substr(Q.lastIndexOf('.')+1).toLowerCase());var Y=!1;try{Y=U.data('imageembed').settings.hiquality}catch(ae){}var ee,te;!1==Y?'jpg'==K||'jpeg'==K?(ee='image/jpeg',te=0.92):(ee='image/png',te=1):(ee='image/png',te=1),loadImage.parseMetaData(Q,function(ae){var ie;ae.exif&&(ie=ae.exif.get('Orientation')),loadImage(Q,function(oe){S('.overlay-bg').css('background','none'),S('.overlay-bg').css('width','100%'),S('.overlay-bg').css('height','100%');var ne,se;3200<oe.width||3200<oe.height?(ne=oe.width/2,se=oe.height/2):2500<oe.width||2500<oe.height?(ne=oe.width/1.25,se=oe.height/1.25):(ne=oe.width,se=oe.height),4<ie&&9>ie?(R=se,O=ne):(R=ne,O=se);var le=!1,de,ce;O<=$imgActive.height()&&R>$imgActive.width()?(de=$imgActive.width(),ce=O*$imgActive.width()/R,le=!0):R<=$imgActive.width()&&O>$imgActive.height()?(ce=$imgActive.height(),de=R*$imgActive.height()/O,le=!0):R<=$imgActive.width()&&O<=$imgActive.height()?(de=R,ce=O):(de=$imgActive.width(),ce=O*$imgActive.width()/R,le=!0);var pe=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),me=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;if(pe||me){var ge=new MegaPixImage(oe);ge.render(L,{width:ne,height:se,orientation:ie},function(){if(le){var Xe=new Image,Ke=R,Ye=O;Xe.onload=function(){Ke/=2,Ye/=2,(Ke<de||Ye<ce)&&(Ke=de,Ye=ce);var Je=new MegaPixImage(Xe);Je.render(L,{width:Ke,height:Ye},function(){Ke<=de||Ye<=ce||(Xe.src=L.toDataURL(ee,te))})},Xe.src=L.toDataURL(ee,te)}})}else{var ue=L.getContext('2d');switch(4<ie&&9>ie?(L.width=se,L.height=ne):(L.width=ne,L.height=se),ie){case 2:ue.transform(-1,0,0,1,ne,0);break;case 3:ue.transform(-1,0,0,-1,ne,se);break;case 4:ue.transform(1,0,0,-1,0,se);break;case 5:ue.transform(0,1,1,0,0,0);break;case 6:ue.transform(0,1,-1,0,se,0);break;case 7:ue.transform(0,-1,-1,0,se,ne);break;case 8:ue.transform(0,-1,1,0,0,ne);break;default:}if(ue.drawImage(oe,0,0,ne,se),le){var be=new Image,he=R,fe=O;be.onload=function(){he/=2,fe/=2,(he<de||fe<ce)&&(he=de,fe=ce),L.width=he,L.height=fe,ue=L.getContext('2d'),ue.drawImage(be,0,0,he,fe),he<=de||fe<=ce||(be.src=L.toDataURL(ee,te))},be.src=L.toDataURL(ee,te)}}$imgActive=S('#divToolImg').data('image');var ve=localStorage.zoom;1==U.data('imageembed').settings.zoom&&(ve=1);var Ce;'img'==$imgActive.prop('tagName').toLowerCase()?Ce=$imgActive[0].naturalWidth/$imgActive.width():'figure'==$imgActive.prop('tagName').toLowerCase()&&(Ce=$imgActive.find('img')[0].naturalWidth/$imgActive.find('img').width());var ye=0,xe=0;if('img'==$imgActive.prop('tagName').toLowerCase()){if(-1!=$imgActive.attr('src').indexOf(sScriptPath+'image.png'))for(var ke=0,we;ke<$imgActive.attr('style').split(';').length;ke++)we=$imgActive.attr('style').split(';')[ke],'width'==S.trim(we.split(':')[0])&&(ye=parseInt(S.trim(we.split(':')[1])),Ce=ye/$imgActive.width()),'height'==S.trim(we.split(':')[0])&&(xe=parseInt(S.trim(we.split(':')[1])));}else if('figure'==$imgActive.prop('tagName').toLowerCase()&&-1!=$imgActive.find('img').attr('src').indexOf(sScriptPath+'image.png'))for(var ke=0,we;ke<$imgActive.find('img').attr('style').split(';').length;ke++)we=$imgActive.find('img').attr('style').split(';')[ke],'width'==S.trim(we.split(':')[0])&&(ye=parseInt(S.trim(we.split(':')[1])),Ce=ye/$imgActive.find('img').width()),'height'==S.trim(we.split(':')[0])&&(xe=parseInt(S.trim(we.split(':')[1])));var Se=0;'img'==$imgActive.prop('tagName').toLowerCase()?(S('#my-mask').css('width',$imgActive.width()*Ce-Se+'px'),S('#my-mask').css('height',$imgActive.height()*Ce-Se+'px')):(S('#my-mask').css('width',$imgActive.innerWidth()*Ce-Se+'px'),S('#my-mask').css('height',$imgActive.innerHeight()*Ce-Se+'px')),0!=ye&&S('#my-mask').css('width',ye+'px'),0!=xe&&S('#my-mask').css('height',xe+'px'),S('#my-mask').css('zoom',ve/Ce),S('#my-mask').css('-moz-transform','scale('+ve/Ce+')');var Le=$imgActive.width(),Ae=$imgActive.height(),Re=R/O,Ie,Te;Re<Le/Ae?(Ie=Le,Te=O*Le/R):(Ie=R*Ae/O,Te=Ae),Ie*=Ce,Te*=Ce,$imgActive=S('#divToolImg').data('image'),S('#my-image').css('top','0px'),S('#my-image').css('left','0px'),S('#my-image').css('width',Ie+'px'),S('#my-image').css('height',Te+'px');var ve=localStorage.zoom;ve*=1,1==U.data('imageembed').settings.zoom&&(ve=1);var De=S(window).scrollTop(),Pe=$imgActive.offset().top,Me=$imgActive.offset().left,Fe=-1<navigator.userAgent.toLowerCase().indexOf('firefox'),He=detectIE(),Ue=!0,Ne,Be,Ee,ze;if((Fe||He)&&(Ue=!1),Ue)Ne=Pe*ve+(De-De*ve),Be=Me*ve,Ee=(Pe+5)*ve+(De-De*ve),ze=(Me+5)*ve;else{if(He){var We=0,je=0;U.parents().each(function(){S(this).data('contentbuilder')&&(We=S(this).getPos().top,je=S(this).getPos().left)});var _e=-We*ve+We,qe=-je*ve+je,Ge=$imgActive.getPos();Ne=Ge.top*ve+_e,Be=Ge.left*ve+qe,Ee=(Ge.top+5)*ve+_e,ze=(Ge.left+5)*ve+qe}if(Fe){var Ze=parseInt($imgActive.css('width')),$e=parseInt($imgActive.css('height')),qe=Ze/2-Ze/2*ve,_e=$e/2-$e/2*ve;S('#img-control').css('top',5+_e+'px'),S('#img-control').css('left',7+qe+'px'),Ne=Pe-_e,Be=Me-qe,Ee=Pe-_e+5,ze=Me-qe+5}}S('#divImageEdit').css('display','inline-block'),'img-polaroid'==$imgActive.attr('class')?(S('#divImageEdit').css('top',Ee+'px'),S('#divImageEdit').css('left',ze+'px')):(S('#divImageEdit').css('top',Ne+'px'),S('#divImageEdit').css('left',Be+'px')),25>parseInt(S('#divImageEdit').css('top'))&&(S('#img-control').css('top','auto'),S('#img-control').css('bottom','-24px')),S('#my-mask').css('transform-origin','left top'),V();var Fe=-1<navigator.userAgent.toLowerCase().indexOf('firefox');Fe&&sleep(700),S('#btnImageCancel').css('display','none'),S('#btnZoomOut').css('display','none'),S('#btnZoomIn').css('display','none'),S('#btnImageMore').css('display','none'),S('#btnChangeImage').css('display','none');var pe=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),me=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;if(pe||me){var ge=new MegaPixImage(oe);ge.render(T,{width:ne,height:se,orientation:ie},function(){S('#my-image').attr('src',T.toDataURL(ee,te));var Xe=new Image,Ke=R,Ye=O;Xe.onload=function(){Ke/=2,Ye/=2,(Ke<Ie||Ye<Te)&&(Ke=Ie,Ye=Te);var Je=new MegaPixImage(Xe);Je.render(T,{width:Ke,height:Ye},function(){return Ke<=Ie||Ye<=Te?(Z(),'img-circle'==$imgActive.attr('class')?(S('#my-mask').css('-webkit-border-radius','500px'),S('#my-mask').css('-moz-border-radius','500px'),S('#my-mask').css('border-radius','500px')):(S('#my-mask').css('-webkit-border-radius','0px'),S('#my-mask').css('-moz-border-radius','0px'),S('#my-mask').css('border-radius','0px')),'img'==$imgActive.prop('tagName').toLowerCase()||(S('#btnZoomIn').click(),S('#btnZoomIn').click()),S('#divToolImgLoader').css('display','none'),S('#btnImageCancel').css('display','inline-block'),S('#btnZoomOut').css('display','inline-block'),S('#btnZoomIn').css('display','inline-block'),S('#btnImageMore').css('display','inline-block'),S('#btnChangeImage').css('display','inline-block'),void S('.overlay-bg').css('background','#fff')):void(Xe.src=T.toDataURL(ee,te))})},Xe.src=T.toDataURL(ee,te)})}else{var Ve=T.getContext('2d');switch(4<ie&&9>ie?(T.width=se,T.height=ne):(T.width=ne,T.height=se),ie){case 2:Ve.transform(-1,0,0,1,ne,0);break;case 3:Ve.transform(-1,0,0,-1,ne,se);break;case 4:Ve.transform(1,0,0,-1,0,se);break;case 5:Ve.transform(0,1,1,0,0,0);break;case 6:Ve.transform(0,1,-1,0,se,0);break;case 7:Ve.transform(0,-1,-1,0,se,ne);break;case 8:Ve.transform(0,-1,1,0,0,ne);break;default:}Ve.drawImage(oe,0,0,ne,se),S('#my-image').attr('src',T.toDataURL(ee,te));var Qe=new Image,he=R,fe=O;Qe.onload=function(){return he/=2,fe/=2,(he<Ie||fe<Te)&&(he=Ie,fe=Te),T.width=he,T.height=fe,Ve=T.getContext('2d'),Ve.drawImage(Qe,0,0,he,fe),he<=Ie||fe<=Te?(Z(),'img-circle'==$imgActive.attr('class')?(S('#my-mask').css('-webkit-border-radius','500px'),S('#my-mask').css('-moz-border-radius','500px'),S('#my-mask').css('border-radius','500px')):(S('#my-mask').css('-webkit-border-radius','0px'),S('#my-mask').css('-moz-border-radius','0px'),S('#my-mask').css('border-radius','0px')),'img'==$imgActive.prop('tagName').toLowerCase()||(S('#btnZoomIn').click(),S('#btnZoomIn').click()),S('#divToolImgLoader').css('display','none'),S('#btnImageCancel').css('display','inline-block'),S('#btnZoomOut').css('display','inline-block'),S('#btnZoomIn').css('display','inline-block'),S('#btnImageMore').css('display','inline-block'),S('#btnChangeImage').css('display','inline-block'),void S('.overlay-bg').css('background','#fff')):void(Qe.src=T.toDataURL(ee,te))},Qe.src=T.toDataURL(ee,te)}S('#btnImageMore').unbind('click'),S('#btnImageMore').bind('click',function(){'block'==S('#divImageMore').css('display')?S('#divImageMore').css('display','none'):(S('#divImageMore').css('display','block'),S('#chkImageNoCrop').attr('checked',!1),0==$imgActive.parents('a:first').length?S('#chkImageClickToEnlarge').attr('checked',!1):(-1!=$imgActive.parents('a:first').attr('href').toLowerCase().indexOf('.jpg')||-1!=$imgActive.parents('a:first').attr('href').toLowerCase().indexOf('.png'))&&S('#chkImageClickToEnlarge').attr('checked',!0)),S('.overlay-bg').unbind('click'),S('.overlay-bg').bind('click',function(){S('#divImageMore').css('display','none')}),S('#my-mask').unbind('click'),S('#my-mask').bind('click',function(){S('#divImageMore').css('display','none')})}),S('#btnImageMoreOk').unbind('click'),S('#btnImageMoreOk').bind('click',function(){if(S('#chkImageClickToEnlarge').is(':checked')){var Xe='#';0==$imgActive.parents('a:first').length?$imgActive.wrap('<a href="'+Xe+'"></a>'):$imgActive.parents('a:first').attr('href',Xe),$imgActive.parents('a:first').attr('title',''),$imgActive.parents('a:first').addClass('is-lightbox')}if(S('#chkImageNoCrop').is(':checked')){var Ke=document.getElementById('myTmpCanvasNoCrop'),Ye;Ye=!1==Y?'jpg'==K||'jpeg'==K?Ke.toDataURL('image/jpeg',0.92):Ke.toDataURL('image/png',1):Ke.toDataURL('image/png',1),'img'==$imgActive.prop('tagName').toLowerCase()?($imgActive.attr('src',Ye),$imgActive.data('filename',X)):'figure'==$imgActive.prop('tagName').toLowerCase()?($imgActive.find('img').attr('src',Ye),$imgActive.find('img').data('filename',X)):($imgActive.css('background-image','url(data:'+Ye+')'),$imgActive.data('filename',X)),$imgActive.parent().hasClass('is-lightbox')?(S('#canvasform').attr('action',U.data('imageembed').settings.largerImageHandler),S('#canvasform').submit()):S('.my-file[type=file]').clearInputs()}else S('#btnChangeImage').click();S('#divImageEdit').css('display','none'),S('.overlay-bg').css('width','1px'),S('.overlay-bg').css('height','1px'),S('body').css('overflow',''),'img'==$imgActive.prop('tagName').toLowerCase()?($imgActive.css('width',''),$imgActive.css('height','')):'figure'==$imgActive.prop('tagName').toLowerCase()&&($imgActive.find('img').css('width',''),$imgActive.find('img').css('height','')),U.data('imageembed').settings.onChanged(),S('#divToolImgLoader').css('display','none'),S('#divImageMore').css('display','none');var Je;U.parents().each(function(){S(this).data('contentbuilder')&&(Je=S(this).data('contentbuilder'))}),!S('#chkImageClickToEnlarge').is(':checked')&&0<$imgActive.parents('a:first').length&&(-1!=$imgActive.parents('a:first').attr('href').toLowerCase().indexOf('.jpg')||-1!=$imgActive.parents('a:first').attr('href').toLowerCase().indexOf('.png'))&&$imgActive.parents('a:first').replaceWith($imgActive.parents('a:first').html()),Je&&(Je.applyBehavior(),Je.settings.onRender())}),S('#btnChangeImage').unbind('click'),S('#btnChangeImage').bind('click',function(){var Xe=document.getElementById('myCanvas');$imgActive=S('#divToolImg').data('image');var Ke;Ke=!1==Y?'jpg'==K||'jpeg'==K?Xe.toDataURL('image/jpeg',0.92):Xe.toDataURL('image/png',1):Xe.toDataURL('image/png',1),'img'==$imgActive.prop('tagName').toLowerCase()?($imgActive.attr('src',Ke),$imgActive.data('filename',X)):'figure'==$imgActive.prop('tagName').toLowerCase()?($imgActive.find('img').attr('src',Ke),$imgActive.find('img').data('filename',X)):($imgActive.css('background-image','url(data:'+Ke+')'),$imgActive.data('filename',X)),$imgActive.parent().hasClass('is-lightbox')&&''!=S('#fileImage').val()?(S('#canvasform').attr('action',U.data('imageembed').settings.largerImageHandler),S('#canvasform').submit()):S('.my-file[type=file]').clearInputs(),S('#divImageEdit').css('display','none'),S('.overlay-bg').css('width','1px'),S('.overlay-bg').css('height','1px'),S('body').css('overflow',''),'img'==$imgActive.prop('tagName').toLowerCase()?($imgActive.css('width',''),$imgActive.css('height','')):'figure'==$imgActive.prop('tagName').toLowerCase()&&($imgActive.find('img').css('width',''),$imgActive.find('img').css('height','')),U.data('imageembed').settings.onChanged(),S('#divImageMore').css('display','none')}),S('#btnImageCancel').unbind('click'),S('#btnImageCancel').bind('click',function(){document.getElementById('myCanvas');$imgActive=S('#divToolImg').data('image'),S('#divImageEdit').css('display','none'),S('.overlay-bg').css('width','1px'),S('.overlay-bg').css('height','1px'),S('body').css('overflow',''),S('#divImageMore').css('display','none'),S('.my-file[type=file]').clearInputs()}),S('#btnZoomIn').unbind('click'),S('#btnZoomIn').bind('click',function(){var Xe=parseInt(S('#my-image').css('width')),Ke=parseInt(S('#my-image').css('height'));S('#my-image').css('width',Xe/0.9+'px'),S('#my-image').css('height',Ke/0.9+'px'),V(),T.width=Xe/0.9,T.height=Ke/0.9;var Ye=S('#my-image')[0],Je=T.getContext('2d'),et=new Image,Je,tt,at;tt=R,at=O,et.src=Ye.src,et.onload=function(){return tt/=2,at/=2,tt<Ye.width&&(tt=Xe/0.9),at<Ye.height&&(at=Ke/0.9),T.width=tt,T.height=at,Je=T.getContext('2d'),Je.drawImage(et,0,0,tt,at),tt<=Xe/0.9||at<=Ke/0.9?(V(),void Z()):void(et.src=T.toDataURL(ee,te))},Z()}),S('#btnZoomOut').unbind('click'),S('#btnZoomOut').bind('click',function(){var Xe=parseInt(S('#my-image').css('width')),Ke=parseInt(S('#my-image').css('height'));if(!(Xe/1.1<S('#my-mask').width())&&!(Ke/1.1<S('#my-mask').height())){S('#my-image').css('width',Xe/1.1+'px'),S('#my-image').css('height',Ke/1.1+'px'),V(),T.width=Xe/1.1,T.height=Ke/1.1;var Ye=S('#my-image')[0],Je=T.getContext('2d'),et=new Image,Je,tt,at;tt=R,at=O,et.src=Ye.src,et.onload=function(){return tt/=2,at/=2,tt<Ye.width&&(tt=Xe/1.1),at<Ye.height&&(at=Ke/1.1),T.width=tt,T.height=at,Je=T.getContext('2d'),Je.drawImage(et,0,0,tt,at),tt<=Xe/1.1||at<=Ke/1.1?(V(),void Z()):void(et.src=T.toDataURL(ee,te))},Z()}})},{canvas:!1})})},Z=function(){var Q=1.1,X=parseInt(S('#my-image').css('left'))-Q,K=parseInt(S('#my-image').css('top'))-Q,Y=parseInt(S('#my-mask').css('width')),ee=parseInt(S('#my-mask').css('height')),te=document.getElementById('myCanvas'),ae=te.getContext('2d');te.width=Y,te.height=ee;var ie=-1*X,oe=-1*K;if(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)){var ne=0.7;ie=-1*X+(X-X/ne),oe=-1*K+(K-K/ne)}oe>T.height-ee&&(oe=T.height-ee),ie>T.width-Y&&(ie=T.width-Y),ae.drawImage(T,ie,oe,Y,ee,0,0,Y,ee)},V=function(){S('#my-image').css({top:0,left:0});var Q=S('#my-mask').width(),X=S('#my-mask').height(),K=S('#my-image').offset(),Y=S('#my-image').width(),ee=S('#my-image').height(),te=K.left+Q-Y,ae=K.top+X-ee,ie=K.left,oe=K.top;S('#my-image').draggable({revert:!1,containment:[te,ae,ie,oe],scroll:!1,drag:function(){Z()}}),S('#my-image').css({cursor:'move'})};this.init()},S.fn.imageembed=function(N){return this.each(function(){if(void 0==S(this).data('imageembed')){var P=new S.imageembed(this,N);S(this).data('imageembed',P)}})}})(jQuery);function applyLargerImage(S){$imgActive.parents('a').attr('href',S),jQuery('.my-file[type=file]').clearInputs()}function makeid(){for(var S='',T='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz',L=0;2>L;L++)S+=T.charAt(Math.floor(Math.random()*T.length));for(var R='',O='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789',L=0;5>L;L++)R+=O.charAt(Math.floor(Math.random()*O.length));return S+R}function sleep(S){for(var T=new Date().getTime(),L=0;1e7>L&&!(new Date().getTime()-T>S);L++);}jQuery.fn.clearFields=jQuery.fn.clearInputs=function(S){var T=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var L=this.type,R=this.tagName.toLowerCase();T.test(L)||'textarea'==R?this.value='':'checkbox'==L||'radio'==L?this.checked=!1:'select'==R?this.selectedIndex=-1:'file'==L?/MSIE/.test(navigator.userAgent)?jQuery(this).replaceWith(jQuery(this).clone(!0)):jQuery(this).val(''):S&&(!0===S&&/hidden/.test(L)||'string'==typeof S&&jQuery(this).is(S))&&(this.value='')})};var zindex=1e4;(function(S){S.simplemodal=function(T,L){var R={onCancel:function(){},onFinish:function(){},isModal:!1,noOverlay:!1};this.settings={};var O=S(T),T=T,N;this.init=function(){this.settings=S.extend({},R,L),0==S('#divCb').length&&S('body').append('<div id="divCb"></div>')},this.hide=function(){O.css('display','none'),O.removeClass('md-show'),this.settings.noOverlay||N.remove(),zindex-=2,O.data('simplemodal').settings.onFinish()},this.show=function(P){if(++zindex,!this.settings.noOverlay){var M=makeid(),U='<div id="md-overlay-'+M+'" class="md-overlay" style="z-index:'+zindex+'"></div>';this.settings.isModal&&(U='<div id="md-overlay-'+M+'" class="md-overlay" style="z-index:'+zindex+';background:rgba(255, 255, 255, 0.9)"></div>'),S('#divCb').append(U),N=S('#md-overlay-'+M)}if(++zindex,O.css('z-index',zindex),O.addClass('md-show'),O.stop(!0,!0).css('display','none').fadeIn(200),O.hasClass('md-draggable')){var W=parseInt(O.css('width')),_=parseInt(O.css('height'));O.css('top',Math.max(0,(S(window).height()-_)/2)+'px'),O.css('left',Math.max(0,(S(window).width()-W)/2)+'px'),0<O.find('.md-modal-handle').length?(O.find('.md-modal-handle').css('cursor','move'),O.draggable({handle:'.md-modal-handle'})):O.draggable()}if(0<O.find('.md-modal-close').length&&O.find('.md-modal-close').click(function(){O.data('simplemodal').hide()}),!this.settings.noOverlay){var P=P;S('#md-overlay-'+M).unbind(),S('#md-overlay-'+M).click(function(){O.data('simplemodal').settings.isModal||(O.stop(!0,!0).fadeOut(100,function(){O.removeClass('md-show')}),N.remove(),zindex-=2,P&&restoreSelection(P),O.data('simplemodal').settings.onCancel())})}},this.init()},S.fn.simplemodal=function(T){return this.each(function(){if(void 0==S(this).data('simplemodal')){var L=new S.simplemodal(this,T);S(this).data('simplemodal',L)}})}})(jQuery),jQuery(document).keydown(function(S){90===S.which&&S.ctrlKey&&(S.shiftKey?doRedo():!S.altKey&&doUndo()),89===S.which&&S.ctrlKey&&!S.altKey&&doRedo(),13==S.which&&saveForUndo(),66!=S.which&&73!=S.which&&85!=S.which||S.altKey||saveForUndo(),(37==S.keyCode||38==S.keyCode||39==S.keyCode||40==S.keyCode)&&saveForUndo()});function saveForUndo(){var S=!1;jQuery(cb_list).each(function(){var T=jQuery(this),L=T.data('contentbuilder');L.undoList[0]?T.html()!=L.undoList[0][0]&&(S=!0):S=!0});S&&jQuery(cb_list).each(function(){for(var T=jQuery(this),L=T.data('contentbuilder'),R=20;1<R;R--)L.undoList[R-1]=L.undoList[R-2];var O;if(window.getSelection)try{O=window.getSelection().getRangeAt(0),L.undoList[0]=[T.html(),O.cloneRange()]}catch(P){L.undoList[0]=[T.html(),null]}else if(document.selection)try{O=document.selection.createRange();var N=document.selection.type;'Text'==N?L.undoList[0]=[T.html(),O.getBookmark(),'Text']:'Control'==N?(O.item(0).selThis='selThis',L.undoList[0]=[T.html(),null,'Control'],O.item(0).removeAttribute('selThis',0)):L.undoList[0]=[T.html(),O.getBookmark(),'None']}catch(P){'Text'==N?L.undoList[0]=[T.html(),null,'Text']:'Control'==N?(O.item(0).selThis='selThis',L.undoList[0]=[T.html(),null,'Control'],O.item(0).removeAttribute('selThis',0)):L.undoList[0]=[T.html(),null,'None']}L.redoList=[]})}var numUndo=0;function doUndo(){var S=!1;return jQuery(cb_list).each(function(){var T=jQuery(this),L=T.data('contentbuilder');L.undoList[0]?T.html()!=L.undoList[0][0]&&(S=!0):S=!0}),jQuery(cb_list).each(function(){var T=jQuery(this),L=T.data('contentbuilder');if(L.undoList[0]){for(var R=20;1<R;R--)L.redoList[R-1]=L.redoList[R-2];var O;if(window.getSelection)try{O=window.getSelection().getRangeAt(0),L.redoList[0]=[T.html(),O.cloneRange()]}catch(P){L.redoList[0]=[T.html(),null]}else if(document.selection){O=document.selection.createRange();var N=document.selection.type;'Text'==N?L.redoList[0]=[T.html(),O.getBookmark(),'Text']:'Control'==N?(O.item(0).selThis='selThis',L.redoList[0]=[T.html(),null,'Control'],O.item(0).removeAttribute('selThis',0)):L.redoList[0]=[T.html(),O.getBookmark(),'None']}sHTML=L.undoList[0][0],T.html(sHTML);for(var R=0;19>R;R++)L.undoList[R]=L.undoList[R+1];L.undoList[19]=null,L.applyBehavior(),L.blockChanged(),L.settings.onRender()}}),!1==S&&1>numUndo?(++numUndo,void doUndo()):void(numUndo=0)}function doRedo(){jQuery(cb_list).each(function(){var S=jQuery(this),T=S.data('contentbuilder');if(T.redoList[0]){for(var L=20;1<L;L--)T.undoList[L-1]=T.undoList[L-2];var R;if(window.getSelection)try{R=window.getSelection().getRangeAt(0),T.undoList[0]=[S.html(),R.cloneRange()]}catch(N){T.undoList[0]=[S.html(),null]}else if(document.selection){R=document.selection.createRange();var O=document.selection.type;'Text'==O?T.undoList[0]=[S.html(),R.getBookmark(),'Text']:'Control'==O?(R.item(0).selThis='selThis',T.undoList[0]=[S.html(),null,'Control'],R.item(0).removeAttribute('selThis',0)):T.undoList[0]=[S.html(),R.getBookmark(),'None']}sHTML=T.redoList[0][0],S.html(sHTML);for(var L=0;19>L;L++)T.redoList[L]=T.redoList[L+1];T.redoList[19]=null,T.applyBehavior(),T.blockChanged(),T.settings.onRender()}})}jQuery.fn.getPos=function(){var S=this[0],T=0,L=0,O=null;O=S.offsetParent;for(var N=S,P=S;null!=P.parentNode;){if(P=P.parentNode,null!=P.offsetParent){var M=!0;window.opera&&(P==N.parentNode||'TR'==P.nodeName)&&(M=!1),M&&(P.scrollTop&&0<P.scrollTop&&(L-=P.scrollTop),P.scrollLeft&&0<P.scrollLeft&&(T-=P.scrollLeft))}P==O&&(T+=S.offsetLeft,P.clientLeft&&'TABLE'!=P.nodeName&&(T+=P.clientLeft),L+=S.offsetTop,P.clientTop&&'TABLE'!=P.nodeName&&(L+=P.clientTop),S=P,null==S.offsetParent&&(S.offsetLeft&&(T+=S.offsetLeft),S.offsetTop&&(L+=S.offsetTop)),O=S.offsetParent)}return{left:T,top:L}};function cleanHTML(S){var T=/(\n|\r| class=(")?Mso[a-zA-Z]+(")?)/g,L=S.replace(T,' '),R=/<!--(.*?)-->/g,L=L.replace(R,''),O=/<(\/)*(meta|link|span|\?xml:|st1:|o:|font)(.*?)>/gi;L=L.replace(O,'');for(var N=['style','script','applet','embed','noframes','noscript'],P=0;P<N.length;P++)O=new RegExp('<'+N[P]+'.*?'+N[P]+'(.*?)>','gi'),L=L.replace(O,'');for(var M=['style','start'],P=0,U;P<M.length;P++)U=new RegExp(' '+M[P]+'="(.*?)"','gi'),L=L.replace(U,'');return L}function selectRange(S){if(S)if('undefined'!=typeof S.select)S.select();else if('undefined'!=typeof window.getSelection){var T=window.getSelection();T.removeAllRanges(),T.addRange(S)}}function selectElementContents(S){var T=document.createRange();T.selectNodeContents(S);var L=window.getSelection();L.removeAllRanges(),L.addRange(T)}function isEven(S){return!(0!=S%2)}function getCellIndex(S,T,L){for(var R=0,O=!1,N=0;N<T.cells.length;N++)!1==O&&(R+=T.cells[N].colSpan),L==T.cells[N]&&(O=!0);R-=L.colSpan-1;var P=R-1;return P}function detectIE(){var S=window.navigator.userAgent,T=S.indexOf('MSIE '),L=S.indexOf('Trident/'),R=S.indexOf('Edge/');if(0<T)return parseInt(S.substring(T+5,S.indexOf('.',T)),10);if(0<R)return parseInt(S.substring(R+5,S.indexOf('.',R)),10);if(0<L){var O=S.indexOf('rv:');return parseInt(S.substring(O+3,S.indexOf('.',O)),10)}return!1}function detectEdge(){var S=window.navigator.userAgent,T=S.indexOf('Edge/');return!!(0<T)&&parseInt(S.substring(T+5,S.indexOf('.',T)),10)}(function(S){S.fn.contrastingText=function(){var T=this,L;for(L=function(R){var O=R.match(/[0-9]+/g);return null!==O&&!!O[3]};L(T.css('background-color'));)T=T.parent();return parts=T.css('background-color').match(/[0-9]+/g),this.lightBackground=!!Math.round((parseInt(parts[0],10)+parseInt(parts[1],10)+parseInt(parts[2],10))/765),this.lightBackground?this.css('color','black'):this.css('color','rgba(255, 255, 255, 0.7)'),this}})(jQuery),eval(function(S,T,L,R,O,N){if(O=function(P){return(P<T?'':O(parseInt(P/T)))+(35<(P%=T)?String.fromCharCode(P+29):P.toString(36))},!''.replace(/^/,String)){for(;L--;)N[O(L)]=R[L]||O(L);R=[function(P){return N[P]}],O=function(){return'\\w+'},L=1}for(;L--;)R[L]&&(S=S.replace(new RegExp('\\b'+O(L)+'\\b','g'),R[L]));return S}('(n(){n 1n(h){9 p=h.U,m=h.M;f(p*m>1b*1b){9 e=O.Q(\'e\');e.a=e.b=1;9 c=e.W(\'X\');c.12(h,-p+1,0);y c.1h(0,0,1,1).11[3]===0}x{y 1Z}}n 1p(h,p,m){9 e=O.Q(\'e\');e.a=1;e.b=m;9 c=e.W(\'X\');c.12(h,0,0);9 11=c.1h(0,0,1,m).11;9 r=0;9 16=m;9 s=m;17(s>r){9 1q=11[(s-1)*4+3];f(1q===0){16=s}x{r=s}s=(16+r)>>1}9 18=(s/m);y(18===0)?1:18}n 1j(h,j,v){9 e=O.Q(\'e\');1c(h,e,j,v);y e.1X("1v/1w",j.1V||0.8)}n 1c(h,e,j,v){9 p=h.U,m=h.M;f(!(p+m))y;9 a=j.a,b=j.b;9 c=e.W(\'X\');c.1U();1i(e,c,a,b,j.10);9 1k=1n(h);f(1k){p/=2;m/=2}9 d=1b;9 F=O.Q(\'e\');F.a=F.b=d;9 Z=F.W(\'X\');9 1u=v?1p(h,p,m):1;9 1d=w.1x(d*a/p);9 14=w.1x(d*b/m/1u);9 r=0;9 1a=0;17(r<m){9 P=0;9 19=0;17(P<p){Z.1S(0,0,d,d);Z.12(h,-P,-r);c.12(F,0,0,d,d,19,1a,1d,14);P+=d;19+=1d}r+=d;1a+=14}c.1Q();F=Z=T}n 1i(e,c,a,b,10){1m(10){o 5:o 6:o 7:o 8:e.a=b;e.b=a;q;1r:e.a=a;e.b=b}1m(10){o 2:c.C(a,0);c.Y(-1,1);q;o 3:c.C(a,b);c.L(w.G);q;o 4:c.C(0,b);c.Y(1,-1);q;o 5:c.L(0.5*w.G);c.Y(1,-1);q;o 6:c.L(0.5*w.G);c.C(0,-b);q;o 7:c.L(0.5*w.G);c.C(a,-b);c.Y(-1,1);q;o 8:c.L(-0.5*w.G);c.C(-a,0);q;1r:q}}9 t=u.t&&u.t.13?u.t:u.15&&u.15.13?u.15:T;n E(l){f(u.1l&&l 1P 1l){f(!t){1N 1M("1L 13 n 1K 1I 1H A 1G");}9 h=1D 1C();h.1e=t.13(l);g.A=l;l=h}f(!l.U&&!l.M){9 I=g;l.1O=l.1B=n(){9 S=I.H;f(S){I.H=T;1y(9 i=0,1t=S.1E;i<1t;i++){S[i]()}}};g.H=[]}g.l=l}E.1F.1s=n(z,j,N){f(g.H){9 I=g;g.H.1J(n(){I.1s(z,j,N)});y}j=j||{};9 B=g.l.U,D=g.l.M,a=j.a,b=j.b,J=j.J,K=j.K,v=!g.A||g.A.1A===\'1v/1w\';f(a&&!b){b=(D*a/B)<<0}x f(b&&!a){a=(B*b/D)<<0}x{a=B;b=D}f(J&&a>J){a=J;b=(D*a/B)<<0}f(K&&b>K){b=K;a=(B*b/D)<<0}9 V={a:a,b:b};1y(9 k 1R j)V[k]=j[k];9 R=z.R.1T();f(R===\'h\'){z.1e=1j(g.l,V,v)}x f(R===\'e\'){1c(g.l,z,V,v)}f(1g g.1z===\'n\'){g.1z(z)}f(N){N()}f(g.A){g.A=T;t.1W(g.l.1e)}};f(1g 1f===\'n\'&&1f.1Y){1f([],n(){y E})}x f(1g 1o===\'20\'){21.1o=E}x{g.E=E}})();',62,126,'|||||||||var|width|height|ctx||canvas|if|this|img||options||srcImage|ih|function|case|iw|break|sy|py|URL|window|doSquash|Math|else|return|target|blob|imgWidth|translate|imgHeight|MegaPixImage|tmpCanvas|PI|imageLoadListeners|_this|maxWidth|maxHeight|rotate|naturalHeight|callback|document|sx|createElement|tagName|listeners|null|naturalWidth|opt|getContext|2d|scale|tmpCtx|orientation|data|drawImage|createObjectURL|dh|webkitURL|ey|while|ratio|dx|dy|1024|renderImageToCanvas|dw|src|define|typeof|getImageData|transformCoordinate|renderImageToDataURL|subsampled|Blob|switch|detectSubsampling|exports|detectVerticalSquash|alpha|default|render|len|vertSquashRatio|image|jpeg|ceil|for|onrender|type|onerror|Image|new|length|prototype|url|create|to|push|found|No|Error|throw|onload|instanceof|restore|in|clearRect|toLowerCase|save|quality|revokeObjectURL|toDataURL|amd|false|object|module'.split('|'),0,{})),!function(S){'use strict';'function'==typeof define&&define.amd?define(['jquery'],S):'object'==typeof exports?module.exports=S(require('jquery')):S(jQuery)}(function(S){'use strict';function L(K,Y){var ee=Array.prototype.slice.call(arguments,2);return setTimeout(function(){return K.apply(null,ee)},Y)}function R(K,Y){return Y=Y||100,function(){if(!K.debouncing){var ee=Array.prototype.slice.apply(arguments);K.lastReturnVal=K.apply(window,ee),K.debouncing=!0}return clearTimeout(K.debounceTimeout),K.debounceTimeout=setTimeout(function(){K.debouncing=!1},Y),K.lastReturnVal}}function O(K){return K&&(0===K.offsetWidth||0===K.offsetHeight||!1===K.open)}function N(K){for(var Y=[],ee=K.parentNode;O(ee);)Y.push(ee),ee=ee.parentNode;return Y}function P(K,Y){function ee(le){void 0!==le.open&&(le.open=!le.open)}var te=N(K),ae=te.length,ie=[],oe=K[Y];if(ae){for(var ne=0;ne<ae;ne++)ie[ne]=te[ne].style.cssText,te[ne].style.setProperty?te[ne].style.setProperty('display','block','important'):te[ne].style.cssText+=';display: block !important',te[ne].style.height='0',te[ne].style.overflow='hidden',te[ne].style.visibility='hidden',ee(te[ne]);oe=K[Y];for(var se=0;se<ae;se++)te[se].style.cssText=ie[se],ee(te[se])}return oe}function M(K,Y){var ee=parseFloat(K);return Number.isNaN(ee)?Y:ee}function U(K){return K.charAt(0).toUpperCase()+K.substr(1)}function W(K,Y){if(this.$window=S(window),this.$document=S(document),this.$element=S(K),this.options=S.extend({},Q,Y),this.polyfill=this.options.polyfill,this.orientation=this.$element[0].getAttribute('data-orientation')||this.options.orientation,this.onInit=this.options.onInit,this.onSlide=this.options.onSlide,this.onSlideEnd=this.options.onSlideEnd,this.DIMENSION=X.orientation[this.orientation].dimension,this.DIRECTION=X.orientation[this.orientation].direction,this.DIRECTION_STYLE=X.orientation[this.orientation].directionStyle,this.COORDINATE=X.orientation[this.orientation].coordinate,this.polyfill&&V)return!1;this.identifier='js-'+_+'-'+Z++,this.startEvent=this.options.startEvent.join('.'+this.identifier+' ')+'.'+this.identifier,this.moveEvent=this.options.moveEvent.join('.'+this.identifier+' ')+'.'+this.identifier,this.endEvent=this.options.endEvent.join('.'+this.identifier+' ')+'.'+this.identifier,this.toFixed=(this.step+'').replace('.','').length-1,this.$fill=S('<div class="'+this.options.fillClass+'" />'),this.$handle=S('<div class="'+this.options.handleClass+'" />'),this.$range=S('<div class="'+this.options.rangeClass+' '+this.options[this.orientation+'Class']+'" id="'+this.identifier+'" />').insertAfter(this.$element).prepend(this.$fill,this.$handle),this.$element.css({position:'absolute',width:'1px',height:'1px',overflow:'hidden',opacity:'0'}),this.handleDown=S.proxy(this.handleDown,this),this.handleMove=S.proxy(this.handleMove,this),this.handleEnd=S.proxy(this.handleEnd,this),this.init();var ee=this;this.$window.on('resize.'+this.identifier,R(function(){L(function(){ee.update(!1,!1)},300)},20)),this.$document.on(this.startEvent,'#'+this.identifier+':not(.'+this.options.disabledClass+')',this.handleDown),this.$element.on('change.'+this.identifier,function(te,ae){if(!ae||ae.origin!==ee.identifier){var ie=te.target.value,oe=ee.getPositionFromValue(ie);ee.setPosition(oe)}})}Number.isNaN=Number.isNaN||function(K){return'number'==typeof K&&K!==K};var _='rangeslider',Z=0,V=function(){var K=document.createElement('input');return K.setAttribute('type','range'),'text'!==K.type}(),Q={polyfill:!0,orientation:'horizontal',rangeClass:'rangeslider',disabledClass:'rangeslider--disabled',activeClass:'rangeslider--active',horizontalClass:'rangeslider--horizontal',verticalClass:'rangeslider--vertical',fillClass:'rangeslider__fill',handleClass:'rangeslider__handle',startEvent:['mousedown','touchstart','pointerdown'],moveEvent:['mousemove','touchmove','pointermove'],endEvent:['mouseup','touchend','pointerup']},X={orientation:{horizontal:{dimension:'width',direction:'left',directionStyle:'left',coordinate:'x'},vertical:{dimension:'height',direction:'top',directionStyle:'bottom',coordinate:'y'}}};return W.prototype.init=function(){this.update(!0,!1),this.onInit&&'function'==typeof this.onInit&&this.onInit()},W.prototype.update=function(K,Y){K=K||!1,K&&(this.min=M(this.$element[0].getAttribute('min'),0),this.max=M(this.$element[0].getAttribute('max'),100),this.value=M(this.$element[0].value,Math.round(this.min+(this.max-this.min)/2)),this.step=M(this.$element[0].getAttribute('step'),1)),this.handleDimension=P(this.$handle[0],'offset'+U(this.DIMENSION)),this.rangeDimension=P(this.$range[0],'offset'+U(this.DIMENSION)),this.maxHandlePos=this.rangeDimension-this.handleDimension,this.grabPos=this.handleDimension/2,this.position=this.getPositionFromValue(this.value),this.$element[0].disabled?this.$range.addClass(this.options.disabledClass):this.$range.removeClass(this.options.disabledClass),this.setPosition(this.position,Y)},W.prototype.handleDown=function(K){if(K.preventDefault(),!(K.button&&0!==K.button||(this.$document.on(this.moveEvent,this.handleMove),this.$document.on(this.endEvent,this.handleEnd),this.$range.addClass(this.options.activeClass),-1<(' '+K.target.className+' ').replace(/[\n\t]/g,' ').indexOf(this.options.handleClass)))){var Y=this.getRelativePosition(K),ee=this.$range[0].getBoundingClientRect()[this.DIRECTION],te=this.getPositionFromNode(this.$handle[0])-ee,ae='vertical'===this.orientation?this.maxHandlePos-(Y-this.grabPos):Y-this.grabPos;this.setPosition(ae),Y>=te&&Y<te+this.handleDimension&&(this.grabPos=Y-te)}},W.prototype.handleMove=function(K){K.preventDefault();var Y=this.getRelativePosition(K),ee='vertical'===this.orientation?this.maxHandlePos-(Y-this.grabPos):Y-this.grabPos;this.setPosition(ee)},W.prototype.handleEnd=function(K){K.preventDefault(),this.$document.off(this.moveEvent,this.handleMove),this.$document.off(this.endEvent,this.handleEnd),this.$range.removeClass(this.options.activeClass),this.$element.trigger('change',{origin:this.identifier}),this.onSlideEnd&&'function'==typeof this.onSlideEnd&&this.onSlideEnd(this.position,this.value)},W.prototype.cap=function(K,Y,ee){return K<Y?Y:K>ee?ee:K},W.prototype.setPosition=function(K,Y){var ee,te;void 0===Y&&(Y=!0),ee=this.getValueFromPosition(this.cap(K,0,this.maxHandlePos)),te=this.getPositionFromValue(ee),this.$fill[0].style[this.DIMENSION]=te+this.grabPos+'px',this.$handle[0].style[this.DIRECTION_STYLE]=te+'px',this.setValue(ee),this.position=te,this.value=ee,Y&&this.onSlide&&'function'==typeof this.onSlide&&this.onSlide(te,ee)},W.prototype.getPositionFromNode=function(K){for(var Y=0;null!==K;)Y+=K.offsetLeft,K=K.offsetParent;return Y},W.prototype.getRelativePosition=function(K){var Y=U(this.COORDINATE),ee=this.$range[0].getBoundingClientRect()[this.DIRECTION],te=0;return void 0===K.originalEvent['client'+Y]?K.originalEvent.touches&&K.originalEvent.touches[0]&&void 0!==K.originalEvent.touches[0]['client'+Y]?te=K.originalEvent.touches[0]['client'+Y]:K.currentPoint&&void 0!==K.currentPoint[this.COORDINATE]&&(te=K.currentPoint[this.COORDINATE]):te=K.originalEvent['client'+Y],te-ee},W.prototype.getPositionFromValue=function(K){var Y;return Y=(K-this.min)/(this.max-this.min),Number.isNaN(Y)?0:Y*this.maxHandlePos},W.prototype.getValueFromPosition=function(K){var Y,ee;return Y=K/(this.maxHandlePos||1),ee=this.step*Math.round(Y*(this.max-this.min)/this.step)+this.min,+ee.toFixed(this.toFixed)},W.prototype.setValue=function(K){K===this.value&&''!==this.$element[0].value||this.$element.val(K).trigger('input',{origin:this.identifier})},W.prototype.destroy=function(){this.$document.off('.'+this.identifier),this.$window.off('.'+this.identifier),this.$element.off('.'+this.identifier).removeAttr('style').removeData('plugin_'+_),this.$range&&this.$range.length&&this.$range[0].parentNode.removeChild(this.$range[0])},S.fn[_]=function(K){var Y=Array.prototype.slice.call(arguments,1);return this.each(function(){var ee=S(this),te=ee.data('plugin_'+_);te||ee.data('plugin_'+_,te=new W(this,K)),'string'==typeof K&&te[K].apply(te,Y)})},'rangeslider.js is available in jQuery context e.g $(selector).rangeslider(options);'}),eval(function(S,T,L,R,O,N){if(O=function(P){return(P<T?'':O(parseInt(P/T)))+(35<(P%=T)?String.fromCharCode(P+29):P.toString(36))},!''.replace(/^/,String)){for(;L--;)N[O(L)]=R[L]||O(L);R=[function(P){return N[P]}],O=function(){return'\\w+'},L=1}for(;L--;)R[L]&&(S=S.replace(new RegExp('\\b'+O(L)+'\\b','g'),R[L]));return S}('(7(4){4.w.8=\'H\'G p;c(!4.w.8){f}d 6=4.U.D.L,g=6.g,h=6.h,a;7 5(2,r){c(2.k.F.J>1){f}2.B();d 8=2.k.q[0],l=p.N(\'O\');l.S(r,i,i,V,1,8.W,8.X,8.Y,8.A,b,b,b,b,0,C);2.z.E(l)}6.m=7(2){d 3=e;c(a||!3.I(2.k.q[0])){f}a=i;3.j=b;5(2,\'K\');5(2,\'s\');5(2,\'M\')};6.n=7(2){c(!a){f}e.j=i;5(2,\'s\')};6.o=7(2){c(!a){f}5(2,\'P\');5(2,\'Q\');c(!e.j){5(2,\'R\')}a=b};6.g=7(){d 3=e;3.u.T({v:4.9(3,\'m\'),x:4.9(3,\'n\'),y:4.9(3,\'o\')});g.t(3)};6.h=7(){d 3=e;3.u.Z({v:4.9(3,\'m\'),x:4.9(3,\'n\'),y:4.9(3,\'o\')});h.t(3)}})(4);',62,62,'||event|self|jQuery|simulateMouseEvent|mouseProto|function|touch|proxy|touchHandled|false|if|var|this|return|_mouseInit|_mouseDestroy|true|_touchMoved|originalEvent|simulatedEvent|_touchStart|_touchMove|_touchEnd|document|changedTouches|simulatedType|mousemove|call|element|touchstart|support|touchmove|touchend|target|clientY|preventDefault|null|mouse|dispatchEvent|touches|in|ontouchend|_mouseCapture|length|mouseover|prototype|mousedown|createEvent|MouseEvents|mouseup|mouseout|click|initMouseEvent|bind|ui|window|screenX|screenY|clientX|unbind'.split('|'),0,{})),!function(S,T){'object'==typeof exports?module.exports=T(S):'function'==typeof define&&define.amd?define('colors',[],function(){return T(S)}):S.Colors=T(S)}(this,function(S,T){'use strict';function L(ne,se,le,de,ce){if('string'==typeof se){var se=oe.txt2color(se);le=se.type,K[le]=se[le],ce=ce===T?se.alpha:ce}else if(se)for(var pe in se)ne[le][pe]=_(se[pe]/Z[le][pe][1],0,1);return ce!==T&&(ne.alpha=_(+ce,0,1)),O(le,de?ne:T)}function R(ne,se,le){var de=X.options.grey,ce={};return ce.RGB={r:ne.r,g:ne.g,b:ne.b},ce.rgb={r:se.r,g:se.g,b:se.b},ce.alpha=le,ce.equivalentGrey=Q(de.r*ne.r+de.g*ne.g+de.b*ne.b),ce.rgbaMixBlack=U(se,{r:0,g:0,b:0},le,1),ce.rgbaMixWhite=U(se,{r:1,g:1,b:1},le,1),ce.rgbaMixBlack.luminance=M(ce.rgbaMixBlack,!0),ce.rgbaMixWhite.luminance=M(ce.rgbaMixWhite,!0),X.options.customBG&&(ce.rgbaMixCustom=U(se,X.options.customBG,le,1),ce.rgbaMixCustom.luminance=M(ce.rgbaMixCustom,!0),X.options.customBG.luminance=M(X.options.customBG,!0)),ce}function O(ne,se){var pe=se||K,me=oe,ge=X.options,ue=Z,be=pe.RND,he='',fe='',ve={hsl:'hsv',rgb:ne},Ce=be.rgb,le,de,ce;if('alpha'!==ne){for(var ye in ue)if(!ue[ye][ye])for(he in ne!==ye&&(fe=ve[ye]||'rgb',pe[ye]=me[fe+'2'+ye](pe[fe])),be[ye]||(be[ye]={}),le=pe[ye],le)be[ye][he]=Q(le[he]*ue[ye][he][1]);Ce=be.rgb,pe.HEX=me.RGB2HEX(Ce),pe.equivalentGrey=ge.grey.r*pe.rgb.r+ge.grey.g*pe.rgb.g+ge.grey.b*pe.rgb.b,pe.webSave=de=N(Ce,51),pe.webSmart=ce=N(Ce,17),pe.saveColor=Ce.r===de.r&&Ce.g===de.g&&Ce.b===de.b?'web save':Ce.r===ce.r&&Ce.g===ce.g&&Ce.b===ce.b?'web smart':'',pe.hueRGB=oe.hue2RGB(pe.hsv.h),se&&(pe.background=R(Ce,pe.rgb,pe.alpha))}var Se=pe.rgb,Ie=pe.alpha,Te='luminance',Le=pe.background,xe,ke,we;return xe=U(Se,{r:0,g:0,b:0},Ie,1),xe[Te]=M(xe,!0),pe.rgbaMixBlack=xe,ke=U(Se,{r:1,g:1,b:1},Ie,1),ke[Te]=M(ke,!0),pe.rgbaMixWhite=ke,ge.customBG&&(we=U(Se,Le.rgbaMixCustom,Ie,1),we[Te]=M(we,!0),we.WCAG2Ratio=W(we[Te],Le.rgbaMixCustom[Te]),pe.rgbaMixBGMixCustom=we,we.luminanceDelta=V.abs(we[Te]-Le.rgbaMixCustom[Te]),we.hueDelta=P(Le.rgbaMixCustom,we,!0)),pe.RGBLuminance=M(Ce),pe.HUELuminance=M(pe.hueRGB),ge.convertCallback&&ge.convertCallback(pe,ne),pe}function N(ne,se){var le={},de=0;for(var pe in ne)de=ne[pe]%se,le[pe]=ne[pe]+(de>se/2?se-de:-de);return le}function P(ne,se,le){return(V.max(ne.r-se.r,se.r-ne.r)+V.max(ne.g-se.g,se.g-ne.g)+V.max(ne.b-se.b,se.b-ne.b))*(le?255:1)/765}function M(ne,se){for(var le=se?1:255,de=[ne.r/le,ne.g/le,ne.b/le],ce=X.options.luminance,pe=de.length;pe--;)de[pe]=.03928>=de[pe]?de[pe]/12.92:V.pow((de[pe]+.055)/1.055,2.4);return ce.r*de[0]+ce.g*de[1]+ce.b*de[2]}function U(ne,se,le,de){var ce={},pe=le===T?1:le,me=de===T?1:de,ge=pe+me*(1-pe);for(var ue in ne)ce[ue]=(ne[ue]*pe+se[ue]*me*(1-pe))/ge;return ce.a=ge,ce}function W(ne,se){var le=1;return le=ne>=se?(ne+.05)/(se+.05):(se+.05)/(ne+.05),Q(100*le)/100}function _(ne,se,le){return ne>le?le:se>ne?se:ne}var Z={rgb:{r:[0,255],g:[0,255],b:[0,255]},hsv:{h:[0,360],s:[0,100],v:[0,100]},hsl:{h:[0,360],s:[0,100],l:[0,100]},alpha:{alpha:[0,1]},HEX:{HEX:[0,16777215]}},V=S.Math,Q=V.round,X={},K={},Y={r:.298954,g:.586434,b:.114612},ee={r:.2126,g:.7152,b:.0722},te=function(ne){this.colors={RND:{}},this.options={color:'rgba(0,0,0,0)',grey:Y,luminance:ee,valueRanges:Z},ae(this,ne||{})},ae=function(ne,se){var de=ne.options,le;for(var ce in ie(ne),se)se[ce]!==T&&(de[ce]=se[ce]);le=de.customBG,de.customBG='string'==typeof le?oe.txt2color(le).rgb:le,K=L(ne.colors,de.color,T,!0)},ie=function(ne){X!==ne&&(X=ne,K=ne.colors)};te.prototype.setColor=function(ne,se,le){return ie(this),ne?L(this.colors,ne,se,T,le):(le!==T&&(this.colors.alpha=_(le,0,1)),O(se))},te.prototype.setCustomBackground=function(ne){return ie(this),this.options.customBG='string'==typeof ne?oe.txt2color(ne).rgb:ne,L(this.colors,T,'rgb')},te.prototype.saveAsBackground=function(){return ie(this),L(this.colors,T,'rgb',!0)},te.prototype.toString=function(ne,se){return oe.color2text((ne||'rgb').toLowerCase(),this.colors,se)};var oe={txt2color:function(ne){var se={},le=ne.replace(/(?:#|\)|%)/g,'').split('('),de=(le[1]||'').split(/,\s*/),ce=le[1]?le[0].substr(0,3):'rgb',pe='';if(se.type=ce,se[ce]={},le[1])for(var me=3;me--;)pe=ce[me]||ce.charAt(me),se[ce][pe]=+de[me]/Z[ce][pe][1];else se.rgb=oe.HEX2rgb(le[0]);return se.alpha=de[3]?+de[3]:1,se},color2text:function(ne,se,le){var de=!1!==le&&Q(100*se.alpha)/100,ce='number'==typeof de&&!1!==le&&(le||1!==de),pe=se.RND.rgb,me=se.RND.hsl,ge='hex'===ne&&ce,ue='hex'===ne&&!ge,he='rgb'===ne||ge?pe.r+', '+pe.g+', '+pe.b:ue?'#'+se.HEX:me.h+', '+me.s+'%, '+me.l+'%';return ue?he:(ge?'rgb':ne)+(ce?'a':'')+'('+he+(ce?', '+de:'')+')'},RGB2HEX:function(ne){return((16>ne.r?'0':'')+ne.r.toString(16)+(16>ne.g?'0':'')+ne.g.toString(16)+(16>ne.b?'0':'')+ne.b.toString(16)).toUpperCase()},HEX2rgb:function(ne){return ne=ne.split(''),{r:+('0x'+ne[0]+ne[ne[3]?1:0])/255,g:+('0x'+ne[ne[3]?2:1]+(ne[3]||ne[1]))/255,b:+('0x'+(ne[4]||ne[2])+(ne[5]||ne[2]))/255}},hue2RGB:function(ne){var se=6*ne,le=~~se%6,de=6==se?0:se-le;return{r:Q(255*[1,1-de,0,0,de,1][le]),g:Q(255*[de,1,1,1-de,0,0][le]),b:Q(255*[0,0,de,1,1,1-de][le])}},rgb2hsv:function(ne){var ce=ne.r,pe=ne.g,me=ne.b,ge=0,se,le,de;return me>pe&&(pe=me+(me=pe,0),ge=-1),le=me,pe>ce&&(ce=pe+(pe=ce,0),ge=-2/6-ge,le=V.min(pe,me)),se=ce-le,de=ce?se/ce:0,{h:1e-15>de?K&&K.hsl&&K.hsl.h||0:se?V.abs(ge+(pe-me)/(6*se)):0,s:ce?se/ce:K&&K.hsv&&K.hsv.s||0,v:ce}},hsv2rgb:function(ne){var se=6*ne.h,le=ne.s,de=ne.v,ce=~~se,pe=se-ce,me=de*(1-le),ge=de*(1-pe*le),ue=de*(1-(1-pe)*le),be=ce%6;return{r:[de,ge,me,me,ue,de][be],g:[ue,de,de,ge,me,me][be],b:[me,me,ue,de,de,ge][be]}},hsv2hsl:function(ne){var se=(2-ne.s)*ne.v,le=ne.s*ne.v;return le=ne.s?1>se?se?le/se:0:le/(2-se):0,{h:ne.h,s:ne.v||le?le:K&&K.hsl&&K.hsl.s||0,l:se/2}},rgb2hsl:function(ne,se){var le=oe.rgb2hsv(ne);return oe.hsv2hsl(se?le:K.hsv=le)},hsl2rgb:function(ne){var se=6*ne.h,le=ne.s,de=ne.l,ce=.5>de?de*(1+le):de+le-le*de,pe=de+de-ce,me=ce?(ce-pe)/ce:0,ge=~~se,be=ce*me*(se-ge),he=pe+be,fe=ce-be,ve=ge%6;return{r:[ce,fe,pe,pe,he,ce][ve],g:[he,ce,ce,fe,pe,pe][ve],b:[pe,pe,he,ce,ce,fe][ve]}}};return te}),function(S,T){'object'==typeof exports?module.exports=T(S,require('jquery'),require('colors')):'function'==typeof define&&define.amd?define(['jquery','colors'],function(L,R){return T(S,L,R)}):T(S,S.jQuery,S.Colors)}(this,function(S,T,L,R){'use strict';function O(ye){return ye.value||ye.getAttribute('value')||T(ye).css('background-color')||'#FFF'}function N(ye){return ye=ye.originalEvent&&ye.originalEvent.touches?ye.originalEvent.touches[0]:ye,ye.originalEvent?ye.originalEvent:ye}function P(ye){return T(ye.find(ee.doRender)[0]||ye[0])}function M(ye){var xe=T(this),ke=xe.offset(),we=T(S),Se=ee.gap;ye?(te=P(xe),te._colorMode=te.data('colorMode'),K.$trigger=xe,(ae||U()).css(ee.positionCallback.call(K,xe)||{left:(ae._left=ke.left)-(0<(ae._left+=ae._width-(we.scrollLeft()+we.width()))+Se?ae._left+Se:0),top:(ae._top=ke.top+xe.outerHeight())-(0<(ae._top+=ae._height-(we.scrollTop()+we.height()))+Se?ae._top+Se:0)}).show(ee.animationSpeed,function(){!0!==ye&&(le.toggle(!!ee.opacity)._width=le.width(),oe._width=oe.width(),oe._height=oe.height(),ie._height=ie.height(),Y.setColor(O(te[0])),Q(!0))}).off('.tcp').on(ge,'.cp-xy-slider,.cp-z-slider,.cp-alpha',W)):K.$trigger&&T(ae).hide(ee.animationSpeed,function(){Q(!1),K.$trigger=null}).off('.tcp')}function U(){return T('head')[ee.cssPrepend?'prepend':'append']('<style type="text/css" id="tinyColorPickerStyles">'+(ee.css||'.cp-color-picker{position:absolute;overflow:hidden;padding:6px 6px 0;background-color:#444;color:#bbb;font-family:Arial,Helvetica,sans-serif;font-size:12px;font-weight:400;cursor:default;border-radius:5px}.cp-color-picker>div{position:relative;overflow:hidden}.cp-xy-slider{float:left;height:128px;width:128px;margin-bottom:6px;background:linear-gradient(to right,#FFF,rgba(255,255,255,0))}.cp-white{height:100%;width:100%;background:linear-gradient(rgba(0,0,0,0),#000)}.cp-xy-cursor{position:absolute;top:0;width:10px;height:10px;margin:-5px;border:1px solid #fff;border-radius:100%;box-sizing:border-box}.cp-z-slider{float:right;margin-left:6px;height:128px;width:20px;background:linear-gradient(red 0,#f0f 17%,#00f 33%,#0ff 50%,#0f0 67%,#ff0 83%,red 100%)}.cp-z-cursor{position:absolute;margin-top:-4px;width:100%;border:4px solid #fff;border-color:transparent #fff;box-sizing:border-box}.cp-alpha{clear:both;width:100%;height:16px;margin:6px 0;background:linear-gradient(to right,#444,rgba(0,0,0,0))}.cp-alpha-cursor{position:absolute;margin-left:-4px;height:100%;border:4px solid #fff;border-color:#fff transparent;box-sizing:border-box}')+(ee.cssAddon||'')+'</style>'),T('<div class="cp-color-picker"><div class="cp-z-slider"><div class="cp-z-cursor"></div></div><div class="cp-xy-slider"><div class="cp-white"></div><div class="cp-xy-cursor"></div></div><div class="cp-alpha"><div class="cp-alpha-cursor"></div></div></div>').css({margin:ee.margin}).appendTo('body').show(0,function(){K.$UI=ae=T(this),be=ee.GPU&&ae.css('perspective')!==R,ie=T('.cp-z-slider',this),oe=T('.cp-xy-slider',this),ne=T('.cp-xy-cursor',this),se=T('.cp-z-cursor',this),le=T('.cp-alpha',this),de=T('.cp-alpha-cursor',this),ee.buildCallback.call(K,ae),ae.prepend('<div>').children().eq(0).css('width',ae.children().eq(0).width()),ae._width=this.offsetWidth,ae._height=this.offsetHeight}).hide()}function W(ye){var xe=this.className.replace(/cp-(.*?)(?:\s*|$)/,'$1').replace('-','_');1<(ye.button||ye.which)||(ye.preventDefault&&ye.preventDefault(),ye.returnValue=!1,te._offset=T(this).offset(),(xe='xy_slider'===xe?_:'z_slider'===xe?Z:V)(ye),Q(),ce.on('touchend.tcp mouseup.tcp pointerup.tcp',function(){ce.off('.tcp')}).on('touchmove.tcp mousemove.tcp pointermove.tcp',function(ke){xe(ke),Q()}))}function _(ye){var xe=N(ye),ke=xe.pageX-te._offset.left,we=xe.pageY-te._offset.top;Y.setColor({s:100*(ke/oe._width),v:100-100*(we/oe._height)},'hsv')}function Z(ye){var xe=N(ye).pageY-te._offset.top;Y.setColor({h:360-360*(xe/ie._height)},'hsv')}function V(ye){var xe=N(ye).pageX-te._offset.left,ke=xe/le._width;Y.setColor({},'rgb',ke)}function Q(ye){var xe=Y.colors,ke=xe.hueRGB,we=(xe.RND.rgb,xe.RND.hsl,ee.dark),Se=ee.light,Ie=Y.toString(te._colorMode,ee.forceAlpha),Te=.22<xe.HUELuminance?we:Se,Le=.22<xe.rgbaMixBlack.luminance?we:Se,Ae=(1-xe.hsv.h)*ie._height,Re=xe.hsv.s*oe._width,Oe=(1-xe.hsv.v)*oe._height,Ne=xe.alpha*le._width,Be=be?'translate3d':'',Ee=te[0].value,ze=te[0].hasAttribute('value')&&''===Ee&&ye!==R;oe._css={backgroundColor:'rgb('+ke.r+','+ke.g+','+ke.b+')'},ne._css={transform:Be+'('+Re+'px, '+Oe+'px, 0)',left:be?'':Re,top:be?'':Oe,borderColor:.22<xe.RGBLuminance?we:Se},se._css={transform:Be+'(0, '+Ae+'px, 0)',top:be?'':Ae,borderColor:'transparent '+Te},le._css={backgroundColor:'#'+xe.HEX},de._css={transform:Be+'('+Ne+'px, 0, 0)',left:be?'':Ne,borderColor:Le+' transparent'},te._css={backgroundColor:ze?'':Ie,color:ze?'':.22<xe.rgbaMixBGMixCustom.luminance?we:Se},te.text=ze?'':Ee===Ie?'':Ie,ye===R?he(X):X(ye)}function X(ye){oe.css(oe._css),ne.css(ne._css),se.css(se._css),le.css(le._css),de.css(de._css),ee.doRender&&te.css(te._css),te.text&&te.val(te.text),ee.renderCallback.call(K,te,'boolean'==typeof ye?ye:R)}var ce=T(document),pe=T(),ge='touchstart.tcp mousedown.tcp pointerdown.tcp',be=!1,he=S.requestAnimationFrame||S.webkitRequestAnimationFrame||function(ye){ye()},Ce=function(ye){Y=this.color=new L(ye),ee=Y.options,K=this},K,Y,ee,te,ae,ie,oe,ne,se,le,de;Ce.prototype={render:Q,toggle:M},T.fn.colorPicker=function(ye){var xe=this,ke=function(){};return ye=T.extend({animationSpeed:150,GPU:!0,doRender:!0,customBG:'#FFF',opacity:!0,renderCallback:ke,buildCallback:ke,positionCallback:ke,body:document.body,scrollResize:!0,gap:4,dark:'#222',light:'#DDD'},ye),!K&&ye.scrollResize&&T(S).on('resize.tcp scroll.tcp',function(){K.$trigger&&K.toggle.call(K.$trigger[0],!0)}),pe=pe.add(this),this.colorPicker=K||new Ce(ye),this.options=ye,T(ye.body).off('.tcp').on(ge,function(we){-1===pe.add(ae).add(T(ae).find(we.target)).index(we.target)&&M()}),this.on('focusin.tcp click.tcp',function(we){K.color.options=T.extend(K.color.options,ee=xe.options),M.call(this,we)}).on('change.tcp',function(){Y.setColor(this.value||'#FFF'),xe.colorPicker.render(!0)}).each(function(){var we=O(this),Se=we.split('('),Ie=P(T(this));Ie.data('colorMode',Se[1]?Se[0].substr(0,3):'HEX').attr('readonly',ee.preventFocus),ye.doRender&&Ie.css({'background-color':we,color:function(){return .22<Y.setColor(we).rgbaMixBGMixCustom.luminance?ye.dark:ye.light}})})},T.fn.colorPicker.destroy=function(){T('*').off('.tcp'),K.toggle(!1),pe=T()}});